
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Cppcheck - HTML report - mate-desktop</title>
    <link rel="stylesheet" href="style.css">
    <style>
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #ffffff; }
.highlight .c { color: #888888 } /* Comment */
.highlight .err { color: #FF0000; background-color: #FFAAAA } /* Error */
.highlight .k { color: #008800; font-weight: bold } /* Keyword */
.highlight .o { color: #333333 } /* Operator */
.highlight .ch { color: #888888 } /* Comment.Hashbang */
.highlight .cm { color: #888888 } /* Comment.Multiline */
.highlight .cp { color: #557799 } /* Comment.Preproc */
.highlight .cpf { color: #888888 } /* Comment.PreprocFile */
.highlight .c1 { color: #888888 } /* Comment.Single */
.highlight .cs { color: #cc0000; font-weight: bold } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #003388; font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #333399; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #6600EE; font-weight: bold } /* Literal.Number */
.highlight .s { background-color: #fff0f0 } /* Literal.String */
.highlight .na { color: #0000CC } /* Name.Attribute */
.highlight .nb { color: #007020 } /* Name.Builtin */
.highlight .nc { color: #BB0066; font-weight: bold } /* Name.Class */
.highlight .no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #880000; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #FF0000; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0066BB; font-weight: bold } /* Name.Function */
.highlight .nl { color: #997700; font-weight: bold } /* Name.Label */
.highlight .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #007700 } /* Name.Tag */
.highlight .nv { color: #996633 } /* Name.Variable */
.highlight .ow { color: #000000; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #6600EE; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #6600EE; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #005588; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #4400EE; font-weight: bold } /* Literal.Number.Oct */
.highlight .sa { background-color: #fff0f0 } /* Literal.String.Affix */
.highlight .sb { background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .sc { color: #0044DD } /* Literal.String.Char */
.highlight .dl { background-color: #fff0f0 } /* Literal.String.Delimiter */
.highlight .sd { color: #DD4422 } /* Literal.String.Doc */
.highlight .s2 { background-color: #fff0f0 } /* Literal.String.Double */
.highlight .se { color: #666666; font-weight: bold; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .sh { background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .si { background-color: #eeeeee } /* Literal.String.Interpol */
.highlight .sx { color: #DD2200; background-color: #fff0f0 } /* Literal.String.Other */
.highlight .sr { color: #000000; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .s1 { background-color: #fff0f0 } /* Literal.String.Single */
.highlight .ss { color: #AA6600 } /* Literal.String.Symbol */
.highlight .bp { color: #007020 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0066BB; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #336699 } /* Name.Variable.Class */
.highlight .vg { color: #dd7700; font-weight: bold } /* Name.Variable.Global */
.highlight .vi { color: #3333BB } /* Name.Variable.Instance */
.highlight .vm { color: #996633 } /* Name.Variable.Magic */
.highlight .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */
    </style>
    <script>
      function getStyle(el, styleProp) {
        var y;

        if (el.currentStyle) {
          y = el.currentStyle[styleProp];
        } else if (window.getComputedStyle) {
          y = document.defaultView.getComputedStyle(el, null).getPropertyValue(styleProp);
        }

        return y;
      }

      function toggle() {
        var el = this.expandable_content;
        var mark = this.expandable_marker;

        if (el.style.display === "block") {
          el.style.display = "none";
          mark.textContent = "[+]";
        } else {
          el.style.display = "block";
          mark.textContent = "[-]";
        }
      }

      function initExpandables() {
        var elements = document.querySelectorAll(".expandable");

        for (var i = 0, len = elements.length; i < len; i++) {
          var el = elements[i];
          var clickable = el.querySelector("span");
          var marker = clickable.querySelector(".marker");
          var content = el.querySelector(".content");
          var width = clickable.clientWidth - parseInt(getStyle(content, "padding-left")) - parseInt(getStyle(content, "padding-right"));
          content.style.width = width + "px";
          clickable.expandable_content = content;
          clickable.expandable_marker = marker;
          clickable.addEventListener("click", toggle);
        }
      }

      function toggleDisplay(cb) {
        var elements = document.querySelectorAll("." + cb.id);

        for (var i = 0, len = elements.length; i < len; i++) {
          elements[i].classList.toggle("id-filtered", !cb.checked);
        }

        updateFileRows();
      }

      function toggleSeverity(cb) {
        cb.parentElement.classList.toggle("unchecked", !cb.checked);
        var elements = document.querySelectorAll(".sev_" + cb.id);

        for (var i = 0, len = elements.length; i < len; i++) {
          elements[i].classList.toggle("severity-filtered", !cb.checked);
        }

        updateFileRows();
      }

      function toggleTool(cb) {
        cb.parentElement.classList.toggle("unchecked", !cb.checked);

        var elements;
        if (cb.id == "clang-tidy")
            elements = document.querySelectorAll("[class^=clang-tidy-]");
        else
            elements = document.querySelectorAll(".issue:not([class^=clang-tidy-])");

        for (var i = 0, len = elements.length; i < len; i++) {
          elements[i].classList.toggle("tool-filtered", !cb.checked);
        }

        updateFileRows();
      }

      function toggleAll() {
        var elements = document.querySelectorAll(".idToggle");

        // starting from 1 since 0 is the "toggle all" input
        for (var i = 1, len = elements.length; i < len; i++) {
          var changed = elements[i].checked != elements[0].checked;
          if (changed) {
            elements[i].checked = elements[0].checked;
            toggleDisplay(elements[i]);
          }
        }
      }

      function filterFile(filter) {
        var elements = document.querySelectorAll(".fileEntry");

        for (var i = 0, len = elements.length; i < len; i++) {
          var visible = elements[i].querySelector("tr").querySelector("td").textContent.toLowerCase().includes(filter.toLowerCase());
          elements[i].classList.toggle("text-filtered", !visible);
        }
      }

      function filterText(text) {
        filter = text.toLowerCase();
        var elements = document.querySelectorAll(".issue");

        for (var i = 0, len = elements.length; i < len; i++) {
          var visible = false;
          var fields = elements[i].querySelectorAll("td");
          for (var n = 0, num = fields.length; n < num; n++) {
            if (fields[n].textContent.toLowerCase().includes(filter)) {
              visible = true;
              break;
            }
          }
          elements[i].classList.toggle("text-filtered", !visible);
        }

        updateFileRows();
      }

      function updateFileRows(element) {
        var elements = document.querySelectorAll(".fileEntry");

        for (var i = 0, len = elements.length; i < len; i++) {
          var visible = elements[i].querySelector(".issue:not(.id-filtered):not(.severity-filtered):not(.tool-filtered):not(.text-filtered)");
          elements[i].classList.toggle("file-filtered", !visible);
        }
      }

      window.addEventListener("load", initExpandables);
    </script>
  </head>
  <body>
    <div id="wrapper">
    <div id="header" class="header">
      <h1>Cppcheck report - mate-desktop: libmate-desktop/mate-desktop-item.c</h1>

    </div>

    <div id="menu">
     <p><a href="index.html">Defects:</a> mate-desktop-item.c</p>
<a href="13.html#line-0"> normalCheckLevelMaxBranches 0</a><a href="13.html#line-30"> missingInclude 30</a><a href="13.html#line-32"> missingIncludeSystem 32</a><a href="13.html#line-33"> missingIncludeSystem 33</a><a href="13.html#line-34"> missingIncludeSystem 34</a><a href="13.html#line-35"> missingIncludeSystem 35</a><a href="13.html#line-36"> missingIncludeSystem 36</a><a href="13.html#line-37"> missingIncludeSystem 37</a><a href="13.html#line-38"> missingIncludeSystem 38</a><a href="13.html#line-39"> missingIncludeSystem 39</a><a href="13.html#line-40"> missingIncludeSystem 40</a><a href="13.html#line-41"> missingIncludeSystem 41</a><a href="13.html#line-42"> missingIncludeSystem 42</a><a href="13.html#line-43"> missingIncludeSystem 43</a><a href="13.html#line-45"> missingIncludeSystem 45</a><a href="13.html#line-49"> missingIncludeSystem 49</a><a href="13.html#line-50"> missingIncludeSystem 50</a><a href="13.html#line-51"> missingIncludeSystem 51</a><a href="13.html#line-52"> missingIncludeSystem 52</a><a href="13.html#line-57"> missingIncludeSystem 57</a><a href="13.html#line-58"> missingIncludeSystem 58</a><a href="13.html#line-916"> constVariablePointer 916</a><a href="13.html#line-945"> constVariablePointer 945</a><a href="13.html#line-2338"> variableScope 2338</a><a href="13.html#line-2497"> variableScope 2497</a><a href="13.html#line-2844"> constVariablePointer 2844</a><a href="13.html#line-3156"> variableScope 3156</a><a href="13.html#line-3175"> varFuncNullUB 3175</a><a href="13.html#line-3177"> varFuncNullUB 3177</a><a href="13.html#line-3178"> varFuncNullUB 3178</a><a href="13.html#line-3179"> varFuncNullUB 3179</a><a href="13.html#line-3181"> varFuncNullUB 3181</a><a href="13.html#line-3183"> varFuncNullUB 3183</a><a href="13.html#line-3185"> varFuncNullUB 3185</a><a href="13.html#line-3186"> varFuncNullUB 3186</a><a href="13.html#line-3188"> varFuncNullUB 3188</a><a href="13.html#line-3189"> varFuncNullUB 3189</a><a href="13.html#line-3190"> varFuncNullUB 3190</a><a href="13.html#line-3191"> varFuncNullUB 3191</a><a href="13.html#line-3192"> varFuncNullUB 3192</a><a href="13.html#line-3193"> varFuncNullUB 3193</a><a href="13.html#line-3194"> varFuncNullUB 3194</a><a href="13.html#line-3195"> varFuncNullUB 3195</a><a href="13.html#line-3196"> varFuncNullUB 3196</a><a href="13.html#line-3197"> varFuncNullUB 3197</a><a href="13.html#line-3198"> varFuncNullUB 3198</a><a href="13.html#line-3199"> varFuncNullUB 3199</a><a href="13.html#line-3201"> varFuncNullUB 3201</a><a href="13.html#line-3203"> varFuncNullUB 3203</a><a href="13.html#line-3205"> varFuncNullUB 3205</a><a href="13.html#line-3422"> constVariablePointer 3422</a><a href="13.html#line-3497"> constParameterPointer 3497</a>
    </div>
    <div id="content">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">   1</span>
<span class="normal">   2</span>
<span class="normal">   3</span>
<span class="normal">   4</span>
<span class="normal">   5</span>
<span class="normal">   6</span>
<span class="normal">   7</span>
<span class="normal">   8</span>
<span class="normal">   9</span>
<span class="normal">  10</span>
<span class="normal">  11</span>
<span class="normal">  12</span>
<span class="normal">  13</span>
<span class="normal">  14</span>
<span class="normal">  15</span>
<span class="normal">  16</span>
<span class="normal">  17</span>
<span class="normal">  18</span>
<span class="normal">  19</span>
<span class="normal">  20</span>
<span class="normal">  21</span>
<span class="normal">  22</span>
<span class="normal">  23</span>
<span class="normal">  24</span>
<span class="normal">  25</span>
<span class="normal">  26</span>
<span class="normal">  27</span>
<span class="normal">  28</span>
<span class="normal">  29</span>
<span class="normal">  30</span>
<span class="normal">  31</span>
<span class="normal">  32</span>
<span class="normal">  33</span>
<span class="normal">  34</span>
<span class="normal">  35</span>
<span class="normal">  36</span>
<span class="normal">  37</span>
<span class="normal">  38</span>
<span class="normal">  39</span>
<span class="normal">  40</span>
<span class="normal">  41</span>
<span class="normal">  42</span>
<span class="normal">  43</span>
<span class="normal">  44</span>
<span class="normal">  45</span>
<span class="normal">  46</span>
<span class="normal">  47</span>
<span class="normal">  48</span>
<span class="normal">  49</span>
<span class="normal">  50</span>
<span class="normal">  51</span>
<span class="normal">  52</span>
<span class="normal">  53</span>
<span class="normal">  54</span>
<span class="normal">  55</span>
<span class="normal">  56</span>
<span class="normal">  57</span>
<span class="normal">  58</span>
<span class="normal">  59</span>
<span class="normal">  60</span>
<span class="normal">  61</span>
<span class="normal">  62</span>
<span class="normal">  63</span>
<span class="normal">  64</span>
<span class="normal">  65</span>
<span class="normal">  66</span>
<span class="normal">  67</span>
<span class="normal">  68</span>
<span class="normal">  69</span>
<span class="normal">  70</span>
<span class="normal">  71</span>
<span class="normal">  72</span>
<span class="normal">  73</span>
<span class="normal">  74</span>
<span class="normal">  75</span>
<span class="normal">  76</span>
<span class="normal">  77</span>
<span class="normal">  78</span>
<span class="normal">  79</span>
<span class="normal">  80</span>
<span class="normal">  81</span>
<span class="normal">  82</span>
<span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span>
<span class="normal">2111</span>
<span class="normal">2112</span>
<span class="normal">2113</span>
<span class="normal">2114</span>
<span class="normal">2115</span>
<span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span>
<span class="normal">2121</span>
<span class="normal">2122</span>
<span class="normal">2123</span>
<span class="normal">2124</span>
<span class="normal">2125</span>
<span class="normal">2126</span>
<span class="normal">2127</span>
<span class="normal">2128</span>
<span class="normal">2129</span>
<span class="normal">2130</span>
<span class="normal">2131</span>
<span class="normal">2132</span>
<span class="normal">2133</span>
<span class="normal">2134</span>
<span class="normal">2135</span>
<span class="normal">2136</span>
<span class="normal">2137</span>
<span class="normal">2138</span>
<span class="normal">2139</span>
<span class="normal">2140</span>
<span class="normal">2141</span>
<span class="normal">2142</span>
<span class="normal">2143</span>
<span class="normal">2144</span>
<span class="normal">2145</span>
<span class="normal">2146</span>
<span class="normal">2147</span>
<span class="normal">2148</span>
<span class="normal">2149</span>
<span class="normal">2150</span>
<span class="normal">2151</span>
<span class="normal">2152</span>
<span class="normal">2153</span>
<span class="normal">2154</span>
<span class="normal">2155</span>
<span class="normal">2156</span>
<span class="normal">2157</span>
<span class="normal">2158</span>
<span class="normal">2159</span>
<span class="normal">2160</span>
<span class="normal">2161</span>
<span class="normal">2162</span>
<span class="normal">2163</span>
<span class="normal">2164</span>
<span class="normal">2165</span>
<span class="normal">2166</span>
<span class="normal">2167</span>
<span class="normal">2168</span>
<span class="normal">2169</span>
<span class="normal">2170</span>
<span class="normal">2171</span>
<span class="normal">2172</span>
<span class="normal">2173</span>
<span class="normal">2174</span>
<span class="normal">2175</span>
<span class="normal">2176</span>
<span class="normal">2177</span>
<span class="normal">2178</span>
<span class="normal">2179</span>
<span class="normal">2180</span>
<span class="normal">2181</span>
<span class="normal">2182</span>
<span class="normal">2183</span>
<span class="normal">2184</span>
<span class="normal">2185</span>
<span class="normal">2186</span>
<span class="normal">2187</span>
<span class="normal">2188</span>
<span class="normal">2189</span>
<span class="normal">2190</span>
<span class="normal">2191</span>
<span class="normal">2192</span>
<span class="normal">2193</span>
<span class="normal">2194</span>
<span class="normal">2195</span>
<span class="normal">2196</span>
<span class="normal">2197</span>
<span class="normal">2198</span>
<span class="normal">2199</span>
<span class="normal">2200</span>
<span class="normal">2201</span>
<span class="normal">2202</span>
<span class="normal">2203</span>
<span class="normal">2204</span>
<span class="normal">2205</span>
<span class="normal">2206</span>
<span class="normal">2207</span>
<span class="normal">2208</span>
<span class="normal">2209</span>
<span class="normal">2210</span>
<span class="normal">2211</span>
<span class="normal">2212</span>
<span class="normal">2213</span>
<span class="normal">2214</span>
<span class="normal">2215</span>
<span class="normal">2216</span>
<span class="normal">2217</span>
<span class="normal">2218</span>
<span class="normal">2219</span>
<span class="normal">2220</span>
<span class="normal">2221</span>
<span class="normal">2222</span>
<span class="normal">2223</span>
<span class="normal">2224</span>
<span class="normal">2225</span>
<span class="normal">2226</span>
<span class="normal">2227</span>
<span class="normal">2228</span>
<span class="normal">2229</span>
<span class="normal">2230</span>
<span class="normal">2231</span>
<span class="normal">2232</span>
<span class="normal">2233</span>
<span class="normal">2234</span>
<span class="normal">2235</span>
<span class="normal">2236</span>
<span class="normal">2237</span>
<span class="normal">2238</span>
<span class="normal">2239</span>
<span class="normal">2240</span>
<span class="normal">2241</span>
<span class="normal">2242</span>
<span class="normal">2243</span>
<span class="normal">2244</span>
<span class="normal">2245</span>
<span class="normal">2246</span>
<span class="normal">2247</span>
<span class="normal">2248</span>
<span class="normal">2249</span>
<span class="normal">2250</span>
<span class="normal">2251</span>
<span class="normal">2252</span>
<span class="normal">2253</span>
<span class="normal">2254</span>
<span class="normal">2255</span>
<span class="normal">2256</span>
<span class="normal">2257</span>
<span class="normal">2258</span>
<span class="normal">2259</span>
<span class="normal">2260</span>
<span class="normal">2261</span>
<span class="normal">2262</span>
<span class="normal">2263</span>
<span class="normal">2264</span>
<span class="normal">2265</span>
<span class="normal">2266</span>
<span class="normal">2267</span>
<span class="normal">2268</span>
<span class="normal">2269</span>
<span class="normal">2270</span>
<span class="normal">2271</span>
<span class="normal">2272</span>
<span class="normal">2273</span>
<span class="normal">2274</span>
<span class="normal">2275</span>
<span class="normal">2276</span>
<span class="normal">2277</span>
<span class="normal">2278</span>
<span class="normal">2279</span>
<span class="normal">2280</span>
<span class="normal">2281</span>
<span class="normal">2282</span>
<span class="normal">2283</span>
<span class="normal">2284</span>
<span class="normal">2285</span>
<span class="normal">2286</span>
<span class="normal">2287</span>
<span class="normal">2288</span>
<span class="normal">2289</span>
<span class="normal">2290</span>
<span class="normal">2291</span>
<span class="normal">2292</span>
<span class="normal">2293</span>
<span class="normal">2294</span>
<span class="normal">2295</span>
<span class="normal">2296</span>
<span class="normal">2297</span>
<span class="normal">2298</span>
<span class="normal">2299</span>
<span class="normal">2300</span>
<span class="normal">2301</span>
<span class="normal">2302</span>
<span class="normal">2303</span>
<span class="normal">2304</span>
<span class="normal">2305</span>
<span class="normal">2306</span>
<span class="normal">2307</span>
<span class="normal">2308</span>
<span class="normal">2309</span>
<span class="normal">2310</span>
<span class="normal">2311</span>
<span class="normal">2312</span>
<span class="normal">2313</span>
<span class="normal">2314</span>
<span class="normal">2315</span>
<span class="normal">2316</span>
<span class="normal">2317</span>
<span class="normal">2318</span>
<span class="normal">2319</span>
<span class="normal">2320</span>
<span class="normal">2321</span>
<span class="normal">2322</span>
<span class="normal">2323</span>
<span class="normal">2324</span>
<span class="normal">2325</span>
<span class="normal">2326</span>
<span class="normal">2327</span>
<span class="normal">2328</span>
<span class="normal">2329</span>
<span class="normal">2330</span>
<span class="normal">2331</span>
<span class="normal">2332</span>
<span class="normal">2333</span>
<span class="normal">2334</span>
<span class="normal">2335</span>
<span class="normal">2336</span>
<span class="normal">2337</span>
<span class="normal">2338</span>
<span class="normal">2339</span>
<span class="normal">2340</span>
<span class="normal">2341</span>
<span class="normal">2342</span>
<span class="normal">2343</span>
<span class="normal">2344</span>
<span class="normal">2345</span>
<span class="normal">2346</span>
<span class="normal">2347</span>
<span class="normal">2348</span>
<span class="normal">2349</span>
<span class="normal">2350</span>
<span class="normal">2351</span>
<span class="normal">2352</span>
<span class="normal">2353</span>
<span class="normal">2354</span>
<span class="normal">2355</span>
<span class="normal">2356</span>
<span class="normal">2357</span>
<span class="normal">2358</span>
<span class="normal">2359</span>
<span class="normal">2360</span>
<span class="normal">2361</span>
<span class="normal">2362</span>
<span class="normal">2363</span>
<span class="normal">2364</span>
<span class="normal">2365</span>
<span class="normal">2366</span>
<span class="normal">2367</span>
<span class="normal">2368</span>
<span class="normal">2369</span>
<span class="normal">2370</span>
<span class="normal">2371</span>
<span class="normal">2372</span>
<span class="normal">2373</span>
<span class="normal">2374</span>
<span class="normal">2375</span>
<span class="normal">2376</span>
<span class="normal">2377</span>
<span class="normal">2378</span>
<span class="normal">2379</span>
<span class="normal">2380</span>
<span class="normal">2381</span>
<span class="normal">2382</span>
<span class="normal">2383</span>
<span class="normal">2384</span>
<span class="normal">2385</span>
<span class="normal">2386</span>
<span class="normal">2387</span>
<span class="normal">2388</span>
<span class="normal">2389</span>
<span class="normal">2390</span>
<span class="normal">2391</span>
<span class="normal">2392</span>
<span class="normal">2393</span>
<span class="normal">2394</span>
<span class="normal">2395</span>
<span class="normal">2396</span>
<span class="normal">2397</span>
<span class="normal">2398</span>
<span class="normal">2399</span>
<span class="normal">2400</span>
<span class="normal">2401</span>
<span class="normal">2402</span>
<span class="normal">2403</span>
<span class="normal">2404</span>
<span class="normal">2405</span>
<span class="normal">2406</span>
<span class="normal">2407</span>
<span class="normal">2408</span>
<span class="normal">2409</span>
<span class="normal">2410</span>
<span class="normal">2411</span>
<span class="normal">2412</span>
<span class="normal">2413</span>
<span class="normal">2414</span>
<span class="normal">2415</span>
<span class="normal">2416</span>
<span class="normal">2417</span>
<span class="normal">2418</span>
<span class="normal">2419</span>
<span class="normal">2420</span>
<span class="normal">2421</span>
<span class="normal">2422</span>
<span class="normal">2423</span>
<span class="normal">2424</span>
<span class="normal">2425</span>
<span class="normal">2426</span>
<span class="normal">2427</span>
<span class="normal">2428</span>
<span class="normal">2429</span>
<span class="normal">2430</span>
<span class="normal">2431</span>
<span class="normal">2432</span>
<span class="normal">2433</span>
<span class="normal">2434</span>
<span class="normal">2435</span>
<span class="normal">2436</span>
<span class="normal">2437</span>
<span class="normal">2438</span>
<span class="normal">2439</span>
<span class="normal">2440</span>
<span class="normal">2441</span>
<span class="normal">2442</span>
<span class="normal">2443</span>
<span class="normal">2444</span>
<span class="normal">2445</span>
<span class="normal">2446</span>
<span class="normal">2447</span>
<span class="normal">2448</span>
<span class="normal">2449</span>
<span class="normal">2450</span>
<span class="normal">2451</span>
<span class="normal">2452</span>
<span class="normal">2453</span>
<span class="normal">2454</span>
<span class="normal">2455</span>
<span class="normal">2456</span>
<span class="normal">2457</span>
<span class="normal">2458</span>
<span class="normal">2459</span>
<span class="normal">2460</span>
<span class="normal">2461</span>
<span class="normal">2462</span>
<span class="normal">2463</span>
<span class="normal">2464</span>
<span class="normal">2465</span>
<span class="normal">2466</span>
<span class="normal">2467</span>
<span class="normal">2468</span>
<span class="normal">2469</span>
<span class="normal">2470</span>
<span class="normal">2471</span>
<span class="normal">2472</span>
<span class="normal">2473</span>
<span class="normal">2474</span>
<span class="normal">2475</span>
<span class="normal">2476</span>
<span class="normal">2477</span>
<span class="normal">2478</span>
<span class="normal">2479</span>
<span class="normal">2480</span>
<span class="normal">2481</span>
<span class="normal">2482</span>
<span class="normal">2483</span>
<span class="normal">2484</span>
<span class="normal">2485</span>
<span class="normal">2486</span>
<span class="normal">2487</span>
<span class="normal">2488</span>
<span class="normal">2489</span>
<span class="normal">2490</span>
<span class="normal">2491</span>
<span class="normal">2492</span>
<span class="normal">2493</span>
<span class="normal">2494</span>
<span class="normal">2495</span>
<span class="normal">2496</span>
<span class="normal">2497</span>
<span class="normal">2498</span>
<span class="normal">2499</span>
<span class="normal">2500</span>
<span class="normal">2501</span>
<span class="normal">2502</span>
<span class="normal">2503</span>
<span class="normal">2504</span>
<span class="normal">2505</span>
<span class="normal">2506</span>
<span class="normal">2507</span>
<span class="normal">2508</span>
<span class="normal">2509</span>
<span class="normal">2510</span>
<span class="normal">2511</span>
<span class="normal">2512</span>
<span class="normal">2513</span>
<span class="normal">2514</span>
<span class="normal">2515</span>
<span class="normal">2516</span>
<span class="normal">2517</span>
<span class="normal">2518</span>
<span class="normal">2519</span>
<span class="normal">2520</span>
<span class="normal">2521</span>
<span class="normal">2522</span>
<span class="normal">2523</span>
<span class="normal">2524</span>
<span class="normal">2525</span>
<span class="normal">2526</span>
<span class="normal">2527</span>
<span class="normal">2528</span>
<span class="normal">2529</span>
<span class="normal">2530</span>
<span class="normal">2531</span>
<span class="normal">2532</span>
<span class="normal">2533</span>
<span class="normal">2534</span>
<span class="normal">2535</span>
<span class="normal">2536</span>
<span class="normal">2537</span>
<span class="normal">2538</span>
<span class="normal">2539</span>
<span class="normal">2540</span>
<span class="normal">2541</span>
<span class="normal">2542</span>
<span class="normal">2543</span>
<span class="normal">2544</span>
<span class="normal">2545</span>
<span class="normal">2546</span>
<span class="normal">2547</span>
<span class="normal">2548</span>
<span class="normal">2549</span>
<span class="normal">2550</span>
<span class="normal">2551</span>
<span class="normal">2552</span>
<span class="normal">2553</span>
<span class="normal">2554</span>
<span class="normal">2555</span>
<span class="normal">2556</span>
<span class="normal">2557</span>
<span class="normal">2558</span>
<span class="normal">2559</span>
<span class="normal">2560</span>
<span class="normal">2561</span>
<span class="normal">2562</span>
<span class="normal">2563</span>
<span class="normal">2564</span>
<span class="normal">2565</span>
<span class="normal">2566</span>
<span class="normal">2567</span>
<span class="normal">2568</span>
<span class="normal">2569</span>
<span class="normal">2570</span>
<span class="normal">2571</span>
<span class="normal">2572</span>
<span class="normal">2573</span>
<span class="normal">2574</span>
<span class="normal">2575</span>
<span class="normal">2576</span>
<span class="normal">2577</span>
<span class="normal">2578</span>
<span class="normal">2579</span>
<span class="normal">2580</span>
<span class="normal">2581</span>
<span class="normal">2582</span>
<span class="normal">2583</span>
<span class="normal">2584</span>
<span class="normal">2585</span>
<span class="normal">2586</span>
<span class="normal">2587</span>
<span class="normal">2588</span>
<span class="normal">2589</span>
<span class="normal">2590</span>
<span class="normal">2591</span>
<span class="normal">2592</span>
<span class="normal">2593</span>
<span class="normal">2594</span>
<span class="normal">2595</span>
<span class="normal">2596</span>
<span class="normal">2597</span>
<span class="normal">2598</span>
<span class="normal">2599</span>
<span class="normal">2600</span>
<span class="normal">2601</span>
<span class="normal">2602</span>
<span class="normal">2603</span>
<span class="normal">2604</span>
<span class="normal">2605</span>
<span class="normal">2606</span>
<span class="normal">2607</span>
<span class="normal">2608</span>
<span class="normal">2609</span>
<span class="normal">2610</span>
<span class="normal">2611</span>
<span class="normal">2612</span>
<span class="normal">2613</span>
<span class="normal">2614</span>
<span class="normal">2615</span>
<span class="normal">2616</span>
<span class="normal">2617</span>
<span class="normal">2618</span>
<span class="normal">2619</span>
<span class="normal">2620</span>
<span class="normal">2621</span>
<span class="normal">2622</span>
<span class="normal">2623</span>
<span class="normal">2624</span>
<span class="normal">2625</span>
<span class="normal">2626</span>
<span class="normal">2627</span>
<span class="normal">2628</span>
<span class="normal">2629</span>
<span class="normal">2630</span>
<span class="normal">2631</span>
<span class="normal">2632</span>
<span class="normal">2633</span>
<span class="normal">2634</span>
<span class="normal">2635</span>
<span class="normal">2636</span>
<span class="normal">2637</span>
<span class="normal">2638</span>
<span class="normal">2639</span>
<span class="normal">2640</span>
<span class="normal">2641</span>
<span class="normal">2642</span>
<span class="normal">2643</span>
<span class="normal">2644</span>
<span class="normal">2645</span>
<span class="normal">2646</span>
<span class="normal">2647</span>
<span class="normal">2648</span>
<span class="normal">2649</span>
<span class="normal">2650</span>
<span class="normal">2651</span>
<span class="normal">2652</span>
<span class="normal">2653</span>
<span class="normal">2654</span>
<span class="normal">2655</span>
<span class="normal">2656</span>
<span class="normal">2657</span>
<span class="normal">2658</span>
<span class="normal">2659</span>
<span class="normal">2660</span>
<span class="normal">2661</span>
<span class="normal">2662</span>
<span class="normal">2663</span>
<span class="normal">2664</span>
<span class="normal">2665</span>
<span class="normal">2666</span>
<span class="normal">2667</span>
<span class="normal">2668</span>
<span class="normal">2669</span>
<span class="normal">2670</span>
<span class="normal">2671</span>
<span class="normal">2672</span>
<span class="normal">2673</span>
<span class="normal">2674</span>
<span class="normal">2675</span>
<span class="normal">2676</span>
<span class="normal">2677</span>
<span class="normal">2678</span>
<span class="normal">2679</span>
<span class="normal">2680</span>
<span class="normal">2681</span>
<span class="normal">2682</span>
<span class="normal">2683</span>
<span class="normal">2684</span>
<span class="normal">2685</span>
<span class="normal">2686</span>
<span class="normal">2687</span>
<span class="normal">2688</span>
<span class="normal">2689</span>
<span class="normal">2690</span>
<span class="normal">2691</span>
<span class="normal">2692</span>
<span class="normal">2693</span>
<span class="normal">2694</span>
<span class="normal">2695</span>
<span class="normal">2696</span>
<span class="normal">2697</span>
<span class="normal">2698</span>
<span class="normal">2699</span>
<span class="normal">2700</span>
<span class="normal">2701</span>
<span class="normal">2702</span>
<span class="normal">2703</span>
<span class="normal">2704</span>
<span class="normal">2705</span>
<span class="normal">2706</span>
<span class="normal">2707</span>
<span class="normal">2708</span>
<span class="normal">2709</span>
<span class="normal">2710</span>
<span class="normal">2711</span>
<span class="normal">2712</span>
<span class="normal">2713</span>
<span class="normal">2714</span>
<span class="normal">2715</span>
<span class="normal">2716</span>
<span class="normal">2717</span>
<span class="normal">2718</span>
<span class="normal">2719</span>
<span class="normal">2720</span>
<span class="normal">2721</span>
<span class="normal">2722</span>
<span class="normal">2723</span>
<span class="normal">2724</span>
<span class="normal">2725</span>
<span class="normal">2726</span>
<span class="normal">2727</span>
<span class="normal">2728</span>
<span class="normal">2729</span>
<span class="normal">2730</span>
<span class="normal">2731</span>
<span class="normal">2732</span>
<span class="normal">2733</span>
<span class="normal">2734</span>
<span class="normal">2735</span>
<span class="normal">2736</span>
<span class="normal">2737</span>
<span class="normal">2738</span>
<span class="normal">2739</span>
<span class="normal">2740</span>
<span class="normal">2741</span>
<span class="normal">2742</span>
<span class="normal">2743</span>
<span class="normal">2744</span>
<span class="normal">2745</span>
<span class="normal">2746</span>
<span class="normal">2747</span>
<span class="normal">2748</span>
<span class="normal">2749</span>
<span class="normal">2750</span>
<span class="normal">2751</span>
<span class="normal">2752</span>
<span class="normal">2753</span>
<span class="normal">2754</span>
<span class="normal">2755</span>
<span class="normal">2756</span>
<span class="normal">2757</span>
<span class="normal">2758</span>
<span class="normal">2759</span>
<span class="normal">2760</span>
<span class="normal">2761</span>
<span class="normal">2762</span>
<span class="normal">2763</span>
<span class="normal">2764</span>
<span class="normal">2765</span>
<span class="normal">2766</span>
<span class="normal">2767</span>
<span class="normal">2768</span>
<span class="normal">2769</span>
<span class="normal">2770</span>
<span class="normal">2771</span>
<span class="normal">2772</span>
<span class="normal">2773</span>
<span class="normal">2774</span>
<span class="normal">2775</span>
<span class="normal">2776</span>
<span class="normal">2777</span>
<span class="normal">2778</span>
<span class="normal">2779</span>
<span class="normal">2780</span>
<span class="normal">2781</span>
<span class="normal">2782</span>
<span class="normal">2783</span>
<span class="normal">2784</span>
<span class="normal">2785</span>
<span class="normal">2786</span>
<span class="normal">2787</span>
<span class="normal">2788</span>
<span class="normal">2789</span>
<span class="normal">2790</span>
<span class="normal">2791</span>
<span class="normal">2792</span>
<span class="normal">2793</span>
<span class="normal">2794</span>
<span class="normal">2795</span>
<span class="normal">2796</span>
<span class="normal">2797</span>
<span class="normal">2798</span>
<span class="normal">2799</span>
<span class="normal">2800</span>
<span class="normal">2801</span>
<span class="normal">2802</span>
<span class="normal">2803</span>
<span class="normal">2804</span>
<span class="normal">2805</span>
<span class="normal">2806</span>
<span class="normal">2807</span>
<span class="normal">2808</span>
<span class="normal">2809</span>
<span class="normal">2810</span>
<span class="normal">2811</span>
<span class="normal">2812</span>
<span class="normal">2813</span>
<span class="normal">2814</span>
<span class="normal">2815</span>
<span class="normal">2816</span>
<span class="normal">2817</span>
<span class="normal">2818</span>
<span class="normal">2819</span>
<span class="normal">2820</span>
<span class="normal">2821</span>
<span class="normal">2822</span>
<span class="normal">2823</span>
<span class="normal">2824</span>
<span class="normal">2825</span>
<span class="normal">2826</span>
<span class="normal">2827</span>
<span class="normal">2828</span>
<span class="normal">2829</span>
<span class="normal">2830</span>
<span class="normal">2831</span>
<span class="normal">2832</span>
<span class="normal">2833</span>
<span class="normal">2834</span>
<span class="normal">2835</span>
<span class="normal">2836</span>
<span class="normal">2837</span>
<span class="normal">2838</span>
<span class="normal">2839</span>
<span class="normal">2840</span>
<span class="normal">2841</span>
<span class="normal">2842</span>
<span class="normal">2843</span>
<span class="normal">2844</span>
<span class="normal">2845</span>
<span class="normal">2846</span>
<span class="normal">2847</span>
<span class="normal">2848</span>
<span class="normal">2849</span>
<span class="normal">2850</span>
<span class="normal">2851</span>
<span class="normal">2852</span>
<span class="normal">2853</span>
<span class="normal">2854</span>
<span class="normal">2855</span>
<span class="normal">2856</span>
<span class="normal">2857</span>
<span class="normal">2858</span>
<span class="normal">2859</span>
<span class="normal">2860</span>
<span class="normal">2861</span>
<span class="normal">2862</span>
<span class="normal">2863</span>
<span class="normal">2864</span>
<span class="normal">2865</span>
<span class="normal">2866</span>
<span class="normal">2867</span>
<span class="normal">2868</span>
<span class="normal">2869</span>
<span class="normal">2870</span>
<span class="normal">2871</span>
<span class="normal">2872</span>
<span class="normal">2873</span>
<span class="normal">2874</span>
<span class="normal">2875</span>
<span class="normal">2876</span>
<span class="normal">2877</span>
<span class="normal">2878</span>
<span class="normal">2879</span>
<span class="normal">2880</span>
<span class="normal">2881</span>
<span class="normal">2882</span>
<span class="normal">2883</span>
<span class="normal">2884</span>
<span class="normal">2885</span>
<span class="normal">2886</span>
<span class="normal">2887</span>
<span class="normal">2888</span>
<span class="normal">2889</span>
<span class="normal">2890</span>
<span class="normal">2891</span>
<span class="normal">2892</span>
<span class="normal">2893</span>
<span class="normal">2894</span>
<span class="normal">2895</span>
<span class="normal">2896</span>
<span class="normal">2897</span>
<span class="normal">2898</span>
<span class="normal">2899</span>
<span class="normal">2900</span>
<span class="normal">2901</span>
<span class="normal">2902</span>
<span class="normal">2903</span>
<span class="normal">2904</span>
<span class="normal">2905</span>
<span class="normal">2906</span>
<span class="normal">2907</span>
<span class="normal">2908</span>
<span class="normal">2909</span>
<span class="normal">2910</span>
<span class="normal">2911</span>
<span class="normal">2912</span>
<span class="normal">2913</span>
<span class="normal">2914</span>
<span class="normal">2915</span>
<span class="normal">2916</span>
<span class="normal">2917</span>
<span class="normal">2918</span>
<span class="normal">2919</span>
<span class="normal">2920</span>
<span class="normal">2921</span>
<span class="normal">2922</span>
<span class="normal">2923</span>
<span class="normal">2924</span>
<span class="normal">2925</span>
<span class="normal">2926</span>
<span class="normal">2927</span>
<span class="normal">2928</span>
<span class="normal">2929</span>
<span class="normal">2930</span>
<span class="normal">2931</span>
<span class="normal">2932</span>
<span class="normal">2933</span>
<span class="normal">2934</span>
<span class="normal">2935</span>
<span class="normal">2936</span>
<span class="normal">2937</span>
<span class="normal">2938</span>
<span class="normal">2939</span>
<span class="normal">2940</span>
<span class="normal">2941</span>
<span class="normal">2942</span>
<span class="normal">2943</span>
<span class="normal">2944</span>
<span class="normal">2945</span>
<span class="normal">2946</span>
<span class="normal">2947</span>
<span class="normal">2948</span>
<span class="normal">2949</span>
<span class="normal">2950</span>
<span class="normal">2951</span>
<span class="normal">2952</span>
<span class="normal">2953</span>
<span class="normal">2954</span>
<span class="normal">2955</span>
<span class="normal">2956</span>
<span class="normal">2957</span>
<span class="normal">2958</span>
<span class="normal">2959</span>
<span class="normal">2960</span>
<span class="normal">2961</span>
<span class="normal">2962</span>
<span class="normal">2963</span>
<span class="normal">2964</span>
<span class="normal">2965</span>
<span class="normal">2966</span>
<span class="normal">2967</span>
<span class="normal">2968</span>
<span class="normal">2969</span>
<span class="normal">2970</span>
<span class="normal">2971</span>
<span class="normal">2972</span>
<span class="normal">2973</span>
<span class="normal">2974</span>
<span class="normal">2975</span>
<span class="normal">2976</span>
<span class="normal">2977</span>
<span class="normal">2978</span>
<span class="normal">2979</span>
<span class="normal">2980</span>
<span class="normal">2981</span>
<span class="normal">2982</span>
<span class="normal">2983</span>
<span class="normal">2984</span>
<span class="normal">2985</span>
<span class="normal">2986</span>
<span class="normal">2987</span>
<span class="normal">2988</span>
<span class="normal">2989</span>
<span class="normal">2990</span>
<span class="normal">2991</span>
<span class="normal">2992</span>
<span class="normal">2993</span>
<span class="normal">2994</span>
<span class="normal">2995</span>
<span class="normal">2996</span>
<span class="normal">2997</span>
<span class="normal">2998</span>
<span class="normal">2999</span>
<span class="normal">3000</span>
<span class="normal">3001</span>
<span class="normal">3002</span>
<span class="normal">3003</span>
<span class="normal">3004</span>
<span class="normal">3005</span>
<span class="normal">3006</span>
<span class="normal">3007</span>
<span class="normal">3008</span>
<span class="normal">3009</span>
<span class="normal">3010</span>
<span class="normal">3011</span>
<span class="normal">3012</span>
<span class="normal">3013</span>
<span class="normal">3014</span>
<span class="normal">3015</span>
<span class="normal">3016</span>
<span class="normal">3017</span>
<span class="normal">3018</span>
<span class="normal">3019</span>
<span class="normal">3020</span>
<span class="normal">3021</span>
<span class="normal">3022</span>
<span class="normal">3023</span>
<span class="normal">3024</span>
<span class="normal">3025</span>
<span class="normal">3026</span>
<span class="normal">3027</span>
<span class="normal">3028</span>
<span class="normal">3029</span>
<span class="normal">3030</span>
<span class="normal">3031</span>
<span class="normal">3032</span>
<span class="normal">3033</span>
<span class="normal">3034</span>
<span class="normal">3035</span>
<span class="normal">3036</span>
<span class="normal">3037</span>
<span class="normal">3038</span>
<span class="normal">3039</span>
<span class="normal">3040</span>
<span class="normal">3041</span>
<span class="normal">3042</span>
<span class="normal">3043</span>
<span class="normal">3044</span>
<span class="normal">3045</span>
<span class="normal">3046</span>
<span class="normal">3047</span>
<span class="normal">3048</span>
<span class="normal">3049</span>
<span class="normal">3050</span>
<span class="normal">3051</span>
<span class="normal">3052</span>
<span class="normal">3053</span>
<span class="normal">3054</span>
<span class="normal">3055</span>
<span class="normal">3056</span>
<span class="normal">3057</span>
<span class="normal">3058</span>
<span class="normal">3059</span>
<span class="normal">3060</span>
<span class="normal">3061</span>
<span class="normal">3062</span>
<span class="normal">3063</span>
<span class="normal">3064</span>
<span class="normal">3065</span>
<span class="normal">3066</span>
<span class="normal">3067</span>
<span class="normal">3068</span>
<span class="normal">3069</span>
<span class="normal">3070</span>
<span class="normal">3071</span>
<span class="normal">3072</span>
<span class="normal">3073</span>
<span class="normal">3074</span>
<span class="normal">3075</span>
<span class="normal">3076</span>
<span class="normal">3077</span>
<span class="normal">3078</span>
<span class="normal">3079</span>
<span class="normal">3080</span>
<span class="normal">3081</span>
<span class="normal">3082</span>
<span class="normal">3083</span>
<span class="normal">3084</span>
<span class="normal">3085</span>
<span class="normal">3086</span>
<span class="normal">3087</span>
<span class="normal">3088</span>
<span class="normal">3089</span>
<span class="normal">3090</span>
<span class="normal">3091</span>
<span class="normal">3092</span>
<span class="normal">3093</span>
<span class="normal">3094</span>
<span class="normal">3095</span>
<span class="normal">3096</span>
<span class="normal">3097</span>
<span class="normal">3098</span>
<span class="normal">3099</span>
<span class="normal">3100</span>
<span class="normal">3101</span>
<span class="normal">3102</span>
<span class="normal">3103</span>
<span class="normal">3104</span>
<span class="normal">3105</span>
<span class="normal">3106</span>
<span class="normal">3107</span>
<span class="normal">3108</span>
<span class="normal">3109</span>
<span class="normal">3110</span>
<span class="normal">3111</span>
<span class="normal">3112</span>
<span class="normal">3113</span>
<span class="normal">3114</span>
<span class="normal">3115</span>
<span class="normal">3116</span>
<span class="normal">3117</span>
<span class="normal">3118</span>
<span class="normal">3119</span>
<span class="normal">3120</span>
<span class="normal">3121</span>
<span class="normal">3122</span>
<span class="normal">3123</span>
<span class="normal">3124</span>
<span class="normal">3125</span>
<span class="normal">3126</span>
<span class="normal">3127</span>
<span class="normal">3128</span>
<span class="normal">3129</span>
<span class="normal">3130</span>
<span class="normal">3131</span>
<span class="normal">3132</span>
<span class="normal">3133</span>
<span class="normal">3134</span>
<span class="normal">3135</span>
<span class="normal">3136</span>
<span class="normal">3137</span>
<span class="normal">3138</span>
<span class="normal">3139</span>
<span class="normal">3140</span>
<span class="normal">3141</span>
<span class="normal">3142</span>
<span class="normal">3143</span>
<span class="normal">3144</span>
<span class="normal">3145</span>
<span class="normal">3146</span>
<span class="normal">3147</span>
<span class="normal">3148</span>
<span class="normal">3149</span>
<span class="normal">3150</span>
<span class="normal">3151</span>
<span class="normal">3152</span>
<span class="normal">3153</span>
<span class="normal">3154</span>
<span class="normal">3155</span>
<span class="normal">3156</span>
<span class="normal">3157</span>
<span class="normal">3158</span>
<span class="normal">3159</span>
<span class="normal">3160</span>
<span class="normal">3161</span>
<span class="normal">3162</span>
<span class="normal">3163</span>
<span class="normal">3164</span>
<span class="normal">3165</span>
<span class="normal">3166</span>
<span class="normal">3167</span>
<span class="normal">3168</span>
<span class="normal">3169</span>
<span class="normal">3170</span>
<span class="normal">3171</span>
<span class="normal">3172</span>
<span class="normal">3173</span>
<span class="normal">3174</span>
<span class="normal">3175</span>
<span class="normal">3176</span>
<span class="normal">3177</span>
<span class="normal">3178</span>
<span class="normal">3179</span>
<span class="normal">3180</span>
<span class="normal">3181</span>
<span class="normal">3182</span>
<span class="normal">3183</span>
<span class="normal">3184</span>
<span class="normal">3185</span>
<span class="normal">3186</span>
<span class="normal">3187</span>
<span class="normal">3188</span>
<span class="normal">3189</span>
<span class="normal">3190</span>
<span class="normal">3191</span>
<span class="normal">3192</span>
<span class="normal">3193</span>
<span class="normal">3194</span>
<span class="normal">3195</span>
<span class="normal">3196</span>
<span class="normal">3197</span>
<span class="normal">3198</span>
<span class="normal">3199</span>
<span class="normal">3200</span>
<span class="normal">3201</span>
<span class="normal">3202</span>
<span class="normal">3203</span>
<span class="normal">3204</span>
<span class="normal">3205</span>
<span class="normal">3206</span>
<span class="normal">3207</span>
<span class="normal">3208</span>
<span class="normal">3209</span>
<span class="normal">3210</span>
<span class="normal">3211</span>
<span class="normal">3212</span>
<span class="normal">3213</span>
<span class="normal">3214</span>
<span class="normal">3215</span>
<span class="normal">3216</span>
<span class="normal">3217</span>
<span class="normal">3218</span>
<span class="normal">3219</span>
<span class="normal">3220</span>
<span class="normal">3221</span>
<span class="normal">3222</span>
<span class="normal">3223</span>
<span class="normal">3224</span>
<span class="normal">3225</span>
<span class="normal">3226</span>
<span class="normal">3227</span>
<span class="normal">3228</span>
<span class="normal">3229</span>
<span class="normal">3230</span>
<span class="normal">3231</span>
<span class="normal">3232</span>
<span class="normal">3233</span>
<span class="normal">3234</span>
<span class="normal">3235</span>
<span class="normal">3236</span>
<span class="normal">3237</span>
<span class="normal">3238</span>
<span class="normal">3239</span>
<span class="normal">3240</span>
<span class="normal">3241</span>
<span class="normal">3242</span>
<span class="normal">3243</span>
<span class="normal">3244</span>
<span class="normal">3245</span>
<span class="normal">3246</span>
<span class="normal">3247</span>
<span class="normal">3248</span>
<span class="normal">3249</span>
<span class="normal">3250</span>
<span class="normal">3251</span>
<span class="normal">3252</span>
<span class="normal">3253</span>
<span class="normal">3254</span>
<span class="normal">3255</span>
<span class="normal">3256</span>
<span class="normal">3257</span>
<span class="normal">3258</span>
<span class="normal">3259</span>
<span class="normal">3260</span>
<span class="normal">3261</span>
<span class="normal">3262</span>
<span class="normal">3263</span>
<span class="normal">3264</span>
<span class="normal">3265</span>
<span class="normal">3266</span>
<span class="normal">3267</span>
<span class="normal">3268</span>
<span class="normal">3269</span>
<span class="normal">3270</span>
<span class="normal">3271</span>
<span class="normal">3272</span>
<span class="normal">3273</span>
<span class="normal">3274</span>
<span class="normal">3275</span>
<span class="normal">3276</span>
<span class="normal">3277</span>
<span class="normal">3278</span>
<span class="normal">3279</span>
<span class="normal">3280</span>
<span class="normal">3281</span>
<span class="normal">3282</span>
<span class="normal">3283</span>
<span class="normal">3284</span>
<span class="normal">3285</span>
<span class="normal">3286</span>
<span class="normal">3287</span>
<span class="normal">3288</span>
<span class="normal">3289</span>
<span class="normal">3290</span>
<span class="normal">3291</span>
<span class="normal">3292</span>
<span class="normal">3293</span>
<span class="normal">3294</span>
<span class="normal">3295</span>
<span class="normal">3296</span>
<span class="normal">3297</span>
<span class="normal">3298</span>
<span class="normal">3299</span>
<span class="normal">3300</span>
<span class="normal">3301</span>
<span class="normal">3302</span>
<span class="normal">3303</span>
<span class="normal">3304</span>
<span class="normal">3305</span>
<span class="normal">3306</span>
<span class="normal">3307</span>
<span class="normal">3308</span>
<span class="normal">3309</span>
<span class="normal">3310</span>
<span class="normal">3311</span>
<span class="normal">3312</span>
<span class="normal">3313</span>
<span class="normal">3314</span>
<span class="normal">3315</span>
<span class="normal">3316</span>
<span class="normal">3317</span>
<span class="normal">3318</span>
<span class="normal">3319</span>
<span class="normal">3320</span>
<span class="normal">3321</span>
<span class="normal">3322</span>
<span class="normal">3323</span>
<span class="normal">3324</span>
<span class="normal">3325</span>
<span class="normal">3326</span>
<span class="normal">3327</span>
<span class="normal">3328</span>
<span class="normal">3329</span>
<span class="normal">3330</span>
<span class="normal">3331</span>
<span class="normal">3332</span>
<span class="normal">3333</span>
<span class="normal">3334</span>
<span class="normal">3335</span>
<span class="normal">3336</span>
<span class="normal">3337</span>
<span class="normal">3338</span>
<span class="normal">3339</span>
<span class="normal">3340</span>
<span class="normal">3341</span>
<span class="normal">3342</span>
<span class="normal">3343</span>
<span class="normal">3344</span>
<span class="normal">3345</span>
<span class="normal">3346</span>
<span class="normal">3347</span>
<span class="normal">3348</span>
<span class="normal">3349</span>
<span class="normal">3350</span>
<span class="normal">3351</span>
<span class="normal">3352</span>
<span class="normal">3353</span>
<span class="normal">3354</span>
<span class="normal">3355</span>
<span class="normal">3356</span>
<span class="normal">3357</span>
<span class="normal">3358</span>
<span class="normal">3359</span>
<span class="normal">3360</span>
<span class="normal">3361</span>
<span class="normal">3362</span>
<span class="normal">3363</span>
<span class="normal">3364</span>
<span class="normal">3365</span>
<span class="normal">3366</span>
<span class="normal">3367</span>
<span class="normal">3368</span>
<span class="normal">3369</span>
<span class="normal">3370</span>
<span class="normal">3371</span>
<span class="normal">3372</span>
<span class="normal">3373</span>
<span class="normal">3374</span>
<span class="normal">3375</span>
<span class="normal">3376</span>
<span class="normal">3377</span>
<span class="normal">3378</span>
<span class="normal">3379</span>
<span class="normal">3380</span>
<span class="normal">3381</span>
<span class="normal">3382</span>
<span class="normal">3383</span>
<span class="normal">3384</span>
<span class="normal">3385</span>
<span class="normal">3386</span>
<span class="normal">3387</span>
<span class="normal">3388</span>
<span class="normal">3389</span>
<span class="normal">3390</span>
<span class="normal">3391</span>
<span class="normal">3392</span>
<span class="normal">3393</span>
<span class="normal">3394</span>
<span class="normal">3395</span>
<span class="normal">3396</span>
<span class="normal">3397</span>
<span class="normal">3398</span>
<span class="normal">3399</span>
<span class="normal">3400</span>
<span class="normal">3401</span>
<span class="normal">3402</span>
<span class="normal">3403</span>
<span class="normal">3404</span>
<span class="normal">3405</span>
<span class="normal">3406</span>
<span class="normal">3407</span>
<span class="normal">3408</span>
<span class="normal">3409</span>
<span class="normal">3410</span>
<span class="normal">3411</span>
<span class="normal">3412</span>
<span class="normal">3413</span>
<span class="normal">3414</span>
<span class="normal">3415</span>
<span class="normal">3416</span>
<span class="normal">3417</span>
<span class="normal">3418</span>
<span class="normal">3419</span>
<span class="normal">3420</span>
<span class="normal">3421</span>
<span class="normal">3422</span>
<span class="normal">3423</span>
<span class="normal">3424</span>
<span class="normal">3425</span>
<span class="normal">3426</span>
<span class="normal">3427</span>
<span class="normal">3428</span>
<span class="normal">3429</span>
<span class="normal">3430</span>
<span class="normal">3431</span>
<span class="normal">3432</span>
<span class="normal">3433</span>
<span class="normal">3434</span>
<span class="normal">3435</span>
<span class="normal">3436</span>
<span class="normal">3437</span>
<span class="normal">3438</span>
<span class="normal">3439</span>
<span class="normal">3440</span>
<span class="normal">3441</span>
<span class="normal">3442</span>
<span class="normal">3443</span>
<span class="normal">3444</span>
<span class="normal">3445</span>
<span class="normal">3446</span>
<span class="normal">3447</span>
<span class="normal">3448</span>
<span class="normal">3449</span>
<span class="normal">3450</span>
<span class="normal">3451</span>
<span class="normal">3452</span>
<span class="normal">3453</span>
<span class="normal">3454</span>
<span class="normal">3455</span>
<span class="normal">3456</span>
<span class="normal">3457</span>
<span class="normal">3458</span>
<span class="normal">3459</span>
<span class="normal">3460</span>
<span class="normal">3461</span>
<span class="normal">3462</span>
<span class="normal">3463</span>
<span class="normal">3464</span>
<span class="normal">3465</span>
<span class="normal">3466</span>
<span class="normal">3467</span>
<span class="normal">3468</span>
<span class="normal">3469</span>
<span class="normal">3470</span>
<span class="normal">3471</span>
<span class="normal">3472</span>
<span class="normal">3473</span>
<span class="normal">3474</span>
<span class="normal">3475</span>
<span class="normal">3476</span>
<span class="normal">3477</span>
<span class="normal">3478</span>
<span class="normal">3479</span>
<span class="normal">3480</span>
<span class="normal">3481</span>
<span class="normal">3482</span>
<span class="normal">3483</span>
<span class="normal">3484</span>
<span class="normal">3485</span>
<span class="normal">3486</span>
<span class="normal">3487</span>
<span class="normal">3488</span>
<span class="normal">3489</span>
<span class="normal">3490</span>
<span class="normal">3491</span>
<span class="normal">3492</span>
<span class="normal">3493</span>
<span class="normal">3494</span>
<span class="normal">3495</span>
<span class="normal">3496</span>
<span class="normal">3497</span>
<span class="normal">3498</span>
<span class="normal">3499</span>
<span class="normal">3500</span>
<span class="normal">3501</span>
<span class="normal">3502</span>
<span class="normal">3503</span>
<span class="normal">3504</span>
<span class="normal">3505</span>
<span class="normal">3506</span>
<span class="normal">3507</span>
<span class="normal">3508</span>
<span class="normal">3509</span>
<span class="normal">3510</span>
<span class="normal">3511</span>
<span class="normal">3512</span>
<span class="normal">3513</span>
<span class="normal">3514</span>
<span class="normal">3515</span>
<span class="normal">3516</span>
<span class="normal">3517</span>
<span class="normal">3518</span>
<span class="normal">3519</span>
<span class="normal">3520</span>
<span class="normal">3521</span>
<span class="normal">3522</span>
<span class="normal">3523</span>
<span class="normal">3524</span>
<span class="normal">3525</span>
<span class="normal">3526</span>
<span class="normal">3527</span>
<span class="normal">3528</span>
<span class="normal">3529</span>
<span class="normal">3530</span>
<span class="normal">3531</span>
<span class="normal">3532</span>
<span class="normal">3533</span>
<span class="normal">3534</span>
<span class="normal">3535</span>
<span class="normal">3536</span>
<span class="normal">3537</span>
<span class="normal">3538</span>
<span class="normal">3539</span>
<span class="normal">3540</span>
<span class="normal">3541</span>
<span class="normal">3542</span>
<span class="normal">3543</span>
<span class="normal">3544</span>
<span class="normal">3545</span>
<span class="normal">3546</span>
<span class="normal">3547</span>
<span class="normal">3548</span>
<span class="normal">3549</span>
<span class="normal">3550</span>
<span class="normal">3551</span>
<span class="normal">3552</span>
<span class="normal">3553</span>
<span class="normal">3554</span>
<span class="normal">3555</span>
<span class="normal">3556</span>
<span class="normal">3557</span>
<span class="normal">3558</span>
<span class="normal">3559</span>
<span class="normal">3560</span>
<span class="normal">3561</span>
<span class="normal">3562</span>
<span class="normal">3563</span>
<span class="normal">3564</span>
<span class="normal">3565</span>
<span class="normal">3566</span>
<span class="normal">3567</span>
<span class="normal">3568</span>
<span class="normal">3569</span>
<span class="normal">3570</span>
<span class="normal">3571</span>
<span class="normal">3572</span>
<span class="normal">3573</span>
<span class="normal">3574</span>
<span class="normal">3575</span>
<span class="normal">3576</span>
<span class="normal">3577</span>
<span class="normal">3578</span>
<span class="normal">3579</span>
<span class="normal">3580</span>
<span class="normal">3581</span>
<span class="normal">3582</span>
<span class="normal">3583</span>
<span class="normal">3584</span>
<span class="normal">3585</span>
<span class="normal">3586</span>
<span class="normal">3587</span>
<span class="normal">3588</span>
<span class="normal">3589</span>
<span class="normal">3590</span>
<span class="normal">3591</span>
<span class="normal">3592</span>
<span class="normal">3593</span>
<span class="normal">3594</span>
<span class="normal">3595</span>
<span class="normal">3596</span>
<span class="normal">3597</span>
<span class="normal">3598</span>
<span class="normal">3599</span>
<span class="normal">3600</span>
<span class="normal">3601</span>
<span class="normal">3602</span>
<span class="normal">3603</span>
<span class="normal">3604</span>
<span class="normal">3605</span>
<span class="normal">3606</span>
<span class="normal">3607</span>
<span class="normal">3608</span>
<span class="normal">3609</span>
<span class="normal">3610</span>
<span class="normal">3611</span>
<span class="normal">3612</span>
<span class="normal">3613</span>
<span class="normal">3614</span>
<span class="normal">3615</span>
<span class="normal">3616</span>
<span class="normal">3617</span>
<span class="normal">3618</span>
<span class="normal">3619</span>
<span class="normal">3620</span>
<span class="normal">3621</span>
<span class="normal">3622</span>
<span class="normal">3623</span>
<span class="normal">3624</span>
<span class="normal">3625</span>
<span class="normal">3626</span>
<span class="normal">3627</span>
<span class="normal">3628</span>
<span class="normal">3629</span>
<span class="normal">3630</span>
<span class="normal">3631</span>
<span class="normal">3632</span>
<span class="normal">3633</span>
<span class="normal">3634</span>
<span class="normal">3635</span>
<span class="normal">3636</span>
<span class="normal">3637</span>
<span class="normal">3638</span>
<span class="normal">3639</span>
<span class="normal">3640</span>
<span class="normal">3641</span>
<span class="normal">3642</span>
<span class="normal">3643</span>
<span class="normal">3644</span>
<span class="normal">3645</span>
<span class="normal">3646</span>
<span class="normal">3647</span>
<span class="normal">3648</span>
<span class="normal">3649</span>
<span class="normal">3650</span>
<span class="normal">3651</span>
<span class="normal">3652</span>
<span class="normal">3653</span>
<span class="normal">3654</span>
<span class="normal">3655</span>
<span class="normal">3656</span>
<span class="normal">3657</span>
<span class="normal">3658</span>
<span class="normal">3659</span>
<span class="normal">3660</span>
<span class="normal">3661</span>
<span class="normal">3662</span>
<span class="normal">3663</span>
<span class="normal">3664</span>
<span class="normal">3665</span>
<span class="normal">3666</span>
<span class="normal">3667</span>
<span class="normal">3668</span>
<span class="normal">3669</span>
<span class="normal">3670</span>
<span class="normal">3671</span>
<span class="normal">3672</span>
<span class="normal">3673</span>
<span class="normal">3674</span>
<span class="normal">3675</span>
<span class="normal">3676</span>
<span class="normal">3677</span>
<span class="normal">3678</span>
<span class="normal">3679</span>
<span class="normal">3680</span>
<span class="normal">3681</span>
<span class="normal">3682</span>
<span class="normal">3683</span>
<span class="normal">3684</span>
<span class="normal">3685</span>
<span class="normal">3686</span>
<span class="normal">3687</span>
<span class="normal">3688</span>
<span class="normal">3689</span>
<span class="normal">3690</span>
<span class="normal">3691</span>
<span class="normal">3692</span>
<span class="normal">3693</span>
<span class="normal">3694</span>
<span class="normal">3695</span>
<span class="normal">3696</span>
<span class="normal">3697</span>
<span class="normal">3698</span>
<span class="normal">3699</span>
<span class="normal">3700</span>
<span class="normal">3701</span>
<span class="normal">3702</span>
<span class="normal">3703</span>
<span class="normal">3704</span>
<span class="normal">3705</span>
<span class="normal">3706</span>
<span class="normal">3707</span>
<span class="normal">3708</span>
<span class="normal">3709</span>
<span class="normal">3710</span>
<span class="normal">3711</span>
<span class="normal">3712</span>
<span class="normal">3713</span>
<span class="normal">3714</span>
<span class="normal">3715</span>
<span class="normal">3716</span>
<span class="normal">3717</span>
<span class="normal">3718</span>
<span class="normal">3719</span>
<span class="normal">3720</span>
<span class="normal">3721</span>
<span class="normal">3722</span>
<span class="normal">3723</span>
<span class="normal">3724</span>
<span class="normal">3725</span>
<span class="normal">3726</span>
<span class="normal">3727</span>
<span class="normal">3728</span>
<span class="normal">3729</span>
<span class="normal">3730</span>
<span class="normal">3731</span>
<span class="normal">3732</span>
<span class="normal">3733</span>
<span class="normal">3734</span>
<span class="normal">3735</span>
<span class="normal">3736</span>
<span class="normal">3737</span>
<span class="normal">3738</span>
<span class="normal">3739</span>
<span class="normal">3740</span>
<span class="normal">3741</span>
<span class="normal">3742</span>
<span class="normal">3743</span>
<span class="normal">3744</span>
<span class="normal">3745</span>
<span class="normal">3746</span>
<span class="normal">3747</span>
<span class="normal">3748</span>
<span class="normal">3749</span>
<span class="normal">3750</span>
<span class="normal">3751</span>
<span class="normal">3752</span>
<span class="normal">3753</span>
<span class="normal">3754</span>
<span class="normal">3755</span>
<span class="normal">3756</span>
<span class="normal">3757</span>
<span class="normal">3758</span>
<span class="normal">3759</span>
<span class="normal">3760</span>
<span class="normal">3761</span>
<span class="normal">3762</span>
<span class="normal">3763</span>
<span class="normal">3764</span>
<span class="normal">3765</span>
<span class="normal">3766</span>
<span class="normal">3767</span>
<span class="normal">3768</span>
<span class="normal">3769</span>
<span class="normal">3770</span>
<span class="normal">3771</span>
<span class="normal">3772</span>
<span class="normal">3773</span>
<span class="normal">3774</span>
<span class="normal">3775</span>
<span class="normal">3776</span>
<span class="normal">3777</span>
<span class="normal">3778</span>
<span class="normal">3779</span>
<span class="normal">3780</span>
<span class="normal">3781</span>
<span class="normal">3782</span>
<span class="normal">3783</span>
<span class="normal">3784</span>
<span class="normal">3785</span>
<span class="normal">3786</span>
<span class="normal">3787</span>
<span class="normal">3788</span>
<span class="normal">3789</span>
<span class="normal">3790</span>
<span class="normal">3791</span>
<span class="normal">3792</span>
<span class="normal">3793</span>
<span class="normal">3794</span>
<span class="normal">3795</span>
<span class="normal">3796</span>
<span class="normal">3797</span>
<span class="normal">3798</span>
<span class="normal">3799</span>
<span class="normal">3800</span>
<span class="normal">3801</span>
<span class="normal">3802</span>
<span class="normal">3803</span>
<span class="normal">3804</span>
<span class="normal">3805</span>
<span class="normal">3806</span>
<span class="normal">3807</span>
<span class="normal">3808</span>
<span class="normal">3809</span>
<span class="normal">3810</span>
<span class="normal">3811</span>
<span class="normal">3812</span>
<span class="normal">3813</span>
<span class="normal">3814</span>
<span class="normal">3815</span>
<span class="normal">3816</span>
<span class="normal">3817</span>
<span class="normal">3818</span>
<span class="normal">3819</span>
<span class="normal">3820</span>
<span class="normal">3821</span>
<span class="normal">3822</span>
<span class="normal">3823</span>
<span class="normal">3824</span>
<span class="normal">3825</span>
<span class="normal">3826</span>
<span class="normal">3827</span>
<span class="normal">3828</span>
<span class="normal">3829</span>
<span class="normal">3830</span>
<span class="normal">3831</span>
<span class="normal">3832</span>
<span class="normal">3833</span>
<span class="normal">3834</span>
<span class="normal">3835</span>
<span class="normal">3836</span>
<span class="normal">3837</span>
<span class="normal">3838</span>
<span class="normal">3839</span>
<span class="normal">3840</span>
<span class="normal">3841</span>
<span class="normal">3842</span>
<span class="normal">3843</span>
<span class="normal">3844</span>
<span class="normal">3845</span>
<span class="normal">3846</span>
<span class="normal">3847</span>
<span class="normal">3848</span>
<span class="normal">3849</span>
<span class="normal">3850</span>
<span class="normal">3851</span>
<span class="normal">3852</span>
<span class="normal">3853</span>
<span class="normal">3854</span>
<span class="normal">3855</span>
<span class="normal">3856</span>
<span class="normal">3857</span>
<span class="normal">3858</span>
<span class="normal">3859</span>
<span class="normal">3860</span>
<span class="normal">3861</span>
<span class="normal">3862</span>
<span class="normal">3863</span>
<span class="normal">3864</span>
<span class="normal">3865</span>
<span class="normal">3866</span>
<span class="normal">3867</span>
<span class="normal">3868</span>
<span class="normal">3869</span>
<span class="normal">3870</span>
<span class="normal">3871</span>
<span class="normal">3872</span>
<span class="normal">3873</span>
<span class="normal">3874</span>
<span class="normal">3875</span>
<span class="normal">3876</span>
<span class="normal">3877</span>
<span class="normal">3878</span>
<span class="normal">3879</span>
<span class="normal">3880</span>
<span class="normal">3881</span>
<span class="normal">3882</span>
<span class="normal">3883</span>
<span class="normal">3884</span>
<span class="normal">3885</span>
<span class="normal">3886</span>
<span class="normal">3887</span>
<span class="normal">3888</span>
<span class="normal">3889</span>
<span class="normal">3890</span>
<span class="normal">3891</span>
<span class="normal">3892</span>
<span class="normal">3893</span>
<span class="normal">3894</span>
<span class="normal">3895</span>
<span class="normal">3896</span></pre></div></td><td class="code"><div><pre><span></span><a id="line-1" name="line-1"></a><span class="cm">/* -*- Mode: C; c-set-style: linux indent-tabs-mode: t; c-basic-offset: 8; tab-width: 8 -*- */</span>
<a id="line-2" name="line-2"></a><span class="cm">/* mate-desktop-item.c - MATE Desktop File Representation</span>
<a id="line-3" name="line-3"></a>
<a id="line-4" name="line-4"></a><span class="cm">   Copyright (C) 1999, 2000 Red Hat Inc.</span>
<a id="line-5" name="line-5"></a><span class="cm">   Copyright (C) 2001 Sid Vicious</span>
<a id="line-6" name="line-6"></a><span class="cm">   All rights reserved.</span>
<a id="line-7" name="line-7"></a>
<a id="line-8" name="line-8"></a><span class="cm">   This file is part of the Mate Library.</span>
<a id="line-9" name="line-9"></a>
<a id="line-10" name="line-10"></a><span class="cm">   Developed by Elliot Lee &lt;sopwith@redhat.com&gt; and Sid Vicious</span>
<a id="line-11" name="line-11"></a>
<a id="line-12" name="line-12"></a><span class="cm">   The Mate Library is free software; you can redistribute it and/or</span>
<a id="line-13" name="line-13"></a><span class="cm">   modify it under the terms of the GNU Library General Public License as</span>
<a id="line-14" name="line-14"></a><span class="cm">   published by the Free Software Foundation; either version 2 of the</span>
<a id="line-15" name="line-15"></a><span class="cm">   License, or (at your option) any later version.</span>
<a id="line-16" name="line-16"></a>
<a id="line-17" name="line-17"></a><span class="cm">   The Mate Library is distributed in the hope that it will be useful,</span>
<a id="line-18" name="line-18"></a><span class="cm">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a id="line-19" name="line-19"></a><span class="cm">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<a id="line-20" name="line-20"></a><span class="cm">   Library General Public License for more details.</span>
<a id="line-21" name="line-21"></a>
<a id="line-22" name="line-22"></a><span class="cm">   You should have received a copy of the GNU Library General Public</span>
<a id="line-23" name="line-23"></a><span class="cm">   License along with the Mate Library; see the file COPYING.LIB.  If not,</span>
<a id="line-24" name="line-24"></a><span class="cm">   write to the Free Software Foundation, Inc., 51 Franklin St, Fifth Floor,</span>
<a id="line-25" name="line-25"></a><span class="cm">   Boston, MA 02110-1301, USA.  */</span>
<a id="line-26" name="line-26"></a><span class="cm">/*</span>
<a id="line-27" name="line-27"></a><span class="cm">  @NOTATION@</span>
<a id="line-28" name="line-28"></a><span class="cm"> */</span>
<a id="line-29" name="line-29"></a>
<a id="line-30" name="line-30"></a><span class="hll"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;config.h&quot;</span><span class="error2">&lt;--- Include file: "config.h" not found.</span>
</span><a id="line-31" name="line-31"></a>
<a id="line-32" name="line-32"></a><span class="hll"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;limits.h&gt;</span><span class="error2">&lt;--- Include file: <limits.h> not found. Please note: Cppcheck does not need standard library headers to get proper results.</span>
</span><a id="line-33" name="line-33"></a><span class="hll"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ctype.h&gt;</span><span class="error2">&lt;--- Include file: <ctype.h> not found. Please note: Cppcheck does not need standard library headers to get proper results.</span>
</span><a id="line-34" name="line-34"></a><span class="hll"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span><span class="error2">&lt;--- Include file: <stdio.h> not found. Please note: Cppcheck does not need standard library headers to get proper results.</span>
</span><a id="line-35" name="line-35"></a><span class="hll"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;glib.h&gt;</span><span class="error2">&lt;--- Include file: <glib.h> not found. Please note: Cppcheck does not need standard library headers to get proper results.</span>
</span><a id="line-36" name="line-36"></a><span class="hll"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sys/types.h&gt;</span><span class="error2">&lt;--- Include file: <sys/types.h> not found. Please note: Cppcheck does not need standard library headers to get proper results.</span>
</span><a id="line-37" name="line-37"></a><span class="hll"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;dirent.h&gt;</span><span class="error2">&lt;--- Include file: <dirent.h> not found. Please note: Cppcheck does not need standard library headers to get proper results.</span>
</span><a id="line-38" name="line-38"></a><span class="hll"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;unistd.h&gt;</span><span class="error2">&lt;--- Include file: <unistd.h> not found. Please note: Cppcheck does not need standard library headers to get proper results.</span>
</span><a id="line-39" name="line-39"></a><span class="hll"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;time.h&gt;</span><span class="error2">&lt;--- Include file: <time.h> not found. Please note: Cppcheck does not need standard library headers to get proper results.</span>
</span><a id="line-40" name="line-40"></a><span class="hll"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string.h&gt;</span><span class="error2">&lt;--- Include file: <string.h> not found. Please note: Cppcheck does not need standard library headers to get proper results.</span>
</span><a id="line-41" name="line-41"></a><span class="hll"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;glib/gi18n-lib.h&gt;</span><span class="error2">&lt;--- Include file: <glib/gi18n-lib.h> not found. Please note: Cppcheck does not need standard library headers to get proper results.</span>
</span><a id="line-42" name="line-42"></a><span class="hll"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;locale.h&gt;</span><span class="error2">&lt;--- Include file: <locale.h> not found. Please note: Cppcheck does not need standard library headers to get proper results.</span>
</span><a id="line-43" name="line-43"></a><span class="hll"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span><span class="error2">&lt;--- Include file: <stdlib.h> not found. Please note: Cppcheck does not need standard library headers to get proper results.</span>
</span><a id="line-44" name="line-44"></a>
<a id="line-45" name="line-45"></a><span class="hll"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;gio/gio.h&gt;</span><span class="error2">&lt;--- Include file: <gio/gio.h> not found. Please note: Cppcheck does not need standard library headers to get proper results.</span>
</span><a id="line-46" name="line-46"></a>
<a id="line-47" name="line-47"></a><span class="cp">#ifdef HAVE_STARTUP_NOTIFICATION</span>
<a id="line-48" name="line-48"></a><span class="cp">#define SN_API_NOT_YET_FROZEN</span>
<a id="line-49" name="line-49"></a><span class="hll"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;libsn/sn.h&gt;</span><span class="error2">&lt;--- Include file: <libsn/sn.h> not found. Please note: Cppcheck does not need standard library headers to get proper results.</span>
</span><a id="line-50" name="line-50"></a><span class="hll"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;gdk/gdk.h&gt;</span><span class="error2">&lt;--- Include file: <gdk/gdk.h> not found. Please note: Cppcheck does not need standard library headers to get proper results.</span>
</span><a id="line-51" name="line-51"></a><span class="hll"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;gdk/gdkx.h&gt;</span><span class="error2">&lt;--- Include file: <gdk/gdkx.h> not found. Please note: Cppcheck does not need standard library headers to get proper results.</span>
</span><a id="line-52" name="line-52"></a><span class="hll"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;gtk/gtk.h&gt;</span><span class="error2">&lt;--- Include file: <gtk/gtk.h> not found. Please note: Cppcheck does not need standard library headers to get proper results.</span>
</span><a id="line-53" name="line-53"></a><span class="cp">#endif</span>
<a id="line-54" name="line-54"></a>
<a id="line-55" name="line-55"></a><span class="cp">#define MATE_DESKTOP_USE_UNSTABLE_API</span>
<a id="line-56" name="line-56"></a><span class="cp">#undef MATE_DISABLE_DEPRECATED</span>
<a id="line-57" name="line-57"></a><span class="hll"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;mate-desktop-item.h&gt;</span><span class="error2">&lt;--- Include file: <mate-desktop-item.h> not found. Please note: Cppcheck does not need standard library headers to get proper results.</span>
</span><a id="line-58" name="line-58"></a><span class="hll"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;mate-desktop-utils.h&gt;</span><span class="error2">&lt;--- Include file: <mate-desktop-utils.h> not found. Please note: Cppcheck does not need standard library headers to get proper results.</span>
</span><a id="line-59" name="line-59"></a>
<a id="line-60" name="line-60"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;private.h&quot;</span>
<a id="line-61" name="line-61"></a>
<a id="line-62" name="line-62"></a><span class="k">struct</span><span class="w"> </span><span class="nc">_MateDesktopItem</span><span class="w"> </span><span class="p">{</span>
<a id="line-63" name="line-63"></a><span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">refcount</span><span class="p">;</span>
<a id="line-64" name="line-64"></a>
<a id="line-65" name="line-65"></a><span class="w">	</span><span class="cm">/* all languages used */</span>
<a id="line-66" name="line-66"></a><span class="w">	</span><span class="n">GList</span><span class="w"> </span><span class="o">*</span><span class="n">languages</span><span class="p">;</span>
<a id="line-67" name="line-67"></a>
<a id="line-68" name="line-68"></a><span class="w">	</span><span class="n">MateDesktopItemType</span><span class="w"> </span><span class="n">type</span><span class="p">;</span>
<a id="line-69" name="line-69"></a>
<a id="line-70" name="line-70"></a><span class="w">	</span><span class="cm">/* `modified&#39; means that the ditem has been</span>
<a id="line-71" name="line-71"></a><span class="cm">	 * modified since the last save. */</span>
<a id="line-72" name="line-72"></a><span class="w">	</span><span class="n">gboolean</span><span class="w"> </span><span class="n">modified</span><span class="p">;</span>
<a id="line-73" name="line-73"></a>
<a id="line-74" name="line-74"></a><span class="w">	</span><span class="cm">/* Keys of the main section only */</span>
<a id="line-75" name="line-75"></a><span class="w">	</span><span class="n">GList</span><span class="w"> </span><span class="o">*</span><span class="n">keys</span><span class="p">;</span>
<a id="line-76" name="line-76"></a>
<a id="line-77" name="line-77"></a><span class="w">	</span><span class="n">GList</span><span class="w"> </span><span class="o">*</span><span class="n">sections</span><span class="p">;</span>
<a id="line-78" name="line-78"></a>
<a id="line-79" name="line-79"></a><span class="w">	</span><span class="cm">/* This includes ALL keys, including</span>
<a id="line-80" name="line-80"></a><span class="cm">	 * other sections, separated by &#39;/&#39; */</span>
<a id="line-81" name="line-81"></a><span class="w">	</span><span class="n">GHashTable</span><span class="w"> </span><span class="o">*</span><span class="n">main_hash</span><span class="p">;</span>
<a id="line-82" name="line-82"></a>
<a id="line-83" name="line-83"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">location</span><span class="p">;</span>
<a id="line-84" name="line-84"></a>
<a id="line-85" name="line-85"></a><span class="w">	</span><span class="n">gint64</span><span class="w"> </span><span class="n">mtime</span><span class="p">;</span>
<a id="line-86" name="line-86"></a>
<a id="line-87" name="line-87"></a><span class="w">	</span><span class="n">guint32</span><span class="w"> </span><span class="n">launch_time</span><span class="p">;</span>
<a id="line-88" name="line-88"></a><span class="p">};</span>
<a id="line-89" name="line-89"></a>
<a id="line-90" name="line-90"></a><span class="cm">/* If mtime is set to this, set_location won&#39;t update mtime,</span>
<a id="line-91" name="line-91"></a><span class="cm"> * this is to be used internally only. */</span>
<a id="line-92" name="line-92"></a><span class="cp">#define DONT_UPDATE_MTIME ((gint64)-2)</span>
<a id="line-93" name="line-93"></a>
<a id="line-94" name="line-94"></a><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<a id="line-95" name="line-95"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="p">;</span>
<a id="line-96" name="line-96"></a><span class="w">	</span><span class="n">GList</span><span class="w"> </span><span class="o">*</span><span class="n">keys</span><span class="p">;</span>
<a id="line-97" name="line-97"></a><span class="p">}</span><span class="w"> </span><span class="n">Section</span><span class="p">;</span>
<a id="line-98" name="line-98"></a>
<a id="line-99" name="line-99"></a><span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="p">{</span>
<a id="line-100" name="line-100"></a><span class="w">	</span><span class="n">ENCODING_UNKNOWN</span><span class="p">,</span>
<a id="line-101" name="line-101"></a><span class="w">	</span><span class="n">ENCODING_UTF8</span><span class="p">,</span>
<a id="line-102" name="line-102"></a><span class="w">	</span><span class="n">ENCODING_LEGACY_MIXED</span>
<a id="line-103" name="line-103"></a><span class="p">}</span><span class="w"> </span><span class="n">Encoding</span><span class="p">;</span>
<a id="line-104" name="line-104"></a>
<a id="line-105" name="line-105"></a><span class="cm">/*</span>
<a id="line-106" name="line-106"></a><span class="cm"> * IO reading utils, that look like the libc buffered io stuff</span>
<a id="line-107" name="line-107"></a><span class="cm"> */</span>
<a id="line-108" name="line-108"></a>
<a id="line-109" name="line-109"></a><span class="cp">#define READ_BUF_SIZE (32 * 1024)</span>
<a id="line-110" name="line-110"></a>
<a id="line-111" name="line-111"></a><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<a id="line-112" name="line-112"></a><span class="w">	</span><span class="n">GFile</span><span class="w"> </span><span class="o">*</span><span class="n">file</span><span class="p">;</span>
<a id="line-113" name="line-113"></a><span class="w">	</span><span class="n">GFileInputStream</span><span class="w"> </span><span class="o">*</span><span class="n">stream</span><span class="p">;</span>
<a id="line-114" name="line-114"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">uri</span><span class="p">;</span>
<a id="line-115" name="line-115"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="p">;</span>
<a id="line-116" name="line-116"></a><span class="w">	</span><span class="n">gboolean</span><span class="w"> </span><span class="n">buf_needs_free</span><span class="p">;</span>
<a id="line-117" name="line-117"></a><span class="w">	</span><span class="n">gboolean</span><span class="w"> </span><span class="n">past_first_read</span><span class="p">;</span>
<a id="line-118" name="line-118"></a><span class="w">	</span><span class="n">gboolean</span><span class="w"> </span><span class="n">eof</span><span class="p">;</span>
<a id="line-119" name="line-119"></a><span class="w">	</span><span class="n">guint64</span><span class="w"> </span><span class="n">size</span><span class="p">;</span>
<a id="line-120" name="line-120"></a><span class="w">	</span><span class="n">gsize</span><span class="w"> </span><span class="n">pos</span><span class="p">;</span>
<a id="line-121" name="line-121"></a><span class="p">}</span><span class="w"> </span><span class="n">ReadBuf</span><span class="p">;</span>
<a id="line-122" name="line-122"></a>
<a id="line-123" name="line-123"></a><span class="k">static</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="nf">ditem_load</span><span class="w"> </span><span class="p">(</span><span class="n">ReadBuf</span><span class="w">           </span><span class="o">*</span><span class="n">rb</span><span class="p">,</span>
<a id="line-124" name="line-124"></a><span class="w">				     </span><span class="n">gboolean</span><span class="w">           </span><span class="n">no_translations</span><span class="p">,</span>
<a id="line-125" name="line-125"></a><span class="w">				     </span><span class="n">GError</span><span class="w">           </span><span class="o">**</span><span class="n">error</span><span class="p">);</span>
<a id="line-126" name="line-126"></a><span class="k">static</span><span class="w"> </span><span class="n">gboolean</span><span class="w">          </span><span class="nf">ditem_save</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="w">  </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-127" name="line-127"></a><span class="w">				     </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w">        </span><span class="o">*</span><span class="n">uri</span><span class="p">,</span>
<a id="line-128" name="line-128"></a><span class="w">				     </span><span class="n">GError</span><span class="w">           </span><span class="o">**</span><span class="n">error</span><span class="p">);</span>
<a id="line-129" name="line-129"></a>
<a id="line-130" name="line-130"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">mate_desktop_item_set_location_gfile</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-131" name="line-131"></a><span class="w">						   </span><span class="n">GFile</span><span class="w">            </span><span class="o">*</span><span class="n">file</span><span class="p">);</span>
<a id="line-132" name="line-132"></a>
<a id="line-133" name="line-133"></a><span class="k">static</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="nf">mate_desktop_item_new_from_gfile</span><span class="w"> </span><span class="p">(</span><span class="n">GFile</span><span class="w"> </span><span class="o">*</span><span class="n">file</span><span class="p">,</span>
<a id="line-134" name="line-134"></a><span class="w">							    </span><span class="n">MateDesktopItemLoadFlags</span><span class="w"> </span><span class="n">flags</span><span class="p">,</span>
<a id="line-135" name="line-135"></a><span class="w">							    </span><span class="n">GError</span><span class="w"> </span><span class="o">**</span><span class="n">error</span><span class="p">);</span>
<a id="line-136" name="line-136"></a>
<a id="line-137" name="line-137"></a><span class="k">static</span><span class="w"> </span><span class="kt">int</span>
<a id="line-138" name="line-138"></a><span class="nf">readbuf_getc</span><span class="w"> </span><span class="p">(</span><span class="n">ReadBuf</span><span class="w"> </span><span class="o">*</span><span class="n">rb</span><span class="p">)</span>
<a id="line-139" name="line-139"></a><span class="p">{</span>
<a id="line-140" name="line-140"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">eof</span><span class="p">)</span>
<a id="line-141" name="line-141"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">EOF</span><span class="p">;</span>
<a id="line-142" name="line-142"></a>
<a id="line-143" name="line-143"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">size</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">||</span>
<a id="line-144" name="line-144"></a><span class="w">	    </span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">pos</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-145" name="line-145"></a><span class="w">		</span><span class="n">gssize</span><span class="w"> </span><span class="n">bytes_read</span><span class="p">;</span>
<a id="line-146" name="line-146"></a>
<a id="line-147" name="line-147"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">stream</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-148" name="line-148"></a><span class="w">			</span><span class="n">bytes_read</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="line-149" name="line-149"></a><span class="w">		</span><span class="k">else</span>
<a id="line-150" name="line-150"></a><span class="w">			</span><span class="n">bytes_read</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_input_stream_read</span><span class="w"> </span><span class="p">(</span><span class="n">G_INPUT_STREAM</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">stream</span><span class="p">),</span>
<a id="line-151" name="line-151"></a><span class="w">							  </span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">buf</span><span class="p">,</span>
<a id="line-152" name="line-152"></a><span class="w">							  </span><span class="n">READ_BUF_SIZE</span><span class="p">,</span>
<a id="line-153" name="line-153"></a><span class="w">							  </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-154" name="line-154"></a>
<a id="line-155" name="line-155"></a><span class="w">		</span><span class="cm">/* FIXME: handle errors other than EOF */</span>
<a id="line-156" name="line-156"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bytes_read</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-157" name="line-157"></a><span class="w">			</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">eof</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
<a id="line-158" name="line-158"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">EOF</span><span class="p">;</span>
<a id="line-159" name="line-159"></a><span class="w">		</span><span class="p">}</span>
<a id="line-160" name="line-160"></a>
<a id="line-161" name="line-161"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">size</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<a id="line-162" name="line-162"></a><span class="w">			</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">past_first_read</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
<a id="line-163" name="line-163"></a><span class="w">		</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bytes_read</span><span class="p">;</span>
<a id="line-164" name="line-164"></a><span class="w">		</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="line-165" name="line-165"></a>
<a id="line-166" name="line-166"></a><span class="w">	</span><span class="p">}</span>
<a id="line-167" name="line-167"></a>
<a id="line-168" name="line-168"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">guchar</span><span class="p">)</span><span class="w"> </span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">buf</span><span class="p">[</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">pos</span><span class="o">++</span><span class="p">];</span>
<a id="line-169" name="line-169"></a><span class="p">}</span>
<a id="line-170" name="line-170"></a>
<a id="line-171" name="line-171"></a><span class="cm">/* Note, does not include the trailing \n */</span>
<a id="line-172" name="line-172"></a><span class="k">static</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span>
<a id="line-173" name="line-173"></a><span class="nf">readbuf_gets</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">gsize</span><span class="w"> </span><span class="n">bufsize</span><span class="p">,</span><span class="w"> </span><span class="n">ReadBuf</span><span class="w"> </span><span class="o">*</span><span class="n">rb</span><span class="p">)</span>
<a id="line-174" name="line-174"></a><span class="p">{</span>
<a id="line-175" name="line-175"></a><span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<a id="line-176" name="line-176"></a><span class="w">	</span><span class="n">gsize</span><span class="w"> </span><span class="n">pos</span><span class="p">;</span>
<a id="line-177" name="line-177"></a>
<a id="line-178" name="line-178"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">buf</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-179" name="line-179"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-180" name="line-180"></a>
<a id="line-181" name="line-181"></a><span class="w">	</span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="line-182" name="line-182"></a><span class="w">	</span><span class="n">buf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">;</span>
<a id="line-183" name="line-183"></a>
<a id="line-184" name="line-184"></a><span class="w">	</span><span class="k">do</span><span class="w"> </span><span class="p">{</span>
<a id="line-185" name="line-185"></a><span class="w">		</span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">readbuf_getc</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="p">);</span>
<a id="line-186" name="line-186"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">EOF</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">)</span>
<a id="line-187" name="line-187"></a><span class="w">			</span><span class="k">break</span><span class="p">;</span>
<a id="line-188" name="line-188"></a><span class="w">		</span><span class="n">buf</span><span class="p">[</span><span class="n">pos</span><span class="o">++</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<a id="line-189" name="line-189"></a><span class="w">	</span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">pos</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">bufsize</span><span class="mi">-1</span><span class="p">);</span>
<a id="line-190" name="line-190"></a>
<a id="line-191" name="line-191"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">EOF</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">pos</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<a id="line-192" name="line-192"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-193" name="line-193"></a>
<a id="line-194" name="line-194"></a><span class="w">	</span><span class="n">buf</span><span class="p">[</span><span class="n">pos</span><span class="o">++</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">;</span>
<a id="line-195" name="line-195"></a>
<a id="line-196" name="line-196"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">buf</span><span class="p">;</span>
<a id="line-197" name="line-197"></a><span class="p">}</span>
<a id="line-198" name="line-198"></a>
<a id="line-199" name="line-199"></a><span class="k">static</span><span class="w"> </span><span class="n">ReadBuf</span><span class="w"> </span><span class="o">*</span>
<a id="line-200" name="line-200"></a><span class="nf">readbuf_open</span><span class="w"> </span><span class="p">(</span><span class="n">GFile</span><span class="w"> </span><span class="o">*</span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">GError</span><span class="w"> </span><span class="o">**</span><span class="n">error</span><span class="p">)</span>
<a id="line-201" name="line-201"></a><span class="p">{</span>
<a id="line-202" name="line-202"></a><span class="w">	</span><span class="n">GError</span><span class="w"> </span><span class="o">*</span><span class="n">local_error</span><span class="p">;</span>
<a id="line-203" name="line-203"></a><span class="w">	</span><span class="n">GFileInputStream</span><span class="w"> </span><span class="o">*</span><span class="n">stream</span><span class="p">;</span>
<a id="line-204" name="line-204"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">uri</span><span class="p">;</span>
<a id="line-205" name="line-205"></a><span class="w">	</span><span class="n">ReadBuf</span><span class="w"> </span><span class="o">*</span><span class="n">rb</span><span class="p">;</span>
<a id="line-206" name="line-206"></a>
<a id="line-207" name="line-207"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-208" name="line-208"></a>
<a id="line-209" name="line-209"></a><span class="w">	</span><span class="n">uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_get_uri</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<a id="line-210" name="line-210"></a><span class="w">	</span><span class="n">local_error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-211" name="line-211"></a><span class="w">	</span><span class="n">stream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_read</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">local_error</span><span class="p">);</span>
<a id="line-212" name="line-212"></a>
<a id="line-213" name="line-213"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">stream</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-214" name="line-214"></a><span class="w">		</span><span class="n">g_set_error</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">,</span>
<a id="line-215" name="line-215"></a><span class="w">			     </span><span class="cm">/* FIXME: better errors */</span>
<a id="line-216" name="line-216"></a><span class="w">			     </span><span class="n">MATE_DESKTOP_ITEM_ERROR</span><span class="p">,</span>
<a id="line-217" name="line-217"></a><span class="w">			     </span><span class="n">MATE_DESKTOP_ITEM_ERROR_CANNOT_OPEN</span><span class="p">,</span>
<a id="line-218" name="line-218"></a><span class="w">			     </span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Error reading file &#39;%s&#39;: %s&quot;</span><span class="p">),</span>
<a id="line-219" name="line-219"></a><span class="w">			     </span><span class="n">uri</span><span class="p">,</span><span class="w"> </span><span class="n">local_error</span><span class="o">-&gt;</span><span class="n">message</span><span class="p">);</span>
<a id="line-220" name="line-220"></a><span class="w">		</span><span class="n">g_error_free</span><span class="w"> </span><span class="p">(</span><span class="n">local_error</span><span class="p">);</span>
<a id="line-221" name="line-221"></a><span class="w">		</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">uri</span><span class="p">);</span>
<a id="line-222" name="line-222"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-223" name="line-223"></a><span class="w">	</span><span class="p">}</span>
<a id="line-224" name="line-224"></a>
<a id="line-225" name="line-225"></a><span class="w">	</span><span class="n">rb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_new0</span><span class="w"> </span><span class="p">(</span><span class="n">ReadBuf</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="line-226" name="line-226"></a><span class="w">	</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">stream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stream</span><span class="p">;</span>
<a id="line-227" name="line-227"></a><span class="w">	</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_dup</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<a id="line-228" name="line-228"></a><span class="w">	</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uri</span><span class="p">;</span>
<a id="line-229" name="line-229"></a><span class="w">	</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">buf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_malloc</span><span class="w"> </span><span class="p">(</span><span class="n">READ_BUF_SIZE</span><span class="p">);</span>
<a id="line-230" name="line-230"></a><span class="w">	</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">buf_needs_free</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
<a id="line-231" name="line-231"></a><span class="w">	</span><span class="cm">/* rb-&gt;past_first_read = FALSE; */</span>
<a id="line-232" name="line-232"></a><span class="w">	</span><span class="cm">/* rb-&gt;eof = FALSE; */</span>
<a id="line-233" name="line-233"></a><span class="w">	</span><span class="cm">/* rb-&gt;size = 0; */</span>
<a id="line-234" name="line-234"></a><span class="w">	</span><span class="cm">/* rb-&gt;pos = 0; */</span>
<a id="line-235" name="line-235"></a>
<a id="line-236" name="line-236"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">rb</span><span class="p">;</span>
<a id="line-237" name="line-237"></a><span class="p">}</span>
<a id="line-238" name="line-238"></a>
<a id="line-239" name="line-239"></a><span class="k">static</span><span class="w"> </span><span class="n">ReadBuf</span><span class="w"> </span><span class="o">*</span>
<a id="line-240" name="line-240"></a><span class="nf">readbuf_new_from_string</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">uri</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">gssize</span><span class="w"> </span><span class="n">length</span><span class="p">)</span>
<a id="line-241" name="line-241"></a><span class="p">{</span>
<a id="line-242" name="line-242"></a><span class="w">	</span><span class="n">ReadBuf</span><span class="w"> </span><span class="o">*</span><span class="n">rb</span><span class="p">;</span>
<a id="line-243" name="line-243"></a>
<a id="line-244" name="line-244"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-245" name="line-245"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">length</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-246" name="line-246"></a>
<a id="line-247" name="line-247"></a><span class="w">	</span><span class="n">rb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_new0</span><span class="w"> </span><span class="p">(</span><span class="n">ReadBuf</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="line-248" name="line-248"></a><span class="w">	</span><span class="cm">/* rb-&gt;file = NULL; */</span>
<a id="line-249" name="line-249"></a><span class="w">	</span><span class="cm">/* rb-&gt;stream = NULL; */</span>
<a id="line-250" name="line-250"></a><span class="w">	</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">uri</span><span class="p">);</span>
<a id="line-251" name="line-251"></a><span class="w">	</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">buf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">string</span><span class="p">;</span>
<a id="line-252" name="line-252"></a><span class="w">	</span><span class="cm">/* rb-&gt;buf_needs_free = FALSE; */</span>
<a id="line-253" name="line-253"></a><span class="w">	</span><span class="cm">/* rb-&gt;past_first_read = FALSE; */</span>
<a id="line-254" name="line-254"></a><span class="w">	</span><span class="cm">/* rb-&gt;eof = FALSE; */</span>
<a id="line-255" name="line-255"></a><span class="w">	</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length</span><span class="p">;</span>
<a id="line-256" name="line-256"></a><span class="w">	</span><span class="cm">/* rb-&gt;pos = 0; */</span>
<a id="line-257" name="line-257"></a>
<a id="line-258" name="line-258"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">rb</span><span class="p">;</span>
<a id="line-259" name="line-259"></a><span class="p">}</span>
<a id="line-260" name="line-260"></a>
<a id="line-261" name="line-261"></a><span class="k">static</span><span class="w"> </span><span class="n">gboolean</span>
<a id="line-262" name="line-262"></a><span class="nf">readbuf_rewind</span><span class="w"> </span><span class="p">(</span><span class="n">ReadBuf</span><span class="w"> </span><span class="o">*</span><span class="n">rb</span><span class="p">,</span><span class="w"> </span><span class="n">GError</span><span class="w"> </span><span class="o">**</span><span class="n">error</span><span class="p">)</span>
<a id="line-263" name="line-263"></a><span class="p">{</span>
<a id="line-264" name="line-264"></a><span class="w">	</span><span class="n">GError</span><span class="w"> </span><span class="o">*</span><span class="n">local_error</span><span class="p">;</span>
<a id="line-265" name="line-265"></a>
<a id="line-266" name="line-266"></a><span class="w">	</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">eof</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-267" name="line-267"></a><span class="w">	</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="line-268" name="line-268"></a>
<a id="line-269" name="line-269"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">past_first_read</span><span class="p">)</span>
<a id="line-270" name="line-270"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
<a id="line-271" name="line-271"></a>
<a id="line-272" name="line-272"></a><span class="w">	</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="line-273" name="line-273"></a>
<a id="line-274" name="line-274"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">g_seekable_seek</span><span class="w"> </span><span class="p">(</span><span class="n">G_SEEKABLE</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">stream</span><span class="p">),</span>
<a id="line-275" name="line-275"></a><span class="w">			     </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">G_SEEK_SET</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">))</span>
<a id="line-276" name="line-276"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
<a id="line-277" name="line-277"></a>
<a id="line-278" name="line-278"></a><span class="w">	</span><span class="n">g_object_unref</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">stream</span><span class="p">);</span>
<a id="line-279" name="line-279"></a><span class="w">	</span><span class="n">local_error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-280" name="line-280"></a><span class="w">	</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">stream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_read</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">local_error</span><span class="p">);</span>
<a id="line-281" name="line-281"></a>
<a id="line-282" name="line-282"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">stream</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-283" name="line-283"></a><span class="w">		</span><span class="n">g_set_error</span><span class="w"> </span><span class="p">(</span>
<a id="line-284" name="line-284"></a><span class="w">			</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_ERROR</span><span class="p">,</span>
<a id="line-285" name="line-285"></a><span class="w">			</span><span class="n">MATE_DESKTOP_ITEM_ERROR_CANNOT_OPEN</span><span class="p">,</span>
<a id="line-286" name="line-286"></a><span class="w">			</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Error rewinding file &#39;%s&#39;: %s&quot;</span><span class="p">),</span>
<a id="line-287" name="line-287"></a><span class="w">			</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">uri</span><span class="p">,</span><span class="w"> </span><span class="n">local_error</span><span class="o">-&gt;</span><span class="n">message</span><span class="p">);</span>
<a id="line-288" name="line-288"></a><span class="w">		</span><span class="n">g_error_free</span><span class="w"> </span><span class="p">(</span><span class="n">local_error</span><span class="p">);</span>
<a id="line-289" name="line-289"></a>
<a id="line-290" name="line-290"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-291" name="line-291"></a><span class="w">	</span><span class="p">}</span>
<a id="line-292" name="line-292"></a>
<a id="line-293" name="line-293"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
<a id="line-294" name="line-294"></a><span class="p">}</span>
<a id="line-295" name="line-295"></a>
<a id="line-296" name="line-296"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<a id="line-297" name="line-297"></a><span class="nf">readbuf_close</span><span class="w"> </span><span class="p">(</span><span class="n">ReadBuf</span><span class="w"> </span><span class="o">*</span><span class="n">rb</span><span class="p">)</span>
<a id="line-298" name="line-298"></a><span class="p">{</span>
<a id="line-299" name="line-299"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">stream</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-300" name="line-300"></a><span class="w">		</span><span class="n">g_object_unref</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">stream</span><span class="p">);</span>
<a id="line-301" name="line-301"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">file</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-302" name="line-302"></a><span class="w">		</span><span class="n">g_object_unref</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">file</span><span class="p">);</span>
<a id="line-303" name="line-303"></a><span class="w">	</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">uri</span><span class="p">);</span>
<a id="line-304" name="line-304"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">buf_needs_free</span><span class="p">)</span>
<a id="line-305" name="line-305"></a><span class="w">		</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">buf</span><span class="p">);</span>
<a id="line-306" name="line-306"></a><span class="w">	</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="p">);</span>
<a id="line-307" name="line-307"></a><span class="p">}</span>
<a id="line-308" name="line-308"></a>
<a id="line-309" name="line-309"></a><span class="k">static</span><span class="w"> </span><span class="n">MateDesktopItemType</span>
<a id="line-310" name="line-310"></a><span class="nf">type_from_string</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">type</span><span class="p">)</span>
<a id="line-311" name="line-311"></a><span class="p">{</span>
<a id="line-312" name="line-312"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">type</span><span class="p">)</span>
<a id="line-313" name="line-313"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TYPE_NULL</span><span class="p">;</span>
<a id="line-314" name="line-314"></a>
<a id="line-315" name="line-315"></a><span class="w">	</span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<a id="line-316" name="line-316"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;A&#39;</span><span class="p">:</span>
<a id="line-317" name="line-317"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Application&quot;</span><span class="p">))</span>
<a id="line-318" name="line-318"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TYPE_APPLICATION</span><span class="p">;</span>
<a id="line-319" name="line-319"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-320" name="line-320"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;L&#39;</span><span class="p">:</span>
<a id="line-321" name="line-321"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Link&quot;</span><span class="p">))</span>
<a id="line-322" name="line-322"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TYPE_LINK</span><span class="p">;</span>
<a id="line-323" name="line-323"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-324" name="line-324"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;F&#39;</span><span class="p">:</span>
<a id="line-325" name="line-325"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;FSDevice&quot;</span><span class="p">))</span>
<a id="line-326" name="line-326"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TYPE_FSDEVICE</span><span class="p">;</span>
<a id="line-327" name="line-327"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-328" name="line-328"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;M&#39;</span><span class="p">:</span>
<a id="line-329" name="line-329"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;MimeType&quot;</span><span class="p">))</span>
<a id="line-330" name="line-330"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TYPE_MIME_TYPE</span><span class="p">;</span>
<a id="line-331" name="line-331"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-332" name="line-332"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;D&#39;</span><span class="p">:</span>
<a id="line-333" name="line-333"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Directory&quot;</span><span class="p">))</span>
<a id="line-334" name="line-334"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TYPE_DIRECTORY</span><span class="p">;</span>
<a id="line-335" name="line-335"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-336" name="line-336"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;S&#39;</span><span class="p">:</span>
<a id="line-337" name="line-337"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Service&quot;</span><span class="p">))</span>
<a id="line-338" name="line-338"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TYPE_SERVICE</span><span class="p">;</span>
<a id="line-339" name="line-339"></a>
<a id="line-340" name="line-340"></a><span class="w">		</span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ServiceType&quot;</span><span class="p">))</span>
<a id="line-341" name="line-341"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TYPE_SERVICE_TYPE</span><span class="p">;</span>
<a id="line-342" name="line-342"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-343" name="line-343"></a><span class="w">	</span><span class="k">default</span><span class="o">:</span>
<a id="line-344" name="line-344"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-345" name="line-345"></a><span class="w">	</span><span class="p">}</span>
<a id="line-346" name="line-346"></a>
<a id="line-347" name="line-347"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TYPE_OTHER</span><span class="p">;</span>
<a id="line-348" name="line-348"></a><span class="p">}</span>
<a id="line-349" name="line-349"></a>
<a id="line-350" name="line-350"></a><span class="cm">/**</span>
<a id="line-351" name="line-351"></a><span class="cm"> * mate_desktop_item_new:</span>
<a id="line-352" name="line-352"></a><span class="cm"> *</span>
<a id="line-353" name="line-353"></a><span class="cm"> * Creates a MateDesktopItem object. The reference count on the returned value is set to &#39;1&#39;.</span>
<a id="line-354" name="line-354"></a><span class="cm"> *</span>
<a id="line-355" name="line-355"></a><span class="cm"> * Returns: The new MateDesktopItem</span>
<a id="line-356" name="line-356"></a><span class="cm"> */</span>
<a id="line-357" name="line-357"></a><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span>
<a id="line-358" name="line-358"></a><span class="nf">mate_desktop_item_new</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<a id="line-359" name="line-359"></a><span class="p">{</span>
<a id="line-360" name="line-360"></a><span class="w">	</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">retval</span><span class="p">;</span>
<a id="line-361" name="line-361"></a>
<a id="line-362" name="line-362"></a><span class="w">	</span><span class="n">_mate_desktop_init_i18n</span><span class="w"> </span><span class="p">();</span>
<a id="line-363" name="line-363"></a>
<a id="line-364" name="line-364"></a><span class="w">	</span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_new0</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="line-365" name="line-365"></a>
<a id="line-366" name="line-366"></a><span class="w">	</span><span class="n">retval</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="o">++</span><span class="p">;</span>
<a id="line-367" name="line-367"></a>
<a id="line-368" name="line-368"></a><span class="w">	</span><span class="n">retval</span><span class="o">-&gt;</span><span class="n">main_hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_hash_table_new_full</span><span class="w"> </span><span class="p">(</span><span class="n">g_str_hash</span><span class="p">,</span><span class="w"> </span><span class="n">g_str_equal</span><span class="p">,</span>
<a id="line-369" name="line-369"></a><span class="w">						   </span><span class="p">(</span><span class="n">GDestroyNotify</span><span class="p">)</span><span class="w"> </span><span class="n">g_free</span><span class="p">,</span>
<a id="line-370" name="line-370"></a><span class="w">						   </span><span class="p">(</span><span class="n">GDestroyNotify</span><span class="p">)</span><span class="w"> </span><span class="n">g_free</span><span class="p">);</span>
<a id="line-371" name="line-371"></a>
<a id="line-372" name="line-372"></a><span class="w">	</span><span class="cm">/* These are guaranteed to be set */</span>
<a id="line-373" name="line-373"></a><span class="w">	</span><span class="n">mate_desktop_item_set_string</span><span class="w"> </span><span class="p">(</span><span class="n">retval</span><span class="p">,</span>
<a id="line-374" name="line-374"></a><span class="w">				       </span><span class="n">MATE_DESKTOP_ITEM_NAME</span><span class="p">,</span>
<a id="line-375" name="line-375"></a><span class="w">				       </span><span class="cm">/* Translators: the &quot;name&quot; mentioned</span>
<a id="line-376" name="line-376"></a><span class="cm">					* here is the name of an application or</span>
<a id="line-377" name="line-377"></a><span class="cm">					* a document */</span>
<a id="line-378" name="line-378"></a><span class="w">				       </span><span class="n">_</span><span class="p">(</span><span class="s">&quot;No name&quot;</span><span class="p">));</span>
<a id="line-379" name="line-379"></a><span class="w">	</span><span class="n">mate_desktop_item_set_string</span><span class="w"> </span><span class="p">(</span><span class="n">retval</span><span class="p">,</span>
<a id="line-380" name="line-380"></a><span class="w">				       </span><span class="n">MATE_DESKTOP_ITEM_ENCODING</span><span class="p">,</span>
<a id="line-381" name="line-381"></a><span class="w">				       </span><span class="s">&quot;UTF-8&quot;</span><span class="p">);</span>
<a id="line-382" name="line-382"></a><span class="w">	</span><span class="n">mate_desktop_item_set_string</span><span class="w"> </span><span class="p">(</span><span class="n">retval</span><span class="p">,</span>
<a id="line-383" name="line-383"></a><span class="w">				       </span><span class="n">MATE_DESKTOP_ITEM_VERSION</span><span class="p">,</span>
<a id="line-384" name="line-384"></a><span class="w">				       </span><span class="s">&quot;1.0&quot;</span><span class="p">);</span>
<a id="line-385" name="line-385"></a>
<a id="line-386" name="line-386"></a><span class="w">	</span><span class="n">retval</span><span class="o">-&gt;</span><span class="n">launch_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="line-387" name="line-387"></a>
<a id="line-388" name="line-388"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">retval</span><span class="p">;</span>
<a id="line-389" name="line-389"></a><span class="p">}</span>
<a id="line-390" name="line-390"></a>
<a id="line-391" name="line-391"></a><span class="k">static</span><span class="w"> </span><span class="n">Section</span><span class="w"> </span><span class="o">*</span>
<a id="line-392" name="line-392"></a><span class="nf">dup_section</span><span class="w"> </span><span class="p">(</span><span class="n">Section</span><span class="w"> </span><span class="o">*</span><span class="n">sec</span><span class="p">)</span>
<a id="line-393" name="line-393"></a><span class="p">{</span>
<a id="line-394" name="line-394"></a><span class="w">	</span><span class="n">GList</span><span class="w"> </span><span class="o">*</span><span class="n">li</span><span class="p">;</span>
<a id="line-395" name="line-395"></a><span class="w">	</span><span class="n">Section</span><span class="w"> </span><span class="o">*</span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_new0</span><span class="w"> </span><span class="p">(</span><span class="n">Section</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="line-396" name="line-396"></a>
<a id="line-397" name="line-397"></a><span class="w">	</span><span class="n">retval</span><span class="o">-&gt;</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">sec</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
<a id="line-398" name="line-398"></a>
<a id="line-399" name="line-399"></a><span class="w">	</span><span class="n">retval</span><span class="o">-&gt;</span><span class="n">keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_list_copy</span><span class="w"> </span><span class="p">(</span><span class="n">sec</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">);</span>
<a id="line-400" name="line-400"></a><span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">retval</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">;</span><span class="w"> </span><span class="n">li</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"> </span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">li</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">)</span>
<a id="line-401" name="line-401"></a><span class="w">		</span><span class="n">li</span><span class="o">-&gt;</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">li</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">);</span>
<a id="line-402" name="line-402"></a>
<a id="line-403" name="line-403"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">retval</span><span class="p">;</span>
<a id="line-404" name="line-404"></a><span class="p">}</span>
<a id="line-405" name="line-405"></a>
<a id="line-406" name="line-406"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<a id="line-407" name="line-407"></a><span class="nf">copy_string_hash</span><span class="w"> </span><span class="p">(</span><span class="n">gpointer</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">gpointer</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">gpointer</span><span class="w"> </span><span class="n">user_data</span><span class="p">)</span>
<a id="line-408" name="line-408"></a><span class="p">{</span>
<a id="line-409" name="line-409"></a><span class="w">	</span><span class="n">GHashTable</span><span class="w"> </span><span class="o">*</span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user_data</span><span class="p">;</span>
<a id="line-410" name="line-410"></a><span class="w">	</span><span class="n">g_hash_table_replace</span><span class="w"> </span><span class="p">(</span><span class="n">copy</span><span class="p">,</span>
<a id="line-411" name="line-411"></a><span class="w">			      </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="p">),</span>
<a id="line-412" name="line-412"></a><span class="w">			      </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">));</span>
<a id="line-413" name="line-413"></a><span class="p">}</span>
<a id="line-414" name="line-414"></a>
<a id="line-415" name="line-415"></a><span class="cm">/**</span>
<a id="line-416" name="line-416"></a><span class="cm"> * mate_desktop_item_copy:</span>
<a id="line-417" name="line-417"></a><span class="cm"> * @item: The item to be copied</span>
<a id="line-418" name="line-418"></a><span class="cm"> *</span>
<a id="line-419" name="line-419"></a><span class="cm"> * Creates a copy of a MateDesktopItem.  The new copy has a refcount of 1.</span>
<a id="line-420" name="line-420"></a><span class="cm"> * Note: Section stack is NOT copied.</span>
<a id="line-421" name="line-421"></a><span class="cm"> *</span>
<a id="line-422" name="line-422"></a><span class="cm"> * Returns: The new copy</span>
<a id="line-423" name="line-423"></a><span class="cm"> */</span>
<a id="line-424" name="line-424"></a><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span>
<a id="line-425" name="line-425"></a><span class="nf">mate_desktop_item_copy</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">)</span>
<a id="line-426" name="line-426"></a><span class="p">{</span>
<a id="line-427" name="line-427"></a><span class="w">	</span><span class="n">GList</span><span class="w"> </span><span class="o">*</span><span class="n">li</span><span class="p">;</span>
<a id="line-428" name="line-428"></a><span class="w">	</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">retval</span><span class="p">;</span>
<a id="line-429" name="line-429"></a>
<a id="line-430" name="line-430"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-431" name="line-431"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-432" name="line-432"></a>
<a id="line-433" name="line-433"></a><span class="w">	</span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mate_desktop_item_new</span><span class="w"> </span><span class="p">();</span>
<a id="line-434" name="line-434"></a>
<a id="line-435" name="line-435"></a><span class="w">	</span><span class="n">retval</span><span class="o">-&gt;</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="o">-&gt;</span><span class="n">type</span><span class="p">;</span>
<a id="line-436" name="line-436"></a><span class="w">	</span><span class="n">retval</span><span class="o">-&gt;</span><span class="n">modified</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="o">-&gt;</span><span class="n">modified</span><span class="p">;</span>
<a id="line-437" name="line-437"></a><span class="w">	</span><span class="n">retval</span><span class="o">-&gt;</span><span class="n">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">location</span><span class="p">);</span>
<a id="line-438" name="line-438"></a><span class="w">	</span><span class="n">retval</span><span class="o">-&gt;</span><span class="n">mtime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="o">-&gt;</span><span class="n">mtime</span><span class="p">;</span>
<a id="line-439" name="line-439"></a><span class="w">	</span><span class="n">retval</span><span class="o">-&gt;</span><span class="n">launch_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="o">-&gt;</span><span class="n">launch_time</span><span class="p">;</span>
<a id="line-440" name="line-440"></a>
<a id="line-441" name="line-441"></a><span class="w">	</span><span class="cm">/* Languages */</span>
<a id="line-442" name="line-442"></a><span class="w">	</span><span class="n">retval</span><span class="o">-&gt;</span><span class="n">languages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_list_copy</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">languages</span><span class="p">);</span>
<a id="line-443" name="line-443"></a><span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">retval</span><span class="o">-&gt;</span><span class="n">languages</span><span class="p">;</span><span class="w"> </span><span class="n">li</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"> </span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">li</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">)</span>
<a id="line-444" name="line-444"></a><span class="w">		</span><span class="n">li</span><span class="o">-&gt;</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">li</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">);</span>
<a id="line-445" name="line-445"></a>
<a id="line-446" name="line-446"></a><span class="w">	</span><span class="cm">/* Keys */</span>
<a id="line-447" name="line-447"></a><span class="w">	</span><span class="n">retval</span><span class="o">-&gt;</span><span class="n">keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_list_copy</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">);</span>
<a id="line-448" name="line-448"></a><span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">retval</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">;</span><span class="w"> </span><span class="n">li</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"> </span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">li</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">)</span>
<a id="line-449" name="line-449"></a><span class="w">		</span><span class="n">li</span><span class="o">-&gt;</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">li</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">);</span>
<a id="line-450" name="line-450"></a>
<a id="line-451" name="line-451"></a><span class="w">	</span><span class="cm">/* Sections */</span>
<a id="line-452" name="line-452"></a><span class="w">	</span><span class="n">retval</span><span class="o">-&gt;</span><span class="n">sections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_list_copy</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">sections</span><span class="p">);</span>
<a id="line-453" name="line-453"></a><span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">retval</span><span class="o">-&gt;</span><span class="n">sections</span><span class="p">;</span><span class="w"> </span><span class="n">li</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"> </span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">li</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">)</span>
<a id="line-454" name="line-454"></a><span class="w">		</span><span class="n">li</span><span class="o">-&gt;</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dup_section</span><span class="w"> </span><span class="p">(</span><span class="n">li</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">);</span>
<a id="line-455" name="line-455"></a>
<a id="line-456" name="line-456"></a><span class="w">	</span><span class="n">retval</span><span class="o">-&gt;</span><span class="n">main_hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_hash_table_new_full</span><span class="w"> </span><span class="p">(</span><span class="n">g_str_hash</span><span class="p">,</span><span class="w"> </span><span class="n">g_str_equal</span><span class="p">,</span>
<a id="line-457" name="line-457"></a><span class="w">						   </span><span class="p">(</span><span class="n">GDestroyNotify</span><span class="p">)</span><span class="w"> </span><span class="n">g_free</span><span class="p">,</span>
<a id="line-458" name="line-458"></a><span class="w">						   </span><span class="p">(</span><span class="n">GDestroyNotify</span><span class="p">)</span><span class="w"> </span><span class="n">g_free</span><span class="p">);</span>
<a id="line-459" name="line-459"></a>
<a id="line-460" name="line-460"></a><span class="w">	</span><span class="n">g_hash_table_foreach</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">main_hash</span><span class="p">,</span>
<a id="line-461" name="line-461"></a><span class="w">			      </span><span class="n">copy_string_hash</span><span class="p">,</span>
<a id="line-462" name="line-462"></a><span class="w">			      </span><span class="n">retval</span><span class="o">-&gt;</span><span class="n">main_hash</span><span class="p">);</span>
<a id="line-463" name="line-463"></a>
<a id="line-464" name="line-464"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">retval</span><span class="p">;</span>
<a id="line-465" name="line-465"></a><span class="p">}</span>
<a id="line-466" name="line-466"></a>
<a id="line-467" name="line-467"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<a id="line-468" name="line-468"></a><span class="nf">read_sort_order</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">GFile</span><span class="w"> </span><span class="o">*</span><span class="n">dir</span><span class="p">)</span>
<a id="line-469" name="line-469"></a><span class="p">{</span>
<a id="line-470" name="line-470"></a><span class="w">	</span><span class="n">GFile</span><span class="w"> </span><span class="o">*</span><span class="n">child</span><span class="p">;</span>
<a id="line-471" name="line-471"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="n">buf</span><span class="p">[</span><span class="n">BUFSIZ</span><span class="p">];</span>
<a id="line-472" name="line-472"></a><span class="w">	</span><span class="n">GString</span><span class="w"> </span><span class="o">*</span><span class="n">str</span><span class="p">;</span>
<a id="line-473" name="line-473"></a><span class="w">	</span><span class="n">ReadBuf</span><span class="w"> </span><span class="o">*</span><span class="n">rb</span><span class="p">;</span>
<a id="line-474" name="line-474"></a>
<a id="line-475" name="line-475"></a><span class="w">	</span><span class="n">child</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_get_child</span><span class="w"> </span><span class="p">(</span><span class="n">dir</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;.order&quot;</span><span class="p">);</span>
<a id="line-476" name="line-476"></a>
<a id="line-477" name="line-477"></a><span class="w">	</span><span class="n">rb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">readbuf_open</span><span class="w"> </span><span class="p">(</span><span class="n">child</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-478" name="line-478"></a><span class="w">	</span><span class="n">g_object_unref</span><span class="w"> </span><span class="p">(</span><span class="n">child</span><span class="p">);</span>
<a id="line-479" name="line-479"></a>
<a id="line-480" name="line-480"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-481" name="line-481"></a><span class="w">		</span><span class="k">return</span><span class="p">;</span>
<a id="line-482" name="line-482"></a>
<a id="line-483" name="line-483"></a><span class="w">	</span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-484" name="line-484"></a><span class="w">	</span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">readbuf_gets</span><span class="w"> </span><span class="p">(</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="w"> </span><span class="p">(</span><span class="n">buf</span><span class="p">),</span><span class="w"> </span><span class="n">rb</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-485" name="line-485"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-486" name="line-486"></a><span class="w">			</span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_string_new</span><span class="w"> </span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
<a id="line-487" name="line-487"></a><span class="w">		</span><span class="k">else</span>
<a id="line-488" name="line-488"></a><span class="w">			</span><span class="n">g_string_append</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="p">);</span>
<a id="line-489" name="line-489"></a><span class="w">		</span><span class="n">g_string_append_c</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;;&#39;</span><span class="p">);</span>
<a id="line-490" name="line-490"></a><span class="w">	</span><span class="p">}</span>
<a id="line-491" name="line-491"></a><span class="w">	</span><span class="n">readbuf_close</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="p">);</span>
<a id="line-492" name="line-492"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-493" name="line-493"></a><span class="w">		</span><span class="n">mate_desktop_item_set_string</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_SORT_ORDER</span><span class="p">,</span>
<a id="line-494" name="line-494"></a><span class="w">					       </span><span class="n">str</span><span class="o">-&gt;</span><span class="n">str</span><span class="p">);</span>
<a id="line-495" name="line-495"></a><span class="w">		</span><span class="n">g_string_free</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">TRUE</span><span class="p">);</span>
<a id="line-496" name="line-496"></a><span class="w">	</span><span class="p">}</span>
<a id="line-497" name="line-497"></a><span class="p">}</span>
<a id="line-498" name="line-498"></a>
<a id="line-499" name="line-499"></a><span class="k">static</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span>
<a id="line-500" name="line-500"></a><span class="nf">make_fake_directory</span><span class="w"> </span><span class="p">(</span><span class="n">GFile</span><span class="w"> </span><span class="o">*</span><span class="n">dir</span><span class="p">)</span>
<a id="line-501" name="line-501"></a><span class="p">{</span>
<a id="line-502" name="line-502"></a><span class="w">	</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">;</span>
<a id="line-503" name="line-503"></a><span class="w">	</span><span class="n">GFile</span><span class="w"> </span><span class="o">*</span><span class="n">child</span><span class="p">;</span>
<a id="line-504" name="line-504"></a>
<a id="line-505" name="line-505"></a><span class="w">	</span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mate_desktop_item_new</span><span class="w"> </span><span class="p">();</span>
<a id="line-506" name="line-506"></a><span class="w">	</span><span class="n">mate_desktop_item_set_entry_type</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span>
<a id="line-507" name="line-507"></a><span class="w">					   </span><span class="n">MATE_DESKTOP_ITEM_TYPE_DIRECTORY</span><span class="p">);</span>
<a id="line-508" name="line-508"></a>
<a id="line-509" name="line-509"></a><span class="w">	</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">mtime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DONT_UPDATE_MTIME</span><span class="p">;</span><span class="w"> </span><span class="cm">/* it doesn&#39;t exist, we know that */</span>
<a id="line-510" name="line-510"></a><span class="w">	</span><span class="n">child</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_get_child</span><span class="w"> </span><span class="p">(</span><span class="n">dir</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;.directory&quot;</span><span class="p">);</span>
<a id="line-511" name="line-511"></a><span class="w">	</span><span class="n">mate_desktop_item_set_location_gfile</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">child</span><span class="p">);</span>
<a id="line-512" name="line-512"></a><span class="w">	</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">mtime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="line-513" name="line-513"></a><span class="w">	</span><span class="n">g_object_unref</span><span class="w"> </span><span class="p">(</span><span class="n">child</span><span class="p">);</span>
<a id="line-514" name="line-514"></a>
<a id="line-515" name="line-515"></a><span class="w">	</span><span class="n">read_sort_order</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">dir</span><span class="p">);</span>
<a id="line-516" name="line-516"></a>
<a id="line-517" name="line-517"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">item</span><span class="p">;</span>
<a id="line-518" name="line-518"></a><span class="p">}</span>
<a id="line-519" name="line-519"></a>
<a id="line-520" name="line-520"></a><span class="cm">/**</span>
<a id="line-521" name="line-521"></a><span class="cm"> * mate_desktop_item_new_from_file:</span>
<a id="line-522" name="line-522"></a><span class="cm"> * @file: The filename or directory path to load the MateDesktopItem from</span>
<a id="line-523" name="line-523"></a><span class="cm"> * @flags: Flags to influence the loading process</span>
<a id="line-524" name="line-524"></a><span class="cm"> *</span>
<a id="line-525" name="line-525"></a><span class="cm"> * This function loads &#39;file&#39; and turns it into a MateDesktopItem.</span>
<a id="line-526" name="line-526"></a><span class="cm"> *</span>
<a id="line-527" name="line-527"></a><span class="cm"> * Returns: The newly loaded item.</span>
<a id="line-528" name="line-528"></a><span class="cm"> */</span>
<a id="line-529" name="line-529"></a><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span>
<a id="line-530" name="line-530"></a><span class="nf">mate_desktop_item_new_from_file</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">file</span><span class="p">,</span>
<a id="line-531" name="line-531"></a><span class="w">				  </span><span class="n">MateDesktopItemLoadFlags</span><span class="w"> </span><span class="n">flags</span><span class="p">,</span>
<a id="line-532" name="line-532"></a><span class="w">				  </span><span class="n">GError</span><span class="w"> </span><span class="o">**</span><span class="n">error</span><span class="p">)</span>
<a id="line-533" name="line-533"></a><span class="p">{</span>
<a id="line-534" name="line-534"></a><span class="w">	</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">retval</span><span class="p">;</span>
<a id="line-535" name="line-535"></a><span class="w">	</span><span class="n">GFile</span><span class="w"> </span><span class="o">*</span><span class="n">gfile</span><span class="p">;</span>
<a id="line-536" name="line-536"></a>
<a id="line-537" name="line-537"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-538" name="line-538"></a>
<a id="line-539" name="line-539"></a><span class="w">	</span><span class="n">gfile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_new_for_path</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<a id="line-540" name="line-540"></a><span class="w">	</span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mate_desktop_item_new_from_gfile</span><span class="w"> </span><span class="p">(</span><span class="n">gfile</span><span class="p">,</span><span class="w"> </span><span class="n">flags</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">);</span>
<a id="line-541" name="line-541"></a><span class="w">	</span><span class="n">g_object_unref</span><span class="w"> </span><span class="p">(</span><span class="n">gfile</span><span class="p">);</span>
<a id="line-542" name="line-542"></a>
<a id="line-543" name="line-543"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">retval</span><span class="p">;</span>
<a id="line-544" name="line-544"></a><span class="p">}</span>
<a id="line-545" name="line-545"></a>
<a id="line-546" name="line-546"></a><span class="cm">/**</span>
<a id="line-547" name="line-547"></a><span class="cm"> * mate_desktop_item_new_from_uri:</span>
<a id="line-548" name="line-548"></a><span class="cm"> * @uri: URI to load the MateDesktopItem from</span>
<a id="line-549" name="line-549"></a><span class="cm"> * @flags: Flags to influence the loading process</span>
<a id="line-550" name="line-550"></a><span class="cm"> *</span>
<a id="line-551" name="line-551"></a><span class="cm"> * This function loads &#39;uri&#39; and turns it into a MateDesktopItem.</span>
<a id="line-552" name="line-552"></a><span class="cm"> *</span>
<a id="line-553" name="line-553"></a><span class="cm"> * Returns: The newly loaded item.</span>
<a id="line-554" name="line-554"></a><span class="cm"> */</span>
<a id="line-555" name="line-555"></a><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span>
<a id="line-556" name="line-556"></a><span class="nf">mate_desktop_item_new_from_uri</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">uri</span><span class="p">,</span>
<a id="line-557" name="line-557"></a><span class="w">				 </span><span class="n">MateDesktopItemLoadFlags</span><span class="w"> </span><span class="n">flags</span><span class="p">,</span>
<a id="line-558" name="line-558"></a><span class="w">				 </span><span class="n">GError</span><span class="w"> </span><span class="o">**</span><span class="n">error</span><span class="p">)</span>
<a id="line-559" name="line-559"></a><span class="p">{</span>
<a id="line-560" name="line-560"></a><span class="w">	</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">retval</span><span class="p">;</span>
<a id="line-561" name="line-561"></a><span class="w">	</span><span class="n">GFile</span><span class="w"> </span><span class="o">*</span><span class="n">file</span><span class="p">;</span>
<a id="line-562" name="line-562"></a>
<a id="line-563" name="line-563"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">uri</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-564" name="line-564"></a>
<a id="line-565" name="line-565"></a><span class="w">	</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_new_for_uri</span><span class="w"> </span><span class="p">(</span><span class="n">uri</span><span class="p">);</span>
<a id="line-566" name="line-566"></a><span class="w">	</span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mate_desktop_item_new_from_gfile</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">flags</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">);</span>
<a id="line-567" name="line-567"></a><span class="w">	</span><span class="n">g_object_unref</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<a id="line-568" name="line-568"></a>
<a id="line-569" name="line-569"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">retval</span><span class="p">;</span>
<a id="line-570" name="line-570"></a><span class="p">}</span>
<a id="line-571" name="line-571"></a>
<a id="line-572" name="line-572"></a><span class="k">static</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span>
<a id="line-573" name="line-573"></a><span class="nf">mate_desktop_item_new_from_gfile</span><span class="w"> </span><span class="p">(</span><span class="n">GFile</span><span class="w"> </span><span class="o">*</span><span class="n">file</span><span class="p">,</span>
<a id="line-574" name="line-574"></a><span class="w">				   </span><span class="n">MateDesktopItemLoadFlags</span><span class="w"> </span><span class="n">flags</span><span class="p">,</span>
<a id="line-575" name="line-575"></a><span class="w">				   </span><span class="n">GError</span><span class="w"> </span><span class="o">**</span><span class="n">error</span><span class="p">)</span>
<a id="line-576" name="line-576"></a><span class="p">{</span>
<a id="line-577" name="line-577"></a><span class="w">	</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">retval</span><span class="p">;</span>
<a id="line-578" name="line-578"></a><span class="w">	</span><span class="n">GFile</span><span class="w"> </span><span class="o">*</span><span class="n">subfn</span><span class="p">;</span>
<a id="line-579" name="line-579"></a><span class="w">	</span><span class="n">GFileInfo</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">;</span>
<a id="line-580" name="line-580"></a><span class="w">	</span><span class="n">GFileType</span><span class="w"> </span><span class="n">type</span><span class="p">;</span>
<a id="line-581" name="line-581"></a><span class="w">	</span><span class="n">GFile</span><span class="w"> </span><span class="o">*</span><span class="n">parent</span><span class="p">;</span>
<a id="line-582" name="line-582"></a><span class="w">	</span><span class="n">gint64</span><span class="w"> </span><span class="n">mtime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="line-583" name="line-583"></a><span class="w">	</span><span class="n">ReadBuf</span><span class="w"> </span><span class="o">*</span><span class="n">rb</span><span class="p">;</span>
<a id="line-584" name="line-584"></a>
<a id="line-585" name="line-585"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-586" name="line-586"></a>
<a id="line-587" name="line-587"></a><span class="w">	</span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_query_info</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">,</span>
<a id="line-588" name="line-588"></a><span class="w">			          </span><span class="n">G_FILE_ATTRIBUTE_STANDARD_TYPE</span><span class="s">&quot;,&quot;</span><span class="n">G_FILE_ATTRIBUTE_TIME_MODIFIED</span><span class="p">,</span>
<a id="line-589" name="line-589"></a><span class="w">				  </span><span class="n">G_FILE_QUERY_INFO_NONE</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">);</span>
<a id="line-590" name="line-590"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">info</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-591" name="line-591"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-592" name="line-592"></a>
<a id="line-593" name="line-593"></a><span class="w">	</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_info_get_file_type</span><span class="w"> </span><span class="p">(</span><span class="n">info</span><span class="p">);</span>
<a id="line-594" name="line-594"></a>
<a id="line-595" name="line-595"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">G_FILE_TYPE_REGULAR</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">G_FILE_TYPE_DIRECTORY</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-596" name="line-596"></a><span class="w">		</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">uri</span><span class="p">;</span>
<a id="line-597" name="line-597"></a>
<a id="line-598" name="line-598"></a><span class="w">		</span><span class="n">uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_get_uri</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<a id="line-599" name="line-599"></a><span class="w">		</span><span class="n">g_set_error</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">,</span>
<a id="line-600" name="line-600"></a><span class="w">			     </span><span class="cm">/* FIXME: better errors */</span>
<a id="line-601" name="line-601"></a><span class="w">			     </span><span class="n">MATE_DESKTOP_ITEM_ERROR</span><span class="p">,</span>
<a id="line-602" name="line-602"></a><span class="w">			     </span><span class="n">MATE_DESKTOP_ITEM_ERROR_INVALID_TYPE</span><span class="p">,</span>
<a id="line-603" name="line-603"></a><span class="w">			     </span><span class="n">_</span><span class="p">(</span><span class="s">&quot;File &#39;%s&#39; is not a regular file or directory.&quot;</span><span class="p">),</span>
<a id="line-604" name="line-604"></a><span class="w">			     </span><span class="n">uri</span><span class="p">);</span>
<a id="line-605" name="line-605"></a>
<a id="line-606" name="line-606"></a><span class="w">		</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">uri</span><span class="p">);</span>
<a id="line-607" name="line-607"></a><span class="w">		</span><span class="n">g_object_unref</span><span class="w"> </span><span class="p">(</span><span class="n">info</span><span class="p">);</span>
<a id="line-608" name="line-608"></a>
<a id="line-609" name="line-609"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-610" name="line-610"></a><span class="w">	</span><span class="p">}</span>
<a id="line-611" name="line-611"></a>
<a id="line-612" name="line-612"></a><span class="w">	</span><span class="n">mtime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_info_get_attribute_uint64</span><span class="w"> </span><span class="p">(</span><span class="n">info</span><span class="p">,</span>
<a id="line-613" name="line-613"></a><span class="w">						  </span><span class="n">G_FILE_ATTRIBUTE_TIME_MODIFIED</span><span class="p">);</span>
<a id="line-614" name="line-614"></a>
<a id="line-615" name="line-615"></a><span class="w">	</span><span class="n">g_object_unref</span><span class="w"> </span><span class="p">(</span><span class="n">info</span><span class="p">);</span>
<a id="line-616" name="line-616"></a>
<a id="line-617" name="line-617"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">G_FILE_TYPE_DIRECTORY</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-618" name="line-618"></a><span class="w">		</span><span class="n">GFile</span><span class="w"> </span><span class="o">*</span><span class="n">child</span><span class="p">;</span>
<a id="line-619" name="line-619"></a><span class="w">		</span><span class="n">GFileInfo</span><span class="w"> </span><span class="o">*</span><span class="n">child_info</span><span class="p">;</span>
<a id="line-620" name="line-620"></a>
<a id="line-621" name="line-621"></a><span class="w">		</span><span class="n">child</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_get_child</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;.directory&quot;</span><span class="p">);</span>
<a id="line-622" name="line-622"></a><span class="w">		</span><span class="n">child_info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_query_info</span><span class="w"> </span><span class="p">(</span><span class="n">child</span><span class="p">,</span>
<a id="line-623" name="line-623"></a><span class="w">						</span><span class="n">G_FILE_ATTRIBUTE_TIME_MODIFIED</span><span class="p">,</span>
<a id="line-624" name="line-624"></a><span class="w">						</span><span class="n">G_FILE_QUERY_INFO_NONE</span><span class="p">,</span>
<a id="line-625" name="line-625"></a><span class="w">						</span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-626" name="line-626"></a>
<a id="line-627" name="line-627"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">child_info</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-628" name="line-628"></a><span class="w">			</span><span class="n">g_object_unref</span><span class="w"> </span><span class="p">(</span><span class="n">child</span><span class="p">);</span>
<a id="line-629" name="line-629"></a>
<a id="line-630" name="line-630"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">flags</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_LOAD_ONLY_IF_EXISTS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-631" name="line-631"></a><span class="w">				</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-632" name="line-632"></a><span class="w">			</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-633" name="line-633"></a><span class="w">				</span><span class="k">return</span><span class="w"> </span><span class="n">make_fake_directory</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<a id="line-634" name="line-634"></a><span class="w">			</span><span class="p">}</span>
<a id="line-635" name="line-635"></a><span class="w">		</span><span class="p">}</span>
<a id="line-636" name="line-636"></a>
<a id="line-637" name="line-637"></a><span class="w">		</span><span class="n">mtime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_info_get_attribute_uint64</span><span class="w"> </span><span class="p">(</span><span class="n">child_info</span><span class="p">,</span>
<a id="line-638" name="line-638"></a><span class="w">							  </span><span class="n">G_FILE_ATTRIBUTE_TIME_MODIFIED</span><span class="p">);</span>
<a id="line-639" name="line-639"></a><span class="w">		</span><span class="n">g_object_unref</span><span class="w"> </span><span class="p">(</span><span class="n">child_info</span><span class="p">);</span>
<a id="line-640" name="line-640"></a>
<a id="line-641" name="line-641"></a><span class="w">		</span><span class="n">subfn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">child</span><span class="p">;</span>
<a id="line-642" name="line-642"></a><span class="w">	</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-643" name="line-643"></a><span class="w">		</span><span class="n">subfn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_dup</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<a id="line-644" name="line-644"></a><span class="w">	</span><span class="p">}</span>
<a id="line-645" name="line-645"></a>
<a id="line-646" name="line-646"></a><span class="w">	</span><span class="n">rb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">readbuf_open</span><span class="w"> </span><span class="p">(</span><span class="n">subfn</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">);</span>
<a id="line-647" name="line-647"></a>
<a id="line-648" name="line-648"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-649" name="line-649"></a><span class="w">		</span><span class="n">g_object_unref</span><span class="w"> </span><span class="p">(</span><span class="n">subfn</span><span class="p">);</span>
<a id="line-650" name="line-650"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-651" name="line-651"></a><span class="w">	</span><span class="p">}</span>
<a id="line-652" name="line-652"></a>
<a id="line-653" name="line-653"></a><span class="w">	</span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ditem_load</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="p">,</span>
<a id="line-654" name="line-654"></a><span class="w">			     </span><span class="p">(</span><span class="n">flags</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_LOAD_NO_TRANSLATIONS</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<a id="line-655" name="line-655"></a><span class="w">			     </span><span class="n">error</span><span class="p">);</span>
<a id="line-656" name="line-656"></a>
<a id="line-657" name="line-657"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">retval</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-658" name="line-658"></a><span class="w">		</span><span class="n">g_object_unref</span><span class="w"> </span><span class="p">(</span><span class="n">subfn</span><span class="p">);</span>
<a id="line-659" name="line-659"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-660" name="line-660"></a><span class="w">	</span><span class="p">}</span>
<a id="line-661" name="line-661"></a>
<a id="line-662" name="line-662"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">flags</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_LOAD_ONLY_IF_EXISTS</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<a id="line-663" name="line-663"></a><span class="w">	    </span><span class="o">!</span><span class="w"> </span><span class="n">mate_desktop_item_exists</span><span class="w"> </span><span class="p">(</span><span class="n">retval</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="line-664" name="line-664"></a><span class="w">		</span><span class="n">mate_desktop_item_unref</span><span class="w"> </span><span class="p">(</span><span class="n">retval</span><span class="p">);</span>
<a id="line-665" name="line-665"></a><span class="w">		</span><span class="n">g_object_unref</span><span class="w"> </span><span class="p">(</span><span class="n">subfn</span><span class="p">);</span>
<a id="line-666" name="line-666"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-667" name="line-667"></a><span class="w">	</span><span class="p">}</span>
<a id="line-668" name="line-668"></a>
<a id="line-669" name="line-669"></a><span class="w">	</span><span class="n">retval</span><span class="o">-&gt;</span><span class="n">mtime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DONT_UPDATE_MTIME</span><span class="p">;</span>
<a id="line-670" name="line-670"></a><span class="w">	</span><span class="n">mate_desktop_item_set_location_gfile</span><span class="w"> </span><span class="p">(</span><span class="n">retval</span><span class="p">,</span><span class="w"> </span><span class="n">subfn</span><span class="p">);</span>
<a id="line-671" name="line-671"></a><span class="w">	</span><span class="n">retval</span><span class="o">-&gt;</span><span class="n">mtime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mtime</span><span class="p">;</span>
<a id="line-672" name="line-672"></a>
<a id="line-673" name="line-673"></a><span class="w">	</span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_get_parent</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<a id="line-674" name="line-674"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parent</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-675" name="line-675"></a><span class="w">		</span><span class="n">read_sort_order</span><span class="w"> </span><span class="p">(</span><span class="n">retval</span><span class="p">,</span><span class="w"> </span><span class="n">parent</span><span class="p">);</span>
<a id="line-676" name="line-676"></a><span class="w">		</span><span class="n">g_object_unref</span><span class="w"> </span><span class="p">(</span><span class="n">parent</span><span class="p">);</span>
<a id="line-677" name="line-677"></a><span class="w">	</span><span class="p">}</span>
<a id="line-678" name="line-678"></a>
<a id="line-679" name="line-679"></a><span class="w">	</span><span class="n">g_object_unref</span><span class="w"> </span><span class="p">(</span><span class="n">subfn</span><span class="p">);</span>
<a id="line-680" name="line-680"></a>
<a id="line-681" name="line-681"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">retval</span><span class="p">;</span>
<a id="line-682" name="line-682"></a><span class="p">}</span>
<a id="line-683" name="line-683"></a>
<a id="line-684" name="line-684"></a><span class="cm">/**</span>
<a id="line-685" name="line-685"></a><span class="cm"> * mate_desktop_item_new_from_string:</span>
<a id="line-686" name="line-686"></a><span class="cm"> * @string: string to load the MateDesktopItem from</span>
<a id="line-687" name="line-687"></a><span class="cm"> * @length: length of string, or -1 to use strlen</span>
<a id="line-688" name="line-688"></a><span class="cm"> * @flags: Flags to influence the loading process</span>
<a id="line-689" name="line-689"></a><span class="cm"> * @error: place to put errors</span>
<a id="line-690" name="line-690"></a><span class="cm"> *</span>
<a id="line-691" name="line-691"></a><span class="cm"> * This function turns the contents of the string into a MateDesktopItem.</span>
<a id="line-692" name="line-692"></a><span class="cm"> *</span>
<a id="line-693" name="line-693"></a><span class="cm"> * Returns: The newly loaded item.</span>
<a id="line-694" name="line-694"></a><span class="cm"> */</span>
<a id="line-695" name="line-695"></a><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span>
<a id="line-696" name="line-696"></a><span class="nf">mate_desktop_item_new_from_string</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">uri</span><span class="p">,</span>
<a id="line-697" name="line-697"></a><span class="w">				    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">string</span><span class="p">,</span>
<a id="line-698" name="line-698"></a><span class="w">				    </span><span class="n">gssize</span><span class="w"> </span><span class="n">length</span><span class="p">,</span>
<a id="line-699" name="line-699"></a><span class="w">				    </span><span class="n">MateDesktopItemLoadFlags</span><span class="w"> </span><span class="n">flags</span><span class="p">,</span>
<a id="line-700" name="line-700"></a><span class="w">				    </span><span class="n">GError</span><span class="w"> </span><span class="o">**</span><span class="n">error</span><span class="p">)</span>
<a id="line-701" name="line-701"></a><span class="p">{</span>
<a id="line-702" name="line-702"></a><span class="w">	</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">retval</span><span class="p">;</span>
<a id="line-703" name="line-703"></a><span class="w">	</span><span class="n">ReadBuf</span><span class="w"> </span><span class="o">*</span><span class="n">rb</span><span class="p">;</span>
<a id="line-704" name="line-704"></a>
<a id="line-705" name="line-705"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">string</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-706" name="line-706"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">length</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-707" name="line-707"></a>
<a id="line-708" name="line-708"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-709" name="line-709"></a><span class="w">		</span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strlen</span><span class="w"> </span><span class="p">(</span><span class="n">string</span><span class="p">);</span>
<a id="line-710" name="line-710"></a><span class="w">	</span><span class="p">}</span>
<a id="line-711" name="line-711"></a>
<a id="line-712" name="line-712"></a><span class="w">	</span><span class="n">rb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">readbuf_new_from_string</span><span class="w"> </span><span class="p">(</span><span class="n">uri</span><span class="p">,</span><span class="w"> </span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="p">);</span>
<a id="line-713" name="line-713"></a>
<a id="line-714" name="line-714"></a><span class="w">	</span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ditem_load</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="p">,</span>
<a id="line-715" name="line-715"></a><span class="w">			     </span><span class="p">(</span><span class="n">flags</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_LOAD_NO_TRANSLATIONS</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<a id="line-716" name="line-716"></a><span class="w">			     </span><span class="n">error</span><span class="p">);</span>
<a id="line-717" name="line-717"></a>
<a id="line-718" name="line-718"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">retval</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-719" name="line-719"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-720" name="line-720"></a><span class="w">	</span><span class="p">}</span>
<a id="line-721" name="line-721"></a>
<a id="line-722" name="line-722"></a><span class="w">	</span><span class="cm">/* FIXME: Sort order? */</span>
<a id="line-723" name="line-723"></a>
<a id="line-724" name="line-724"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">retval</span><span class="p">;</span>
<a id="line-725" name="line-725"></a><span class="p">}</span>
<a id="line-726" name="line-726"></a>
<a id="line-727" name="line-727"></a><span class="k">static</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span>
<a id="line-728" name="line-728"></a><span class="nf">lookup_desktop_file_in_data_dir</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">desktop_file</span><span class="p">,</span>
<a id="line-729" name="line-729"></a><span class="w">                                 </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">data_dir</span><span class="p">)</span>
<a id="line-730" name="line-730"></a><span class="p">{</span>
<a id="line-731" name="line-731"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">path</span><span class="p">;</span>
<a id="line-732" name="line-732"></a>
<a id="line-733" name="line-733"></a><span class="w">	</span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_build_filename</span><span class="w"> </span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;applications&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">desktop_file</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-734" name="line-734"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">g_file_test</span><span class="w"> </span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="n">G_FILE_TEST_EXISTS</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="line-735" name="line-735"></a><span class="w">		</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">path</span><span class="p">);</span>
<a id="line-736" name="line-736"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-737" name="line-737"></a><span class="w">	</span><span class="p">}</span>
<a id="line-738" name="line-738"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">path</span><span class="p">;</span>
<a id="line-739" name="line-739"></a><span class="p">}</span>
<a id="line-740" name="line-740"></a>
<a id="line-741" name="line-741"></a><span class="k">static</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span>
<a id="line-742" name="line-742"></a><span class="nf">file_from_basename</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">basename</span><span class="p">)</span>
<a id="line-743" name="line-743"></a><span class="p">{</span>
<a id="line-744" name="line-744"></a><span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="o">*</span><span class="n">system_data_dirs</span><span class="p">;</span>
<a id="line-745" name="line-745"></a><span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w">         </span><span class="o">*</span><span class="n">user_data_dir</span><span class="p">;</span>
<a id="line-746" name="line-746"></a><span class="w">	</span><span class="kt">char</span><span class="w">               </span><span class="o">*</span><span class="n">retval</span><span class="p">;</span>
<a id="line-747" name="line-747"></a><span class="w">	</span><span class="kt">int</span><span class="w">                 </span><span class="n">i</span><span class="p">;</span>
<a id="line-748" name="line-748"></a>
<a id="line-749" name="line-749"></a><span class="w">	</span><span class="n">user_data_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_get_user_data_dir</span><span class="w"> </span><span class="p">();</span>
<a id="line-750" name="line-750"></a><span class="w">	</span><span class="n">system_data_dirs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_get_system_data_dirs</span><span class="w"> </span><span class="p">();</span>
<a id="line-751" name="line-751"></a>
<a id="line-752" name="line-752"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lookup_desktop_file_in_data_dir</span><span class="w"> </span><span class="p">(</span><span class="n">basename</span><span class="p">,</span><span class="w"> </span><span class="n">user_data_dir</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<a id="line-753" name="line-753"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">retval</span><span class="p">;</span>
<a id="line-754" name="line-754"></a><span class="w">	</span><span class="p">}</span>
<a id="line-755" name="line-755"></a><span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">system_data_dirs</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-756" name="line-756"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lookup_desktop_file_in_data_dir</span><span class="w"> </span><span class="p">(</span><span class="n">basename</span><span class="p">,</span><span class="w"> </span><span class="n">system_data_dirs</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span><span class="w"> </span><span class="p">{</span>
<a id="line-757" name="line-757"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">retval</span><span class="p">;</span>
<a id="line-758" name="line-758"></a><span class="w">		</span><span class="p">}</span>
<a id="line-759" name="line-759"></a><span class="w">	</span><span class="p">}</span>
<a id="line-760" name="line-760"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-761" name="line-761"></a><span class="p">}</span>
<a id="line-762" name="line-762"></a>
<a id="line-763" name="line-763"></a><span class="cm">/**</span>
<a id="line-764" name="line-764"></a><span class="cm"> * mate_desktop_item_new_from_basename:</span>
<a id="line-765" name="line-765"></a><span class="cm"> * @basename: The basename of the MateDesktopItem to load.</span>
<a id="line-766" name="line-766"></a><span class="cm"> * @flags: Flags to influence the loading process</span>
<a id="line-767" name="line-767"></a><span class="cm"> *</span>
<a id="line-768" name="line-768"></a><span class="cm"> * This function loads &#39;basename&#39; from a system data directory and</span>
<a id="line-769" name="line-769"></a><span class="cm"> * returns its MateDesktopItem.</span>
<a id="line-770" name="line-770"></a><span class="cm"> *</span>
<a id="line-771" name="line-771"></a><span class="cm"> * Returns: The newly loaded item.</span>
<a id="line-772" name="line-772"></a><span class="cm"> */</span>
<a id="line-773" name="line-773"></a><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span>
<a id="line-774" name="line-774"></a><span class="nf">mate_desktop_item_new_from_basename</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">basename</span><span class="p">,</span>
<a id="line-775" name="line-775"></a><span class="w">                                      </span><span class="n">MateDesktopItemLoadFlags</span><span class="w"> </span><span class="n">flags</span><span class="p">,</span>
<a id="line-776" name="line-776"></a><span class="w">                                      </span><span class="n">GError</span><span class="w"> </span><span class="o">**</span><span class="n">error</span><span class="p">)</span>
<a id="line-777" name="line-777"></a><span class="p">{</span>
<a id="line-778" name="line-778"></a><span class="w">	</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">retval</span><span class="p">;</span>
<a id="line-779" name="line-779"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">file</span><span class="p">;</span>
<a id="line-780" name="line-780"></a>
<a id="line-781" name="line-781"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">basename</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-782" name="line-782"></a>
<a id="line-783" name="line-783"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">file_from_basename</span><span class="w"> </span><span class="p">(</span><span class="n">basename</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<a id="line-784" name="line-784"></a><span class="w">		</span><span class="n">g_set_error</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">,</span>
<a id="line-785" name="line-785"></a><span class="w">			     </span><span class="n">MATE_DESKTOP_ITEM_ERROR</span><span class="p">,</span>
<a id="line-786" name="line-786"></a><span class="w">			     </span><span class="n">MATE_DESKTOP_ITEM_ERROR_CANNOT_OPEN</span><span class="p">,</span>
<a id="line-787" name="line-787"></a><span class="w">			     </span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Cannot find file &#39;%s&#39;&quot;</span><span class="p">),</span>
<a id="line-788" name="line-788"></a><span class="w">			     </span><span class="n">basename</span><span class="p">);</span>
<a id="line-789" name="line-789"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-790" name="line-790"></a><span class="w">	</span><span class="p">}</span>
<a id="line-791" name="line-791"></a>
<a id="line-792" name="line-792"></a><span class="w">	</span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mate_desktop_item_new_from_file</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">flags</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">);</span>
<a id="line-793" name="line-793"></a><span class="w">	</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<a id="line-794" name="line-794"></a>
<a id="line-795" name="line-795"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">retval</span><span class="p">;</span>
<a id="line-796" name="line-796"></a><span class="p">}</span>
<a id="line-797" name="line-797"></a>
<a id="line-798" name="line-798"></a><span class="cm">/**</span>
<a id="line-799" name="line-799"></a><span class="cm"> * mate_desktop_item_save:</span>
<a id="line-800" name="line-800"></a><span class="cm"> * @item: A desktop item</span>
<a id="line-801" name="line-801"></a><span class="cm"> * @under: A new uri (location) for this #MateDesktopItem</span>
<a id="line-802" name="line-802"></a><span class="cm"> * @force: Save even if it wasn&#39;t modified</span>
<a id="line-803" name="line-803"></a><span class="cm"> * @error: #GError return</span>
<a id="line-804" name="line-804"></a><span class="cm"> *</span>
<a id="line-805" name="line-805"></a><span class="cm"> * Writes the specified item to disk.  If the &#39;under&#39; is NULL, the original</span>
<a id="line-806" name="line-806"></a><span class="cm"> * location is used.  It sets the location of this entry to point to the</span>
<a id="line-807" name="line-807"></a><span class="cm"> * new location.</span>
<a id="line-808" name="line-808"></a><span class="cm"> *</span>
<a id="line-809" name="line-809"></a><span class="cm"> * Returns: boolean. %TRUE if the file was saved, %FALSE otherwise</span>
<a id="line-810" name="line-810"></a><span class="cm"> */</span>
<a id="line-811" name="line-811"></a><span class="n">gboolean</span>
<a id="line-812" name="line-812"></a><span class="nf">mate_desktop_item_save</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-813" name="line-813"></a><span class="w">			 </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">under</span><span class="p">,</span>
<a id="line-814" name="line-814"></a><span class="w">			 </span><span class="n">gboolean</span><span class="w"> </span><span class="n">force</span><span class="p">,</span>
<a id="line-815" name="line-815"></a><span class="w">			 </span><span class="n">GError</span><span class="w"> </span><span class="o">**</span><span class="n">error</span><span class="p">)</span>
<a id="line-816" name="line-816"></a><span class="p">{</span>
<a id="line-817" name="line-817"></a><span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">uri</span><span class="p">;</span>
<a id="line-818" name="line-818"></a>
<a id="line-819" name="line-819"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">under</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<a id="line-820" name="line-820"></a><span class="w">	    </span><span class="o">!</span><span class="w"> </span><span class="n">force</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<a id="line-821" name="line-821"></a><span class="w">	    </span><span class="o">!</span><span class="w"> </span><span class="n">item</span><span class="o">-&gt;</span><span class="n">modified</span><span class="p">)</span>
<a id="line-822" name="line-822"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
<a id="line-823" name="line-823"></a>
<a id="line-824" name="line-824"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">under</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-825" name="line-825"></a><span class="w">		</span><span class="n">uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="o">-&gt;</span><span class="n">location</span><span class="p">;</span>
<a id="line-826" name="line-826"></a><span class="w">	</span><span class="k">else</span>
<a id="line-827" name="line-827"></a><span class="w">		</span><span class="n">uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">under</span><span class="p">;</span>
<a id="line-828" name="line-828"></a>
<a id="line-829" name="line-829"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">uri</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-830" name="line-830"></a><span class="w">		</span><span class="n">g_set_error</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">,</span>
<a id="line-831" name="line-831"></a><span class="w">			     </span><span class="n">MATE_DESKTOP_ITEM_ERROR</span><span class="p">,</span>
<a id="line-832" name="line-832"></a><span class="w">			     </span><span class="n">MATE_DESKTOP_ITEM_ERROR_NO_FILENAME</span><span class="p">,</span>
<a id="line-833" name="line-833"></a><span class="w">			     </span><span class="n">_</span><span class="p">(</span><span class="s">&quot;No filename to save to&quot;</span><span class="p">));</span>
<a id="line-834" name="line-834"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-835" name="line-835"></a><span class="w">	</span><span class="p">}</span>
<a id="line-836" name="line-836"></a>
<a id="line-837" name="line-837"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="n">ditem_save</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">uri</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">))</span>
<a id="line-838" name="line-838"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-839" name="line-839"></a>
<a id="line-840" name="line-840"></a><span class="w">	</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">modified</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-841" name="line-841"></a><span class="w">	</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">mtime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_get_real_time</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">G_USEC_PER_SEC</span><span class="p">;</span>
<a id="line-842" name="line-842"></a>
<a id="line-843" name="line-843"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
<a id="line-844" name="line-844"></a><span class="p">}</span>
<a id="line-845" name="line-845"></a>
<a id="line-846" name="line-846"></a><span class="cm">/**</span>
<a id="line-847" name="line-847"></a><span class="cm"> * mate_desktop_item_ref:</span>
<a id="line-848" name="line-848"></a><span class="cm"> * @item: A desktop item</span>
<a id="line-849" name="line-849"></a><span class="cm"> *</span>
<a id="line-850" name="line-850"></a><span class="cm"> * Description: Increases the reference count of the specified item.</span>
<a id="line-851" name="line-851"></a><span class="cm"> *</span>
<a id="line-852" name="line-852"></a><span class="cm"> * Returns: the newly referenced @item</span>
<a id="line-853" name="line-853"></a><span class="cm"> */</span>
<a id="line-854" name="line-854"></a><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span>
<a id="line-855" name="line-855"></a><span class="nf">mate_desktop_item_ref</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">)</span>
<a id="line-856" name="line-856"></a><span class="p">{</span>
<a id="line-857" name="line-857"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-858" name="line-858"></a>
<a id="line-859" name="line-859"></a><span class="w">	</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="o">++</span><span class="p">;</span>
<a id="line-860" name="line-860"></a>
<a id="line-861" name="line-861"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">item</span><span class="p">;</span>
<a id="line-862" name="line-862"></a><span class="p">}</span>
<a id="line-863" name="line-863"></a>
<a id="line-864" name="line-864"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<a id="line-865" name="line-865"></a><span class="nf">free_section</span><span class="w"> </span><span class="p">(</span><span class="n">gpointer</span><span class="w"> </span><span class="n">data</span><span class="p">)</span>
<a id="line-866" name="line-866"></a><span class="p">{</span>
<a id="line-867" name="line-867"></a><span class="w">	</span><span class="n">Section</span><span class="w"> </span><span class="o">*</span><span class="n">section</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">;</span>
<a id="line-868" name="line-868"></a>
<a id="line-869" name="line-869"></a><span class="w">	</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">section</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
<a id="line-870" name="line-870"></a><span class="w">	</span><span class="n">section</span><span class="o">-&gt;</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-871" name="line-871"></a>
<a id="line-872" name="line-872"></a><span class="w">	</span><span class="n">g_list_free_full</span><span class="w"> </span><span class="p">(</span><span class="n">section</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">,</span><span class="w"> </span><span class="n">g_free</span><span class="p">);</span>
<a id="line-873" name="line-873"></a><span class="w">	</span><span class="n">section</span><span class="o">-&gt;</span><span class="n">keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-874" name="line-874"></a>
<a id="line-875" name="line-875"></a><span class="w">	</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">section</span><span class="p">);</span>
<a id="line-876" name="line-876"></a><span class="p">}</span>
<a id="line-877" name="line-877"></a>
<a id="line-878" name="line-878"></a><span class="cm">/**</span>
<a id="line-879" name="line-879"></a><span class="cm"> * mate_desktop_item_unref:</span>
<a id="line-880" name="line-880"></a><span class="cm"> * @item: A desktop item</span>
<a id="line-881" name="line-881"></a><span class="cm"> *</span>
<a id="line-882" name="line-882"></a><span class="cm"> * Decreases the reference count of the specified item, and destroys the item if there are no more references left.</span>
<a id="line-883" name="line-883"></a><span class="cm"> */</span>
<a id="line-884" name="line-884"></a><span class="kt">void</span>
<a id="line-885" name="line-885"></a><span class="nf">mate_desktop_item_unref</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">)</span>
<a id="line-886" name="line-886"></a><span class="p">{</span>
<a id="line-887" name="line-887"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-888" name="line-888"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<a id="line-889" name="line-889"></a>
<a id="line-890" name="line-890"></a><span class="w">	</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="o">--</span><span class="p">;</span>
<a id="line-891" name="line-891"></a>
<a id="line-892" name="line-892"></a><span class="w">	</span><span class="k">if</span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<a id="line-893" name="line-893"></a><span class="w">		</span><span class="k">return</span><span class="p">;</span>
<a id="line-894" name="line-894"></a>
<a id="line-895" name="line-895"></a><span class="w">	</span><span class="n">g_list_free_full</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">languages</span><span class="p">,</span><span class="w"> </span><span class="n">g_free</span><span class="p">);</span>
<a id="line-896" name="line-896"></a><span class="w">	</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">languages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-897" name="line-897"></a>
<a id="line-898" name="line-898"></a><span class="w">	</span><span class="n">g_list_free_full</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">,</span><span class="w"> </span><span class="n">g_free</span><span class="p">);</span>
<a id="line-899" name="line-899"></a><span class="w">	</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-900" name="line-900"></a>
<a id="line-901" name="line-901"></a><span class="w">	</span><span class="n">g_list_free_full</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">sections</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">GDestroyNotify</span><span class="p">)</span><span class="w"> </span><span class="n">free_section</span><span class="p">);</span>
<a id="line-902" name="line-902"></a><span class="w">	</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">sections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-903" name="line-903"></a>
<a id="line-904" name="line-904"></a><span class="w">	</span><span class="n">g_hash_table_destroy</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">main_hash</span><span class="p">);</span>
<a id="line-905" name="line-905"></a><span class="w">	</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">main_hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-906" name="line-906"></a>
<a id="line-907" name="line-907"></a><span class="w">	</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">location</span><span class="p">);</span>
<a id="line-908" name="line-908"></a><span class="w">	</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-909" name="line-909"></a>
<a id="line-910" name="line-910"></a><span class="w">	</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
<a id="line-911" name="line-911"></a><span class="p">}</span>
<a id="line-912" name="line-912"></a>
<a id="line-913" name="line-913"></a><span class="k">static</span><span class="w"> </span><span class="n">Section</span><span class="w"> </span><span class="o">*</span>
<a id="line-914" name="line-914"></a><span class="nf">find_section</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">section</span><span class="p">)</span>
<a id="line-915" name="line-915"></a><span class="p">{</span>
<a id="line-916" name="line-916"></a><span class="hll"><span class="w">	</span><span class="n">GList</span><span class="w"> </span><span class="o">*</span><span class="n">li</span><span class="p">;</span><span class="error2">&lt;--- Variable 'li' can be declared as pointer to const</span>
</span><a id="line-917" name="line-917"></a><span class="w">	</span><span class="n">Section</span><span class="w"> </span><span class="o">*</span><span class="n">sec</span><span class="p">;</span>
<a id="line-918" name="line-918"></a>
<a id="line-919" name="line-919"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">section</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-920" name="line-920"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-921" name="line-921"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="n">section</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Desktop Entry&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<a id="line-922" name="line-922"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-923" name="line-923"></a>
<a id="line-924" name="line-924"></a><span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="o">-&gt;</span><span class="n">sections</span><span class="p">;</span><span class="w"> </span><span class="n">li</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"> </span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">li</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-925" name="line-925"></a><span class="w">		</span><span class="n">sec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">li</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
<a id="line-926" name="line-926"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="n">sec</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">section</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<a id="line-927" name="line-927"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">sec</span><span class="p">;</span>
<a id="line-928" name="line-928"></a><span class="w">	</span><span class="p">}</span>
<a id="line-929" name="line-929"></a>
<a id="line-930" name="line-930"></a><span class="w">	</span><span class="n">sec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_new0</span><span class="w"> </span><span class="p">(</span><span class="n">Section</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="line-931" name="line-931"></a><span class="w">	</span><span class="n">sec</span><span class="o">-&gt;</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">section</span><span class="p">);</span>
<a id="line-932" name="line-932"></a><span class="w">	</span><span class="n">sec</span><span class="o">-&gt;</span><span class="n">keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-933" name="line-933"></a>
<a id="line-934" name="line-934"></a><span class="w">	</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">sections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_list_append</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">sections</span><span class="p">,</span><span class="w"> </span><span class="n">sec</span><span class="p">);</span>
<a id="line-935" name="line-935"></a>
<a id="line-936" name="line-936"></a><span class="w">	</span><span class="cm">/* Don&#39;t mark the item modified, this is just an empty section,</span>
<a id="line-937" name="line-937"></a><span class="cm">	 * it won&#39;t be saved even */</span>
<a id="line-938" name="line-938"></a>
<a id="line-939" name="line-939"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">sec</span><span class="p">;</span>
<a id="line-940" name="line-940"></a><span class="p">}</span>
<a id="line-941" name="line-941"></a>
<a id="line-942" name="line-942"></a><span class="k">static</span><span class="w"> </span><span class="n">Section</span><span class="w"> </span><span class="o">*</span>
<a id="line-943" name="line-943"></a><span class="nf">section_from_key</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">key</span><span class="p">)</span>
<a id="line-944" name="line-944"></a><span class="p">{</span>
<a id="line-945" name="line-945"></a><span class="hll"><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">;</span><span class="error2">&lt;--- Variable 'p' can be declared as pointer to const</span>
</span><a id="line-946" name="line-946"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="p">;</span>
<a id="line-947" name="line-947"></a><span class="w">	</span><span class="n">Section</span><span class="w"> </span><span class="o">*</span><span class="n">sec</span><span class="p">;</span>
<a id="line-948" name="line-948"></a>
<a id="line-949" name="line-949"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-950" name="line-950"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-951" name="line-951"></a>
<a id="line-952" name="line-952"></a><span class="w">	</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strchr</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;/&#39;</span><span class="p">);</span>
<a id="line-953" name="line-953"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-954" name="line-954"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-955" name="line-955"></a>
<a id="line-956" name="line-956"></a><span class="w">	</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strndup</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>
<a id="line-957" name="line-957"></a>
<a id="line-958" name="line-958"></a><span class="w">	</span><span class="n">sec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">find_section</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
<a id="line-959" name="line-959"></a>
<a id="line-960" name="line-960"></a><span class="w">	</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<a id="line-961" name="line-961"></a>
<a id="line-962" name="line-962"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">sec</span><span class="p">;</span>
<a id="line-963" name="line-963"></a><span class="p">}</span>
<a id="line-964" name="line-964"></a>
<a id="line-965" name="line-965"></a><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span>
<a id="line-966" name="line-966"></a><span class="nf">key_basename</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">key</span><span class="p">)</span>
<a id="line-967" name="line-967"></a><span class="p">{</span>
<a id="line-968" name="line-968"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strrchr</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;/&#39;</span><span class="p">);</span>
<a id="line-969" name="line-969"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-970" name="line-970"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
<a id="line-971" name="line-971"></a><span class="w">	</span><span class="k">else</span>
<a id="line-972" name="line-972"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">key</span><span class="p">;</span>
<a id="line-973" name="line-973"></a><span class="p">}</span>
<a id="line-974" name="line-974"></a>
<a id="line-975" name="line-975"></a><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span>
<a id="line-976" name="line-976"></a><span class="nf">lookup</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">key</span><span class="p">)</span>
<a id="line-977" name="line-977"></a><span class="p">{</span>
<a id="line-978" name="line-978"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">g_hash_table_lookup</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">main_hash</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>
<a id="line-979" name="line-979"></a><span class="p">}</span>
<a id="line-980" name="line-980"></a>
<a id="line-981" name="line-981"></a><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span>
<a id="line-982" name="line-982"></a><span class="nf">lookup_locale</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">locale</span><span class="p">)</span>
<a id="line-983" name="line-983"></a><span class="p">{</span>
<a id="line-984" name="line-984"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">locale</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">||</span>
<a id="line-985" name="line-985"></a><span class="w">	    </span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="n">locale</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;C&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-986" name="line-986"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">lookup</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>
<a id="line-987" name="line-987"></a><span class="w">	</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-988" name="line-988"></a><span class="w">		</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">ret</span><span class="p">;</span>
<a id="line-989" name="line-989"></a><span class="w">		</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">full</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup_printf</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;%s[%s]&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">locale</span><span class="p">);</span>
<a id="line-990" name="line-990"></a><span class="w">		</span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lookup</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">full</span><span class="p">);</span>
<a id="line-991" name="line-991"></a><span class="w">		</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">full</span><span class="p">);</span>
<a id="line-992" name="line-992"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<a id="line-993" name="line-993"></a><span class="w">	</span><span class="p">}</span>
<a id="line-994" name="line-994"></a><span class="p">}</span>
<a id="line-995" name="line-995"></a>
<a id="line-996" name="line-996"></a><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span>
<a id="line-997" name="line-997"></a><span class="nf">lookup_best_locale</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">key</span><span class="p">)</span>
<a id="line-998" name="line-998"></a><span class="p">{</span>
<a id="line-999" name="line-999"></a><span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="o">*</span><span class="n">langs_pointer</span><span class="p">;</span>
<a id="line-1000" name="line-1000"></a><span class="w">	</span><span class="kt">int</span><span class="w">                 </span><span class="n">i</span><span class="p">;</span>
<a id="line-1001" name="line-1001"></a>
<a id="line-1002" name="line-1002"></a><span class="w">	</span><span class="n">langs_pointer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_get_language_names</span><span class="w"> </span><span class="p">();</span>
<a id="line-1003" name="line-1003"></a><span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">langs_pointer</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1004" name="line-1004"></a><span class="w">		</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-1005" name="line-1005"></a>
<a id="line-1006" name="line-1006"></a><span class="w">		</span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lookup_locale</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">langs_pointer</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<a id="line-1007" name="line-1007"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-1008" name="line-1008"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<a id="line-1009" name="line-1009"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1010" name="line-1010"></a>
<a id="line-1011" name="line-1011"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-1012" name="line-1012"></a><span class="p">}</span>
<a id="line-1013" name="line-1013"></a>
<a id="line-1014" name="line-1014"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<a id="line-1015" name="line-1015"></a><span class="nf">set</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">value</span><span class="p">)</span>
<a id="line-1016" name="line-1016"></a><span class="p">{</span>
<a id="line-1017" name="line-1017"></a><span class="w">	</span><span class="n">Section</span><span class="w"> </span><span class="o">*</span><span class="n">sec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">section_from_key</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>
<a id="line-1018" name="line-1018"></a>
<a id="line-1019" name="line-1019"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sec</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1020" name="line-1020"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1021" name="line-1021"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">g_hash_table_lookup</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">main_hash</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-1022" name="line-1022"></a><span class="w">				</span><span class="n">sec</span><span class="o">-&gt;</span><span class="n">keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_list_append</span>
<a id="line-1023" name="line-1023"></a><span class="w">					</span><span class="p">(</span><span class="n">sec</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">,</span>
<a id="line-1024" name="line-1024"></a><span class="w">					 </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">key_basename</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="p">)));</span>
<a id="line-1025" name="line-1025"></a>
<a id="line-1026" name="line-1026"></a><span class="w">			</span><span class="n">g_hash_table_replace</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">main_hash</span><span class="p">,</span>
<a id="line-1027" name="line-1027"></a><span class="w">					      </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="p">),</span>
<a id="line-1028" name="line-1028"></a><span class="w">					      </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">));</span>
<a id="line-1029" name="line-1029"></a><span class="w">		</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-1030" name="line-1030"></a><span class="w">			</span><span class="n">GList</span><span class="w"> </span><span class="o">*</span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_list_find_custom</span>
<a id="line-1031" name="line-1031"></a><span class="w">				</span><span class="p">(</span><span class="n">sec</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">,</span><span class="w"> </span><span class="n">key_basename</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="p">),</span>
<a id="line-1032" name="line-1032"></a><span class="w">				 </span><span class="p">(</span><span class="n">GCompareFunc</span><span class="p">)</span><span class="n">strcmp</span><span class="p">);</span>
<a id="line-1033" name="line-1033"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">list</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1034" name="line-1034"></a><span class="w">				</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">list</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">);</span>
<a id="line-1035" name="line-1035"></a><span class="w">				</span><span class="n">sec</span><span class="o">-&gt;</span><span class="n">keys</span><span class="w"> </span><span class="o">=</span>
<a id="line-1036" name="line-1036"></a><span class="w">					</span><span class="n">g_list_delete_link</span><span class="w"> </span><span class="p">(</span><span class="n">sec</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">,</span><span class="w"> </span><span class="n">list</span><span class="p">);</span>
<a id="line-1037" name="line-1037"></a><span class="w">			</span><span class="p">}</span>
<a id="line-1038" name="line-1038"></a><span class="w">			</span><span class="n">g_hash_table_remove</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">main_hash</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>
<a id="line-1039" name="line-1039"></a><span class="w">		</span><span class="p">}</span>
<a id="line-1040" name="line-1040"></a><span class="w">	</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-1041" name="line-1041"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1042" name="line-1042"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">g_hash_table_lookup</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">main_hash</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-1043" name="line-1043"></a><span class="w">				</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_list_append</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">,</span>
<a id="line-1044" name="line-1044"></a><span class="w">							    </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
<a id="line-1045" name="line-1045"></a>
<a id="line-1046" name="line-1046"></a><span class="w">			</span><span class="n">g_hash_table_replace</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">main_hash</span><span class="p">,</span>
<a id="line-1047" name="line-1047"></a><span class="w">					      </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="p">),</span>
<a id="line-1048" name="line-1048"></a><span class="w">					      </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">));</span>
<a id="line-1049" name="line-1049"></a><span class="w">		</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-1050" name="line-1050"></a><span class="w">			</span><span class="n">GList</span><span class="w"> </span><span class="o">*</span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_list_find_custom</span>
<a id="line-1051" name="line-1051"></a><span class="w">				</span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">GCompareFunc</span><span class="p">)</span><span class="n">strcmp</span><span class="p">);</span>
<a id="line-1052" name="line-1052"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">list</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1053" name="line-1053"></a><span class="w">				</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">list</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">);</span>
<a id="line-1054" name="line-1054"></a><span class="w">				</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">keys</span><span class="w"> </span><span class="o">=</span>
<a id="line-1055" name="line-1055"></a><span class="w">					</span><span class="n">g_list_delete_link</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">,</span><span class="w"> </span><span class="n">list</span><span class="p">);</span>
<a id="line-1056" name="line-1056"></a><span class="w">			</span><span class="p">}</span>
<a id="line-1057" name="line-1057"></a><span class="w">			</span><span class="n">g_hash_table_remove</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">main_hash</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>
<a id="line-1058" name="line-1058"></a><span class="w">		</span><span class="p">}</span>
<a id="line-1059" name="line-1059"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1060" name="line-1060"></a><span class="w">	</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">modified</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
<a id="line-1061" name="line-1061"></a><span class="p">}</span>
<a id="line-1062" name="line-1062"></a>
<a id="line-1063" name="line-1063"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<a id="line-1064" name="line-1064"></a><span class="nf">set_locale</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">key</span><span class="p">,</span>
<a id="line-1065" name="line-1065"></a><span class="w">	    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">locale</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">value</span><span class="p">)</span>
<a id="line-1066" name="line-1066"></a><span class="p">{</span>
<a id="line-1067" name="line-1067"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">locale</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">||</span>
<a id="line-1068" name="line-1068"></a><span class="w">	    </span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="n">locale</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;C&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1069" name="line-1069"></a><span class="w">		</span><span class="n">set</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
<a id="line-1070" name="line-1070"></a><span class="w">	</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-1071" name="line-1071"></a><span class="w">		</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">full</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup_printf</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;%s[%s]&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">locale</span><span class="p">);</span>
<a id="line-1072" name="line-1072"></a><span class="w">		</span><span class="n">set</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">full</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
<a id="line-1073" name="line-1073"></a><span class="w">		</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">full</span><span class="p">);</span>
<a id="line-1074" name="line-1074"></a>
<a id="line-1075" name="line-1075"></a><span class="w">		</span><span class="cm">/* add the locale to the list of languages if it wasn&#39;t there</span>
<a id="line-1076" name="line-1076"></a><span class="cm">		 * before */</span>
<a id="line-1077" name="line-1077"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">g_list_find_custom</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">languages</span><span class="p">,</span><span class="w"> </span><span class="n">locale</span><span class="p">,</span>
<a id="line-1078" name="line-1078"></a><span class="w">					</span><span class="p">(</span><span class="n">GCompareFunc</span><span class="p">)</span><span class="n">strcmp</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-1079" name="line-1079"></a><span class="w">			</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">languages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_list_prepend</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">languages</span><span class="p">,</span>
<a id="line-1080" name="line-1080"></a><span class="w">							  </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">locale</span><span class="p">));</span>
<a id="line-1081" name="line-1081"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1082" name="line-1082"></a><span class="p">}</span>
<a id="line-1083" name="line-1083"></a>
<a id="line-1084" name="line-1084"></a><span class="k">static</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span>
<a id="line-1085" name="line-1085"></a><span class="nf">list_to_vector</span><span class="w"> </span><span class="p">(</span><span class="n">GSList</span><span class="w"> </span><span class="o">*</span><span class="n">list</span><span class="p">)</span>
<a id="line-1086" name="line-1086"></a><span class="p">{</span>
<a id="line-1087" name="line-1087"></a><span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_slist_length</span><span class="w"> </span><span class="p">(</span><span class="n">list</span><span class="p">);</span>
<a id="line-1088" name="line-1088"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">argv</span><span class="p">;</span>
<a id="line-1089" name="line-1089"></a><span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<a id="line-1090" name="line-1090"></a><span class="w">	</span><span class="n">GSList</span><span class="w"> </span><span class="o">*</span><span class="n">li</span><span class="p">;</span>
<a id="line-1091" name="line-1091"></a>
<a id="line-1092" name="line-1092"></a><span class="w">	</span><span class="n">argv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_new0</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">len</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
<a id="line-1093" name="line-1093"></a>
<a id="line-1094" name="line-1094"></a><span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">list</span><span class="p">;</span>
<a id="line-1095" name="line-1095"></a><span class="w">	     </span><span class="n">li</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-1096" name="line-1096"></a><span class="w">	     </span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">li</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1097" name="line-1097"></a><span class="w">		</span><span class="n">argv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">li</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">);</span>
<a id="line-1098" name="line-1098"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1099" name="line-1099"></a><span class="w">	</span><span class="n">argv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-1100" name="line-1100"></a>
<a id="line-1101" name="line-1101"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">argv</span><span class="p">;</span>
<a id="line-1102" name="line-1102"></a><span class="p">}</span>
<a id="line-1103" name="line-1103"></a>
<a id="line-1104" name="line-1104"></a><span class="k">static</span><span class="w"> </span><span class="n">GSList</span><span class="w"> </span><span class="o">*</span>
<a id="line-1105" name="line-1105"></a><span class="nf">make_args</span><span class="w"> </span><span class="p">(</span><span class="n">GList</span><span class="w"> </span><span class="o">*</span><span class="n">files</span><span class="p">)</span>
<a id="line-1106" name="line-1106"></a><span class="p">{</span>
<a id="line-1107" name="line-1107"></a><span class="w">	</span><span class="n">GSList</span><span class="w"> </span><span class="o">*</span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-1108" name="line-1108"></a><span class="w">	</span><span class="n">GList</span><span class="w"> </span><span class="o">*</span><span class="n">li</span><span class="p">;</span>
<a id="line-1109" name="line-1109"></a>
<a id="line-1110" name="line-1110"></a><span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">files</span><span class="p">;</span><span class="w"> </span><span class="n">li</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"> </span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">li</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1111" name="line-1111"></a><span class="w">		</span><span class="n">GFile</span><span class="w"> </span><span class="o">*</span><span class="n">gfile</span><span class="p">;</span>
<a id="line-1112" name="line-1112"></a><span class="w">		</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">li</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
<a id="line-1113" name="line-1113"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-1114" name="line-1114"></a><span class="w">			</span><span class="k">continue</span><span class="p">;</span>
<a id="line-1115" name="line-1115"></a><span class="w">		</span><span class="n">gfile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_new_for_uri</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<a id="line-1116" name="line-1116"></a><span class="w">		</span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_slist_prepend</span><span class="w"> </span><span class="p">(</span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="n">gfile</span><span class="p">);</span>
<a id="line-1117" name="line-1117"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1118" name="line-1118"></a>
<a id="line-1119" name="line-1119"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">g_slist_reverse</span><span class="w"> </span><span class="p">(</span><span class="n">list</span><span class="p">);</span>
<a id="line-1120" name="line-1120"></a><span class="p">}</span>
<a id="line-1121" name="line-1121"></a>
<a id="line-1122" name="line-1122"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<a id="line-1123" name="line-1123"></a><span class="nf">free_args</span><span class="w"> </span><span class="p">(</span><span class="n">GSList</span><span class="w"> </span><span class="o">*</span><span class="n">list</span><span class="p">)</span>
<a id="line-1124" name="line-1124"></a><span class="p">{</span>
<a id="line-1125" name="line-1125"></a><span class="w">	</span><span class="n">GSList</span><span class="w"> </span><span class="o">*</span><span class="n">li</span><span class="p">;</span>
<a id="line-1126" name="line-1126"></a>
<a id="line-1127" name="line-1127"></a><span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">list</span><span class="p">;</span><span class="w"> </span><span class="n">li</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"> </span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">li</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1128" name="line-1128"></a><span class="w">		</span><span class="n">g_object_unref</span><span class="w"> </span><span class="p">(</span><span class="n">G_FILE</span><span class="w"> </span><span class="p">(</span><span class="n">li</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">));</span>
<a id="line-1129" name="line-1129"></a><span class="w">		</span><span class="n">li</span><span class="o">-&gt;</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-1130" name="line-1130"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1131" name="line-1131"></a><span class="w">	</span><span class="n">g_slist_free</span><span class="w"> </span><span class="p">(</span><span class="n">list</span><span class="p">);</span>
<a id="line-1132" name="line-1132"></a><span class="p">}</span>
<a id="line-1133" name="line-1133"></a>
<a id="line-1134" name="line-1134"></a><span class="k">static</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span>
<a id="line-1135" name="line-1135"></a><span class="nf">escape_single_quotes</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">s</span><span class="p">,</span>
<a id="line-1136" name="line-1136"></a><span class="w">		      </span><span class="n">gboolean</span><span class="w"> </span><span class="n">in_single_quotes</span><span class="p">,</span>
<a id="line-1137" name="line-1137"></a><span class="w">		      </span><span class="n">gboolean</span><span class="w"> </span><span class="n">in_double_quotes</span><span class="p">)</span>
<a id="line-1138" name="line-1138"></a><span class="p">{</span>
<a id="line-1139" name="line-1139"></a><span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">;</span>
<a id="line-1140" name="line-1140"></a><span class="w">	</span><span class="n">GString</span><span class="w"> </span><span class="o">*</span><span class="n">gs</span><span class="p">;</span>
<a id="line-1141" name="line-1141"></a><span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">pre</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<a id="line-1142" name="line-1142"></a><span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">post</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<a id="line-1143" name="line-1143"></a>
<a id="line-1144" name="line-1144"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="n">in_single_quotes</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="n">in_double_quotes</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1145" name="line-1145"></a><span class="w">		</span><span class="n">pre</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&#39;&quot;</span><span class="p">;</span>
<a id="line-1146" name="line-1146"></a><span class="w">		</span><span class="n">post</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&#39;&quot;</span><span class="p">;</span>
<a id="line-1147" name="line-1147"></a><span class="w">	</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="n">in_single_quotes</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">in_double_quotes</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1148" name="line-1148"></a><span class="w">		</span><span class="n">pre</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\&quot;</span><span class="s">&#39;&quot;</span><span class="p">;</span>
<a id="line-1149" name="line-1149"></a><span class="w">		</span><span class="n">post</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&#39;</span><span class="se">\&quot;</span><span class="s">&quot;</span><span class="p">;</span>
<a id="line-1150" name="line-1150"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1151" name="line-1151"></a>
<a id="line-1152" name="line-1152"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">strchr</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;\&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1153" name="line-1153"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">g_strconcat</span><span class="w"> </span><span class="p">(</span><span class="n">pre</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">post</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-1154" name="line-1154"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1155" name="line-1155"></a>
<a id="line-1156" name="line-1156"></a><span class="w">	</span><span class="n">gs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_string_new</span><span class="w"> </span><span class="p">(</span><span class="n">pre</span><span class="p">);</span>
<a id="line-1157" name="line-1157"></a>
<a id="line-1158" name="line-1158"></a><span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">;</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">;</span><span class="w"> </span><span class="n">p</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1159" name="line-1159"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;\&#39;&#39;</span><span class="p">)</span>
<a id="line-1160" name="line-1160"></a><span class="w">			</span><span class="n">g_string_append</span><span class="w"> </span><span class="p">(</span><span class="n">gs</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&#39;</span><span class="se">\\</span><span class="s">&#39;&#39;&quot;</span><span class="p">);</span>
<a id="line-1161" name="line-1161"></a><span class="w">		</span><span class="k">else</span>
<a id="line-1162" name="line-1162"></a><span class="w">			</span><span class="n">g_string_append_c</span><span class="w"> </span><span class="p">(</span><span class="n">gs</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">);</span>
<a id="line-1163" name="line-1163"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1164" name="line-1164"></a>
<a id="line-1165" name="line-1165"></a><span class="w">	</span><span class="n">g_string_append</span><span class="w"> </span><span class="p">(</span><span class="n">gs</span><span class="p">,</span><span class="w"> </span><span class="n">post</span><span class="p">);</span>
<a id="line-1166" name="line-1166"></a>
<a id="line-1167" name="line-1167"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">g_string_free</span><span class="w"> </span><span class="p">(</span><span class="n">gs</span><span class="p">,</span><span class="w"> </span><span class="n">FALSE</span><span class="p">);</span>
<a id="line-1168" name="line-1168"></a><span class="p">}</span>
<a id="line-1169" name="line-1169"></a>
<a id="line-1170" name="line-1170"></a><span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="p">{</span>
<a id="line-1171" name="line-1171"></a><span class="w">	</span><span class="n">URI_TO_STRING</span><span class="p">,</span>
<a id="line-1172" name="line-1172"></a><span class="w">	</span><span class="n">URI_TO_LOCAL_PATH</span><span class="p">,</span>
<a id="line-1173" name="line-1173"></a><span class="w">	</span><span class="n">URI_TO_LOCAL_DIRNAME</span><span class="p">,</span>
<a id="line-1174" name="line-1174"></a><span class="w">	</span><span class="n">URI_TO_LOCAL_BASENAME</span>
<a id="line-1175" name="line-1175"></a><span class="p">}</span><span class="w"> </span><span class="n">ConversionType</span><span class="p">;</span>
<a id="line-1176" name="line-1176"></a>
<a id="line-1177" name="line-1177"></a><span class="k">static</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span>
<a id="line-1178" name="line-1178"></a><span class="nf">convert_uri</span><span class="w"> </span><span class="p">(</span><span class="n">GFile</span><span class="w">          </span><span class="o">*</span><span class="n">file</span><span class="p">,</span>
<a id="line-1179" name="line-1179"></a><span class="w">	     </span><span class="n">ConversionType</span><span class="w">  </span><span class="n">conversion</span><span class="p">)</span>
<a id="line-1180" name="line-1180"></a><span class="p">{</span>
<a id="line-1181" name="line-1181"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-1182" name="line-1182"></a>
<a id="line-1183" name="line-1183"></a><span class="w">	</span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">conversion</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1184" name="line-1184"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="no">URI_TO_STRING</span><span class="p">:</span>
<a id="line-1185" name="line-1185"></a><span class="w">		</span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_get_uri</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<a id="line-1186" name="line-1186"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-1187" name="line-1187"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="no">URI_TO_LOCAL_PATH</span><span class="p">:</span>
<a id="line-1188" name="line-1188"></a><span class="w">		</span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_get_path</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<a id="line-1189" name="line-1189"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-1190" name="line-1190"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="no">URI_TO_LOCAL_DIRNAME</span><span class="p">:</span>
<a id="line-1191" name="line-1191"></a><span class="w">		</span><span class="p">{</span>
<a id="line-1192" name="line-1192"></a><span class="w">			</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">local_path</span><span class="p">;</span>
<a id="line-1193" name="line-1193"></a>
<a id="line-1194" name="line-1194"></a><span class="w">			</span><span class="n">local_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_get_path</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<a id="line-1195" name="line-1195"></a><span class="w">			</span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_path_get_dirname</span><span class="w"> </span><span class="p">(</span><span class="n">local_path</span><span class="p">);</span>
<a id="line-1196" name="line-1196"></a><span class="w">			</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">local_path</span><span class="p">);</span>
<a id="line-1197" name="line-1197"></a><span class="w">		</span><span class="p">}</span>
<a id="line-1198" name="line-1198"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-1199" name="line-1199"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="no">URI_TO_LOCAL_BASENAME</span><span class="p">:</span>
<a id="line-1200" name="line-1200"></a><span class="w">		</span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_get_basename</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<a id="line-1201" name="line-1201"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-1202" name="line-1202"></a><span class="w">	</span><span class="k">default</span><span class="o">:</span>
<a id="line-1203" name="line-1203"></a><span class="w">		</span><span class="n">g_assert_not_reached</span><span class="w"> </span><span class="p">();</span>
<a id="line-1204" name="line-1204"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1205" name="line-1205"></a>
<a id="line-1206" name="line-1206"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">retval</span><span class="p">;</span>
<a id="line-1207" name="line-1207"></a><span class="p">}</span>
<a id="line-1208" name="line-1208"></a>
<a id="line-1209" name="line-1209"></a><span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="p">{</span>
<a id="line-1210" name="line-1210"></a><span class="w">	</span><span class="n">ADDED_NONE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<a id="line-1211" name="line-1211"></a><span class="w">	</span><span class="n">ADDED_SINGLE</span><span class="p">,</span>
<a id="line-1212" name="line-1212"></a><span class="w">	</span><span class="n">ADDED_ALL</span>
<a id="line-1213" name="line-1213"></a><span class="p">}</span><span class="w"> </span><span class="n">AddedStatus</span><span class="p">;</span>
<a id="line-1214" name="line-1214"></a>
<a id="line-1215" name="line-1215"></a><span class="k">static</span><span class="w"> </span><span class="n">AddedStatus</span>
<a id="line-1216" name="line-1216"></a><span class="nf">append_all_converted</span><span class="w"> </span><span class="p">(</span><span class="n">GString</span><span class="w">        </span><span class="o">*</span><span class="n">str</span><span class="p">,</span>
<a id="line-1217" name="line-1217"></a><span class="w">		      </span><span class="n">ConversionType</span><span class="w">  </span><span class="n">conversion</span><span class="p">,</span>
<a id="line-1218" name="line-1218"></a><span class="w">		      </span><span class="n">GSList</span><span class="w">         </span><span class="o">*</span><span class="n">args</span><span class="p">,</span>
<a id="line-1219" name="line-1219"></a><span class="w">		      </span><span class="n">gboolean</span><span class="w">        </span><span class="n">in_single_quotes</span><span class="p">,</span>
<a id="line-1220" name="line-1220"></a><span class="w">		      </span><span class="n">gboolean</span><span class="w">        </span><span class="n">in_double_quotes</span><span class="p">,</span>
<a id="line-1221" name="line-1221"></a><span class="w">		      </span><span class="n">AddedStatus</span><span class="w">     </span><span class="n">added_status</span><span class="p">)</span>
<a id="line-1222" name="line-1222"></a><span class="p">{</span>
<a id="line-1223" name="line-1223"></a><span class="w">	</span><span class="n">GSList</span><span class="w"> </span><span class="o">*</span><span class="n">l</span><span class="p">;</span>
<a id="line-1224" name="line-1224"></a>
<a id="line-1225" name="line-1225"></a><span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">args</span><span class="p">;</span><span class="w"> </span><span class="n">l</span><span class="p">;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1226" name="line-1226"></a><span class="w">		</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">converted</span><span class="p">;</span>
<a id="line-1227" name="line-1227"></a><span class="w">		</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">escaped</span><span class="p">;</span>
<a id="line-1228" name="line-1228"></a>
<a id="line-1229" name="line-1229"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">converted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">convert_uri</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">conversion</span><span class="p">)))</span>
<a id="line-1230" name="line-1230"></a><span class="w">			</span><span class="k">continue</span><span class="p">;</span>
<a id="line-1231" name="line-1231"></a>
<a id="line-1232" name="line-1232"></a><span class="w">		</span><span class="n">g_string_append</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">);</span>
<a id="line-1233" name="line-1233"></a>
<a id="line-1234" name="line-1234"></a><span class="w">		</span><span class="n">escaped</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">escape_single_quotes</span><span class="w"> </span><span class="p">(</span><span class="n">converted</span><span class="p">,</span>
<a id="line-1235" name="line-1235"></a><span class="w">						</span><span class="n">in_single_quotes</span><span class="p">,</span>
<a id="line-1236" name="line-1236"></a><span class="w">						</span><span class="n">in_double_quotes</span><span class="p">);</span>
<a id="line-1237" name="line-1237"></a><span class="w">		</span><span class="n">g_string_append</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">escaped</span><span class="p">);</span>
<a id="line-1238" name="line-1238"></a>
<a id="line-1239" name="line-1239"></a><span class="w">		</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">escaped</span><span class="p">);</span>
<a id="line-1240" name="line-1240"></a><span class="w">		</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">converted</span><span class="p">);</span>
<a id="line-1241" name="line-1241"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1242" name="line-1242"></a>
<a id="line-1243" name="line-1243"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">ADDED_ALL</span><span class="p">;</span>
<a id="line-1244" name="line-1244"></a><span class="p">}</span>
<a id="line-1245" name="line-1245"></a>
<a id="line-1246" name="line-1246"></a><span class="k">static</span><span class="w"> </span><span class="n">AddedStatus</span>
<a id="line-1247" name="line-1247"></a><span class="nf">append_first_converted</span><span class="w"> </span><span class="p">(</span><span class="n">GString</span><span class="w">         </span><span class="o">*</span><span class="n">str</span><span class="p">,</span>
<a id="line-1248" name="line-1248"></a><span class="w">			</span><span class="n">ConversionType</span><span class="w">   </span><span class="n">conversion</span><span class="p">,</span>
<a id="line-1249" name="line-1249"></a><span class="w">			</span><span class="n">GSList</span><span class="w">         </span><span class="o">**</span><span class="n">arg_ptr</span><span class="p">,</span>
<a id="line-1250" name="line-1250"></a><span class="w">			</span><span class="n">gboolean</span><span class="w">         </span><span class="n">in_single_quotes</span><span class="p">,</span>
<a id="line-1251" name="line-1251"></a><span class="w">			</span><span class="n">gboolean</span><span class="w">         </span><span class="n">in_double_quotes</span><span class="p">,</span>
<a id="line-1252" name="line-1252"></a><span class="w">			</span><span class="n">AddedStatus</span><span class="w">      </span><span class="n">added_status</span><span class="p">)</span>
<a id="line-1253" name="line-1253"></a><span class="p">{</span>
<a id="line-1254" name="line-1254"></a><span class="w">	</span><span class="n">GSList</span><span class="w"> </span><span class="o">*</span><span class="n">l</span><span class="p">;</span>
<a id="line-1255" name="line-1255"></a><span class="w">	</span><span class="kt">char</span><span class="w">   </span><span class="o">*</span><span class="n">converted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-1256" name="line-1256"></a><span class="w">	</span><span class="kt">char</span><span class="w">   </span><span class="o">*</span><span class="n">escaped</span><span class="p">;</span>
<a id="line-1257" name="line-1257"></a>
<a id="line-1258" name="line-1258"></a><span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">arg_ptr</span><span class="p">;</span><span class="w"> </span><span class="n">l</span><span class="p">;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1259" name="line-1259"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">converted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">convert_uri</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">conversion</span><span class="p">)))</span>
<a id="line-1260" name="line-1260"></a><span class="w">			</span><span class="k">break</span><span class="p">;</span>
<a id="line-1261" name="line-1261"></a>
<a id="line-1262" name="line-1262"></a><span class="w">		</span><span class="o">*</span><span class="n">arg_ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
<a id="line-1263" name="line-1263"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1264" name="line-1264"></a>
<a id="line-1265" name="line-1265"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">converted</span><span class="p">)</span>
<a id="line-1266" name="line-1266"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">added_status</span><span class="p">;</span>
<a id="line-1267" name="line-1267"></a>
<a id="line-1268" name="line-1268"></a><span class="w">	</span><span class="n">escaped</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">escape_single_quotes</span><span class="w"> </span><span class="p">(</span><span class="n">converted</span><span class="p">,</span><span class="w"> </span><span class="n">in_single_quotes</span><span class="p">,</span><span class="w"> </span><span class="n">in_double_quotes</span><span class="p">);</span>
<a id="line-1269" name="line-1269"></a><span class="w">	</span><span class="n">g_string_append</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">escaped</span><span class="p">);</span>
<a id="line-1270" name="line-1270"></a><span class="w">	</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">escaped</span><span class="p">);</span>
<a id="line-1271" name="line-1271"></a><span class="w">	</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">converted</span><span class="p">);</span>
<a id="line-1272" name="line-1272"></a>
<a id="line-1273" name="line-1273"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">added_status</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">ADDED_ALL</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">ADDED_SINGLE</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">added_status</span><span class="p">;</span>
<a id="line-1274" name="line-1274"></a><span class="p">}</span>
<a id="line-1275" name="line-1275"></a>
<a id="line-1276" name="line-1276"></a><span class="k">static</span><span class="w"> </span><span class="n">gboolean</span>
<a id="line-1277" name="line-1277"></a><span class="nf">do_percent_subst</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w">  </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-1278" name="line-1278"></a><span class="w">		  </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w">              </span><span class="o">*</span><span class="n">arg</span><span class="p">,</span>
<a id="line-1279" name="line-1279"></a><span class="w">		  </span><span class="n">GString</span><span class="w">                 </span><span class="o">*</span><span class="n">str</span><span class="p">,</span>
<a id="line-1280" name="line-1280"></a><span class="w">		  </span><span class="n">gboolean</span><span class="w">                 </span><span class="n">in_single_quotes</span><span class="p">,</span>
<a id="line-1281" name="line-1281"></a><span class="w">		  </span><span class="n">gboolean</span><span class="w">                 </span><span class="n">in_double_quotes</span><span class="p">,</span>
<a id="line-1282" name="line-1282"></a><span class="w">		  </span><span class="n">GSList</span><span class="w">                  </span><span class="o">*</span><span class="n">args</span><span class="p">,</span>
<a id="line-1283" name="line-1283"></a><span class="w">		  </span><span class="n">GSList</span><span class="w">                 </span><span class="o">**</span><span class="n">arg_ptr</span><span class="p">,</span>
<a id="line-1284" name="line-1284"></a><span class="w">		  </span><span class="n">AddedStatus</span><span class="w">             </span><span class="o">*</span><span class="n">added_status</span><span class="p">)</span>
<a id="line-1285" name="line-1285"></a><span class="p">{</span>
<a id="line-1286" name="line-1286"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">esc</span><span class="p">;</span>
<a id="line-1287" name="line-1287"></a><span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">cs</span><span class="p">;</span>
<a id="line-1288" name="line-1288"></a>
<a id="line-1289" name="line-1289"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">arg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="sc">&#39;%&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">arg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1290" name="line-1290"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-1291" name="line-1291"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1292" name="line-1292"></a>
<a id="line-1293" name="line-1293"></a><span class="w">	</span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">arg</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<a id="line-1294" name="line-1294"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;%&#39;</span><span class="p">:</span>
<a id="line-1295" name="line-1295"></a><span class="w">		</span><span class="n">g_string_append_c</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;%&#39;</span><span class="p">);</span>
<a id="line-1296" name="line-1296"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-1297" name="line-1297"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;U&#39;</span><span class="p">:</span>
<a id="line-1298" name="line-1298"></a><span class="w">		</span><span class="o">*</span><span class="n">added_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">append_all_converted</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">,</span>
<a id="line-1299" name="line-1299"></a><span class="w">						      </span><span class="n">URI_TO_STRING</span><span class="p">,</span>
<a id="line-1300" name="line-1300"></a><span class="w">						      </span><span class="n">args</span><span class="p">,</span>
<a id="line-1301" name="line-1301"></a><span class="w">						      </span><span class="n">in_single_quotes</span><span class="p">,</span>
<a id="line-1302" name="line-1302"></a><span class="w">						      </span><span class="n">in_double_quotes</span><span class="p">,</span>
<a id="line-1303" name="line-1303"></a><span class="w">						      </span><span class="o">*</span><span class="n">added_status</span><span class="p">);</span>
<a id="line-1304" name="line-1304"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-1305" name="line-1305"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;F&#39;</span><span class="p">:</span>
<a id="line-1306" name="line-1306"></a><span class="w">		</span><span class="o">*</span><span class="n">added_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">append_all_converted</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">,</span>
<a id="line-1307" name="line-1307"></a><span class="w">						      </span><span class="n">URI_TO_LOCAL_PATH</span><span class="p">,</span>
<a id="line-1308" name="line-1308"></a><span class="w">						      </span><span class="n">args</span><span class="p">,</span>
<a id="line-1309" name="line-1309"></a><span class="w">						      </span><span class="n">in_single_quotes</span><span class="p">,</span>
<a id="line-1310" name="line-1310"></a><span class="w">						      </span><span class="n">in_double_quotes</span><span class="p">,</span>
<a id="line-1311" name="line-1311"></a><span class="w">						      </span><span class="o">*</span><span class="n">added_status</span><span class="p">);</span>
<a id="line-1312" name="line-1312"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-1313" name="line-1313"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;N&#39;</span><span class="p">:</span>
<a id="line-1314" name="line-1314"></a><span class="w">		</span><span class="o">*</span><span class="n">added_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">append_all_converted</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">,</span>
<a id="line-1315" name="line-1315"></a><span class="w">						      </span><span class="n">URI_TO_LOCAL_BASENAME</span><span class="p">,</span>
<a id="line-1316" name="line-1316"></a><span class="w">						      </span><span class="n">args</span><span class="p">,</span>
<a id="line-1317" name="line-1317"></a><span class="w">						      </span><span class="n">in_single_quotes</span><span class="p">,</span>
<a id="line-1318" name="line-1318"></a><span class="w">						      </span><span class="n">in_double_quotes</span><span class="p">,</span>
<a id="line-1319" name="line-1319"></a><span class="w">						      </span><span class="o">*</span><span class="n">added_status</span><span class="p">);</span>
<a id="line-1320" name="line-1320"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-1321" name="line-1321"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;D&#39;</span><span class="p">:</span>
<a id="line-1322" name="line-1322"></a><span class="w">		</span><span class="o">*</span><span class="n">added_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">append_all_converted</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">,</span>
<a id="line-1323" name="line-1323"></a><span class="w">						      </span><span class="n">URI_TO_LOCAL_DIRNAME</span><span class="p">,</span>
<a id="line-1324" name="line-1324"></a><span class="w">						      </span><span class="n">args</span><span class="p">,</span>
<a id="line-1325" name="line-1325"></a><span class="w">						      </span><span class="n">in_single_quotes</span><span class="p">,</span>
<a id="line-1326" name="line-1326"></a><span class="w">						      </span><span class="n">in_double_quotes</span><span class="p">,</span>
<a id="line-1327" name="line-1327"></a><span class="w">						      </span><span class="o">*</span><span class="n">added_status</span><span class="p">);</span>
<a id="line-1328" name="line-1328"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-1329" name="line-1329"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;f&#39;</span><span class="p">:</span>
<a id="line-1330" name="line-1330"></a><span class="w">		</span><span class="o">*</span><span class="n">added_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">append_first_converted</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">,</span>
<a id="line-1331" name="line-1331"></a><span class="w">							</span><span class="n">URI_TO_LOCAL_PATH</span><span class="p">,</span>
<a id="line-1332" name="line-1332"></a><span class="w">							</span><span class="n">arg_ptr</span><span class="p">,</span>
<a id="line-1333" name="line-1333"></a><span class="w">							</span><span class="n">in_single_quotes</span><span class="p">,</span>
<a id="line-1334" name="line-1334"></a><span class="w">							</span><span class="n">in_double_quotes</span><span class="p">,</span>
<a id="line-1335" name="line-1335"></a><span class="w">							</span><span class="o">*</span><span class="n">added_status</span><span class="p">);</span>
<a id="line-1336" name="line-1336"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-1337" name="line-1337"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;u&#39;</span><span class="p">:</span>
<a id="line-1338" name="line-1338"></a><span class="w">		</span><span class="o">*</span><span class="n">added_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">append_first_converted</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">,</span>
<a id="line-1339" name="line-1339"></a><span class="w">							</span><span class="n">URI_TO_STRING</span><span class="p">,</span>
<a id="line-1340" name="line-1340"></a><span class="w">							</span><span class="n">arg_ptr</span><span class="p">,</span>
<a id="line-1341" name="line-1341"></a><span class="w">							</span><span class="n">in_single_quotes</span><span class="p">,</span>
<a id="line-1342" name="line-1342"></a><span class="w">							</span><span class="n">in_double_quotes</span><span class="p">,</span>
<a id="line-1343" name="line-1343"></a><span class="w">							</span><span class="o">*</span><span class="n">added_status</span><span class="p">);</span>
<a id="line-1344" name="line-1344"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-1345" name="line-1345"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;d&#39;</span><span class="p">:</span>
<a id="line-1346" name="line-1346"></a><span class="w">		</span><span class="o">*</span><span class="n">added_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">append_first_converted</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">,</span>
<a id="line-1347" name="line-1347"></a><span class="w">							</span><span class="n">URI_TO_LOCAL_DIRNAME</span><span class="p">,</span>
<a id="line-1348" name="line-1348"></a><span class="w">							</span><span class="n">arg_ptr</span><span class="p">,</span>
<a id="line-1349" name="line-1349"></a><span class="w">							</span><span class="n">in_single_quotes</span><span class="p">,</span>
<a id="line-1350" name="line-1350"></a><span class="w">							</span><span class="n">in_double_quotes</span><span class="p">,</span>
<a id="line-1351" name="line-1351"></a><span class="w">							</span><span class="o">*</span><span class="n">added_status</span><span class="p">);</span>
<a id="line-1352" name="line-1352"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-1353" name="line-1353"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;n&#39;</span><span class="p">:</span>
<a id="line-1354" name="line-1354"></a><span class="w">		</span><span class="o">*</span><span class="n">added_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">append_first_converted</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">,</span>
<a id="line-1355" name="line-1355"></a><span class="w">							</span><span class="n">URI_TO_LOCAL_BASENAME</span><span class="p">,</span>
<a id="line-1356" name="line-1356"></a><span class="w">							</span><span class="n">arg_ptr</span><span class="p">,</span>
<a id="line-1357" name="line-1357"></a><span class="w">							</span><span class="n">in_single_quotes</span><span class="p">,</span>
<a id="line-1358" name="line-1358"></a><span class="w">							</span><span class="n">in_double_quotes</span><span class="p">,</span>
<a id="line-1359" name="line-1359"></a><span class="w">							</span><span class="o">*</span><span class="n">added_status</span><span class="p">);</span>
<a id="line-1360" name="line-1360"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-1361" name="line-1361"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;m&#39;</span><span class="p">:</span>
<a id="line-1362" name="line-1362"></a><span class="w">		</span><span class="cm">/* Note: v0.9.4 of the spec says this is deprecated</span>
<a id="line-1363" name="line-1363"></a><span class="cm">		 * and replace with --miniicon iconname */</span>
<a id="line-1364" name="line-1364"></a><span class="w">		</span><span class="n">cs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mate_desktop_item_get_string</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_MINI_ICON</span><span class="p">);</span>
<a id="line-1365" name="line-1365"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cs</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1366" name="line-1366"></a><span class="w">			</span><span class="n">g_string_append</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;--miniicon=&quot;</span><span class="p">);</span>
<a id="line-1367" name="line-1367"></a><span class="w">			</span><span class="n">esc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">escape_single_quotes</span><span class="w"> </span><span class="p">(</span><span class="n">cs</span><span class="p">,</span><span class="w"> </span><span class="n">in_single_quotes</span><span class="p">,</span><span class="w"> </span><span class="n">in_double_quotes</span><span class="p">);</span>
<a id="line-1368" name="line-1368"></a><span class="w">			</span><span class="n">g_string_append</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">esc</span><span class="p">);</span>
<a id="line-1369" name="line-1369"></a><span class="w">		</span><span class="p">}</span>
<a id="line-1370" name="line-1370"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-1371" name="line-1371"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;i&#39;</span><span class="p">:</span>
<a id="line-1372" name="line-1372"></a><span class="w">		</span><span class="cm">/* Note: v0.9.4 of the spec says replace with --icon iconname */</span>
<a id="line-1373" name="line-1373"></a><span class="w">		</span><span class="n">cs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mate_desktop_item_get_string</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_ICON</span><span class="p">);</span>
<a id="line-1374" name="line-1374"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cs</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1375" name="line-1375"></a><span class="w">			</span><span class="n">g_string_append</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;--icon=&quot;</span><span class="p">);</span>
<a id="line-1376" name="line-1376"></a><span class="w">			</span><span class="n">esc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">escape_single_quotes</span><span class="w"> </span><span class="p">(</span><span class="n">cs</span><span class="p">,</span><span class="w"> </span><span class="n">in_single_quotes</span><span class="p">,</span><span class="w"> </span><span class="n">in_double_quotes</span><span class="p">);</span>
<a id="line-1377" name="line-1377"></a><span class="w">			</span><span class="n">g_string_append</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">esc</span><span class="p">);</span>
<a id="line-1378" name="line-1378"></a><span class="w">		</span><span class="p">}</span>
<a id="line-1379" name="line-1379"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-1380" name="line-1380"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;c&#39;</span><span class="p">:</span>
<a id="line-1381" name="line-1381"></a><span class="w">		</span><span class="n">cs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mate_desktop_item_get_localestring</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_NAME</span><span class="p">);</span>
<a id="line-1382" name="line-1382"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cs</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1383" name="line-1383"></a><span class="w">			</span><span class="n">esc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">escape_single_quotes</span><span class="w"> </span><span class="p">(</span><span class="n">cs</span><span class="p">,</span><span class="w"> </span><span class="n">in_single_quotes</span><span class="p">,</span><span class="w"> </span><span class="n">in_double_quotes</span><span class="p">);</span>
<a id="line-1384" name="line-1384"></a><span class="w">			</span><span class="n">g_string_append</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">esc</span><span class="p">);</span>
<a id="line-1385" name="line-1385"></a><span class="w">			</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">esc</span><span class="p">);</span>
<a id="line-1386" name="line-1386"></a><span class="w">		</span><span class="p">}</span>
<a id="line-1387" name="line-1387"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-1388" name="line-1388"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;k&#39;</span><span class="p">:</span>
<a id="line-1389" name="line-1389"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">location</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1390" name="line-1390"></a><span class="w">			</span><span class="n">esc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">escape_single_quotes</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">location</span><span class="p">,</span><span class="w"> </span><span class="n">in_single_quotes</span><span class="p">,</span><span class="w"> </span><span class="n">in_double_quotes</span><span class="p">);</span>
<a id="line-1391" name="line-1391"></a><span class="w">			</span><span class="n">g_string_append</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">esc</span><span class="p">);</span>
<a id="line-1392" name="line-1392"></a><span class="w">			</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">esc</span><span class="p">);</span>
<a id="line-1393" name="line-1393"></a><span class="w">		</span><span class="p">}</span>
<a id="line-1394" name="line-1394"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-1395" name="line-1395"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;v&#39;</span><span class="p">:</span>
<a id="line-1396" name="line-1396"></a><span class="w">		</span><span class="n">cs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mate_desktop_item_get_localestring</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_DEV</span><span class="p">);</span>
<a id="line-1397" name="line-1397"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cs</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1398" name="line-1398"></a><span class="w">			</span><span class="n">esc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">escape_single_quotes</span><span class="w"> </span><span class="p">(</span><span class="n">cs</span><span class="p">,</span><span class="w"> </span><span class="n">in_single_quotes</span><span class="p">,</span><span class="w"> </span><span class="n">in_double_quotes</span><span class="p">);</span>
<a id="line-1399" name="line-1399"></a><span class="w">			</span><span class="n">g_string_append</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">esc</span><span class="p">);</span>
<a id="line-1400" name="line-1400"></a><span class="w">			</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">esc</span><span class="p">);</span>
<a id="line-1401" name="line-1401"></a><span class="w">		</span><span class="p">}</span>
<a id="line-1402" name="line-1402"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-1403" name="line-1403"></a><span class="w">	</span><span class="k">default</span><span class="o">:</span>
<a id="line-1404" name="line-1404"></a><span class="w">		</span><span class="cm">/* Maintain special characters - e.g. &quot;%20&quot; */</span>
<a id="line-1405" name="line-1405"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">g_ascii_isdigit</span><span class="w"> </span><span class="p">(</span><span class="n">arg</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<a id="line-1406" name="line-1406"></a><span class="w">			</span><span class="n">g_string_append_c</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;%&#39;</span><span class="p">);</span>
<a id="line-1407" name="line-1407"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-1408" name="line-1408"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1409" name="line-1409"></a>
<a id="line-1410" name="line-1410"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
<a id="line-1411" name="line-1411"></a><span class="p">}</span>
<a id="line-1412" name="line-1412"></a>
<a id="line-1413" name="line-1413"></a><span class="k">static</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span>
<a id="line-1414" name="line-1414"></a><span class="nf">expand_string</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w">  </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-1415" name="line-1415"></a><span class="w">	       </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w">              </span><span class="o">*</span><span class="n">s</span><span class="p">,</span>
<a id="line-1416" name="line-1416"></a><span class="w">	       </span><span class="n">GSList</span><span class="w">                  </span><span class="o">*</span><span class="n">args</span><span class="p">,</span>
<a id="line-1417" name="line-1417"></a><span class="w">	       </span><span class="n">GSList</span><span class="w">                 </span><span class="o">**</span><span class="n">arg_ptr</span><span class="p">,</span>
<a id="line-1418" name="line-1418"></a><span class="w">	       </span><span class="n">AddedStatus</span><span class="w">             </span><span class="o">*</span><span class="n">added_status</span><span class="p">)</span>
<a id="line-1419" name="line-1419"></a><span class="p">{</span>
<a id="line-1420" name="line-1420"></a><span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">;</span>
<a id="line-1421" name="line-1421"></a><span class="w">	</span><span class="n">gboolean</span><span class="w"> </span><span class="n">escape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-1422" name="line-1422"></a><span class="w">	</span><span class="n">gboolean</span><span class="w"> </span><span class="n">single_quot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-1423" name="line-1423"></a><span class="w">	</span><span class="n">gboolean</span><span class="w"> </span><span class="n">double_quot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-1424" name="line-1424"></a><span class="w">	</span><span class="n">GString</span><span class="w"> </span><span class="o">*</span><span class="n">gs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_string_new</span><span class="w"> </span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-1425" name="line-1425"></a>
<a id="line-1426" name="line-1426"></a><span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">;</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">;</span><span class="w"> </span><span class="n">p</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1427" name="line-1427"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">escape</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1428" name="line-1428"></a><span class="w">			</span><span class="n">escape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-1429" name="line-1429"></a><span class="w">			</span><span class="n">g_string_append_c</span><span class="w"> </span><span class="p">(</span><span class="n">gs</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">);</span>
<a id="line-1430" name="line-1430"></a><span class="w">		</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;\\&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1431" name="line-1431"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="n">single_quot</span><span class="p">)</span>
<a id="line-1432" name="line-1432"></a><span class="w">				</span><span class="n">escape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
<a id="line-1433" name="line-1433"></a><span class="w">			</span><span class="n">g_string_append_c</span><span class="w"> </span><span class="p">(</span><span class="n">gs</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">);</span>
<a id="line-1434" name="line-1434"></a><span class="w">		</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;\&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1435" name="line-1435"></a><span class="w">			</span><span class="n">g_string_append_c</span><span class="w"> </span><span class="p">(</span><span class="n">gs</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">);</span>
<a id="line-1436" name="line-1436"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="n">single_quot</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="n">double_quot</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1437" name="line-1437"></a><span class="w">				</span><span class="n">single_quot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
<a id="line-1438" name="line-1438"></a><span class="w">			</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">single_quot</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1439" name="line-1439"></a><span class="w">				</span><span class="n">single_quot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-1440" name="line-1440"></a><span class="w">			</span><span class="p">}</span>
<a id="line-1441" name="line-1441"></a><span class="w">		</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1442" name="line-1442"></a><span class="w">			</span><span class="n">g_string_append_c</span><span class="w"> </span><span class="p">(</span><span class="n">gs</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">);</span>
<a id="line-1443" name="line-1443"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="n">single_quot</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="n">double_quot</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1444" name="line-1444"></a><span class="w">				</span><span class="n">double_quot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
<a id="line-1445" name="line-1445"></a><span class="w">			</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">double_quot</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1446" name="line-1446"></a><span class="w">				</span><span class="n">double_quot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-1447" name="line-1447"></a><span class="w">			</span><span class="p">}</span>
<a id="line-1448" name="line-1448"></a><span class="w">		</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;%&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1449" name="line-1449"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">do_percent_subst</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">gs</span><span class="p">,</span>
<a id="line-1450" name="line-1450"></a><span class="w">					      </span><span class="n">single_quot</span><span class="p">,</span><span class="w"> </span><span class="n">double_quot</span><span class="p">,</span>
<a id="line-1451" name="line-1451"></a><span class="w">					      </span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">arg_ptr</span><span class="p">,</span>
<a id="line-1452" name="line-1452"></a><span class="w">					      </span><span class="n">added_status</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="line-1453" name="line-1453"></a><span class="w">				</span><span class="n">p</span><span class="o">++</span><span class="p">;</span>
<a id="line-1454" name="line-1454"></a><span class="w">			</span><span class="p">}</span>
<a id="line-1455" name="line-1455"></a><span class="w">		</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-1456" name="line-1456"></a><span class="w">			</span><span class="n">g_string_append_c</span><span class="w"> </span><span class="p">(</span><span class="n">gs</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">);</span>
<a id="line-1457" name="line-1457"></a><span class="w">		</span><span class="p">}</span>
<a id="line-1458" name="line-1458"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1459" name="line-1459"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">g_string_free</span><span class="w"> </span><span class="p">(</span><span class="n">gs</span><span class="p">,</span><span class="w"> </span><span class="n">FALSE</span><span class="p">);</span>
<a id="line-1460" name="line-1460"></a><span class="p">}</span>
<a id="line-1461" name="line-1461"></a>
<a id="line-1462" name="line-1462"></a><span class="cm">/*Functions in this code block should only ever be reached in x11*/</span>
<a id="line-1463" name="line-1463"></a><span class="cp">#ifdef HAVE_STARTUP_NOTIFICATION</span>
<a id="line-1464" name="line-1464"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<a id="line-1465" name="line-1465"></a><span class="nf">sn_error_trap_push</span><span class="w"> </span><span class="p">(</span><span class="n">SnDisplay</span><span class="w"> </span><span class="o">*</span><span class="n">display</span><span class="p">,</span>
<a id="line-1466" name="line-1466"></a><span class="w">		    </span><span class="n">Display</span><span class="w">   </span><span class="o">*</span><span class="n">xdisplay</span><span class="p">)</span>
<a id="line-1467" name="line-1467"></a><span class="p">{</span>
<a id="line-1468" name="line-1468"></a><span class="w">	</span><span class="n">GdkDisplay</span><span class="w"> </span><span class="o">*</span><span class="n">gdkdisplay</span><span class="p">;</span>
<a id="line-1469" name="line-1469"></a>
<a id="line-1470" name="line-1470"></a><span class="w">	</span><span class="n">gdkdisplay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gdk_display_get_default</span><span class="w"> </span><span class="p">();</span>
<a id="line-1471" name="line-1471"></a><span class="w">	</span><span class="n">gdk_x11_display_error_trap_push</span><span class="w"> </span><span class="p">(</span><span class="n">gdkdisplay</span><span class="p">);</span>
<a id="line-1472" name="line-1472"></a><span class="p">}</span>
<a id="line-1473" name="line-1473"></a>
<a id="line-1474" name="line-1474"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<a id="line-1475" name="line-1475"></a><span class="nf">sn_error_trap_pop</span><span class="w"> </span><span class="p">(</span><span class="n">SnDisplay</span><span class="w"> </span><span class="o">*</span><span class="n">display</span><span class="p">,</span>
<a id="line-1476" name="line-1476"></a><span class="w">		   </span><span class="n">Display</span><span class="w">   </span><span class="o">*</span><span class="n">xdisplay</span><span class="p">)</span>
<a id="line-1477" name="line-1477"></a><span class="p">{</span>
<a id="line-1478" name="line-1478"></a><span class="w">	</span><span class="n">GdkDisplay</span><span class="w"> </span><span class="o">*</span><span class="n">gdkdisplay</span><span class="p">;</span>
<a id="line-1479" name="line-1479"></a>
<a id="line-1480" name="line-1480"></a><span class="w">	</span><span class="n">gdkdisplay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gdk_display_get_default</span><span class="w"> </span><span class="p">();</span>
<a id="line-1481" name="line-1481"></a><span class="w">	</span><span class="n">gdk_x11_display_error_trap_pop_ignored</span><span class="w"> </span><span class="p">(</span><span class="n">gdkdisplay</span><span class="p">);</span>
<a id="line-1482" name="line-1482"></a><span class="p">}</span>
<a id="line-1483" name="line-1483"></a>
<a id="line-1484" name="line-1484"></a><span class="k">static</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span>
<a id="line-1485" name="line-1485"></a><span class="nf">make_spawn_environment_for_sn_context</span><span class="w"> </span><span class="p">(</span><span class="n">SnLauncherContext</span><span class="w"> </span><span class="o">*</span><span class="n">sn_context</span><span class="p">,</span>
<a id="line-1486" name="line-1486"></a><span class="w">				       </span><span class="kt">char</span><span class="w">             </span><span class="o">**</span><span class="n">envp</span><span class="p">)</span>
<a id="line-1487" name="line-1487"></a><span class="p">{</span>
<a id="line-1488" name="line-1488"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">retval</span><span class="p">;</span>
<a id="line-1489" name="line-1489"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">freeme</span><span class="p">;</span>
<a id="line-1490" name="line-1490"></a><span class="w">	</span><span class="kt">int</span><span class="w">    </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>
<a id="line-1491" name="line-1491"></a><span class="w">	</span><span class="kt">int</span><span class="w">    </span><span class="n">desktop_startup_id_len</span><span class="p">;</span>
<a id="line-1492" name="line-1492"></a>
<a id="line-1493" name="line-1493"></a><span class="w">	</span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">freeme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-1494" name="line-1494"></a>
<a id="line-1495" name="line-1495"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">envp</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1496" name="line-1496"></a><span class="w">		</span><span class="n">envp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">freeme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_listenv</span><span class="w"> </span><span class="p">();</span>
<a id="line-1497" name="line-1497"></a><span class="w">		</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">envp</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1498" name="line-1498"></a><span class="w">			</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">envp</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="line-1499" name="line-1499"></a>
<a id="line-1500" name="line-1500"></a><span class="w">			</span><span class="n">envp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strjoin</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;=&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">g_getenv</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="p">),</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-1501" name="line-1501"></a><span class="w">			</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<a id="line-1502" name="line-1502"></a><span class="w">		</span><span class="p">}</span>
<a id="line-1503" name="line-1503"></a><span class="w">	</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-1504" name="line-1504"></a><span class="w">		</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">envp</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<a id="line-1505" name="line-1505"></a><span class="w">			</span><span class="p">;</span>
<a id="line-1506" name="line-1506"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1507" name="line-1507"></a>
<a id="line-1508" name="line-1508"></a><span class="w">	</span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_new</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<a id="line-1509" name="line-1509"></a>
<a id="line-1510" name="line-1510"></a><span class="w">	</span><span class="n">desktop_startup_id_len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strlen</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;DESKTOP_STARTUP_ID&quot;</span><span class="p">);</span>
<a id="line-1511" name="line-1511"></a>
<a id="line-1512" name="line-1512"></a><span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">envp</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1513" name="line-1513"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">strncmp</span><span class="w"> </span><span class="p">(</span><span class="n">envp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="s">&quot;DESKTOP_STARTUP_ID&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">desktop_startup_id_len</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1514" name="line-1514"></a><span class="w">			</span><span class="n">retval</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">envp</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<a id="line-1515" name="line-1515"></a><span class="w">			</span><span class="o">++</span><span class="n">j</span><span class="p">;</span>
<a id="line-1516" name="line-1516"></a><span class="w">	        </span><span class="p">}</span>
<a id="line-1517" name="line-1517"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1518" name="line-1518"></a>
<a id="line-1519" name="line-1519"></a><span class="w">	</span><span class="n">retval</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup_printf</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;DESKTOP_STARTUP_ID=%s&quot;</span><span class="p">,</span>
<a id="line-1520" name="line-1520"></a><span class="w">				     </span><span class="n">sn_launcher_context_get_startup_id</span><span class="w"> </span><span class="p">(</span><span class="n">sn_context</span><span class="p">));</span>
<a id="line-1521" name="line-1521"></a><span class="w">	</span><span class="o">++</span><span class="n">j</span><span class="p">;</span>
<a id="line-1522" name="line-1522"></a><span class="w">	</span><span class="n">retval</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-1523" name="line-1523"></a>
<a id="line-1524" name="line-1524"></a><span class="w">	</span><span class="n">g_strfreev</span><span class="w"> </span><span class="p">(</span><span class="n">freeme</span><span class="p">);</span>
<a id="line-1525" name="line-1525"></a>
<a id="line-1526" name="line-1526"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">retval</span><span class="p">;</span>
<a id="line-1527" name="line-1527"></a><span class="p">}</span>
<a id="line-1528" name="line-1528"></a>
<a id="line-1529" name="line-1529"></a><span class="cm">/* This should be fairly long, as it&#39;s confusing to users if a startup</span>
<a id="line-1530" name="line-1530"></a><span class="cm"> * ends when it shouldn&#39;t (it appears that the startup failed, and</span>
<a id="line-1531" name="line-1531"></a><span class="cm"> * they have to relaunch the app). Also the timeout only matters when</span>
<a id="line-1532" name="line-1532"></a><span class="cm"> * there are bugs and apps don&#39;t end their own startup sequence.</span>
<a id="line-1533" name="line-1533"></a><span class="cm"> *</span>
<a id="line-1534" name="line-1534"></a><span class="cm"> * This timeout is a &quot;last resort&quot; timeout that ignores whether the</span>
<a id="line-1535" name="line-1535"></a><span class="cm"> * startup sequence has shown activity or not.  Marco and the</span>
<a id="line-1536" name="line-1536"></a><span class="cm"> * tasklist have smarter, and correspondingly able-to-be-shorter</span>
<a id="line-1537" name="line-1537"></a><span class="cm"> * timeouts. The reason our timeout is dumb is that we don&#39;t monitor</span>
<a id="line-1538" name="line-1538"></a><span class="cm"> * the sequence (don&#39;t use an SnMonitorContext)</span>
<a id="line-1539" name="line-1539"></a><span class="cm"> */</span>
<a id="line-1540" name="line-1540"></a><span class="cp">#define STARTUP_TIMEOUT_LENGTH_SEC 30 </span><span class="cm">/* seconds */</span>
<a id="line-1541" name="line-1541"></a><span class="cp">#define STARTUP_TIMEOUT_LENGTH (STARTUP_TIMEOUT_LENGTH_SEC * 1000)</span>
<a id="line-1542" name="line-1542"></a>
<a id="line-1543" name="line-1543"></a><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span>
<a id="line-1544" name="line-1544"></a><span class="p">{</span>
<a id="line-1545" name="line-1545"></a><span class="w">	</span><span class="n">GdkScreen</span><span class="w"> </span><span class="o">*</span><span class="n">screen</span><span class="p">;</span>
<a id="line-1546" name="line-1546"></a><span class="w">	</span><span class="n">GSList</span><span class="w"> </span><span class="o">*</span><span class="n">contexts</span><span class="p">;</span>
<a id="line-1547" name="line-1547"></a><span class="w">	</span><span class="n">guint</span><span class="w"> </span><span class="n">timeout_id</span><span class="p">;</span>
<a id="line-1548" name="line-1548"></a><span class="p">}</span><span class="w"> </span><span class="n">StartupTimeoutData</span><span class="p">;</span>
<a id="line-1549" name="line-1549"></a>
<a id="line-1550" name="line-1550"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<a id="line-1551" name="line-1551"></a><span class="nf">free_startup_timeout</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">)</span>
<a id="line-1552" name="line-1552"></a><span class="p">{</span>
<a id="line-1553" name="line-1553"></a><span class="w">	</span><span class="n">StartupTimeoutData</span><span class="w"> </span><span class="o">*</span><span class="n">std</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">;</span>
<a id="line-1554" name="line-1554"></a>
<a id="line-1555" name="line-1555"></a><span class="w">	</span><span class="n">g_slist_free_full</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">-&gt;</span><span class="n">contexts</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">GDestroyNotify</span><span class="p">)</span><span class="w"> </span><span class="n">sn_launcher_context_unref</span><span class="p">);</span>
<a id="line-1556" name="line-1556"></a>
<a id="line-1557" name="line-1557"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">-&gt;</span><span class="n">timeout_id</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1558" name="line-1558"></a><span class="w">		</span><span class="n">g_source_remove</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">-&gt;</span><span class="n">timeout_id</span><span class="p">);</span>
<a id="line-1559" name="line-1559"></a><span class="w">		</span><span class="n">std</span><span class="o">-&gt;</span><span class="n">timeout_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="line-1560" name="line-1560"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1561" name="line-1561"></a>
<a id="line-1562" name="line-1562"></a><span class="w">	</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="p">);</span>
<a id="line-1563" name="line-1563"></a><span class="p">}</span>
<a id="line-1564" name="line-1564"></a>
<a id="line-1565" name="line-1565"></a><span class="k">static</span><span class="w"> </span><span class="n">gboolean</span>
<a id="line-1566" name="line-1566"></a><span class="nf">startup_timeout</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">)</span>
<a id="line-1567" name="line-1567"></a><span class="p">{</span>
<a id="line-1568" name="line-1568"></a><span class="w">	</span><span class="n">StartupTimeoutData</span><span class="w"> </span><span class="o">*</span><span class="n">std</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">;</span>
<a id="line-1569" name="line-1569"></a><span class="w">	</span><span class="n">GSList</span><span class="w"> </span><span class="o">*</span><span class="n">tmp</span><span class="p">;</span>
<a id="line-1570" name="line-1570"></a><span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">min_timeout</span><span class="p">;</span>
<a id="line-1571" name="line-1571"></a>
<a id="line-1572" name="line-1572"></a><span class="w">	</span><span class="n">min_timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">STARTUP_TIMEOUT_LENGTH</span><span class="p">;</span>
<a id="line-1573" name="line-1573"></a>
<a id="line-1574" name="line-1574"></a><span class="cp">#if GLIB_CHECK_VERSION(2,61,2)</span>
<a id="line-1575" name="line-1575"></a><span class="w">	</span><span class="n">gint64</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_get_real_time</span><span class="w"> </span><span class="p">();</span>
<a id="line-1576" name="line-1576"></a><span class="cp">#else</span>
<a id="line-1577" name="line-1577"></a><span class="w">	</span><span class="n">GTimeVal</span><span class="w"> </span><span class="n">now</span><span class="p">;</span>
<a id="line-1578" name="line-1578"></a><span class="w">	</span><span class="n">g_get_current_time</span><span class="w"> </span><span class="p">(</span><span class="o">&amp;</span><span class="n">now</span><span class="p">);</span>
<a id="line-1579" name="line-1579"></a><span class="cp">#endif</span>
<a id="line-1580" name="line-1580"></a>
<a id="line-1581" name="line-1581"></a><span class="w">	</span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">-&gt;</span><span class="n">contexts</span><span class="p">;</span>
<a id="line-1582" name="line-1582"></a><span class="w">	</span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">tmp</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1583" name="line-1583"></a><span class="w">		</span><span class="n">SnLauncherContext</span><span class="w"> </span><span class="o">*</span><span class="n">sn_context</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmp</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
<a id="line-1584" name="line-1584"></a><span class="w">		</span><span class="n">GSList</span><span class="w"> </span><span class="o">*</span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmp</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
<a id="line-1585" name="line-1585"></a><span class="w">		</span><span class="kt">double</span><span class="w"> </span><span class="n">elapsed</span><span class="p">;</span>
<a id="line-1586" name="line-1586"></a>
<a id="line-1587" name="line-1587"></a><span class="cp">#if GLIB_CHECK_VERSION(2,61,2)</span>
<a id="line-1588" name="line-1588"></a><span class="w">		</span><span class="kt">time_t</span><span class="w"> </span><span class="n">tv_sec</span><span class="p">;</span>
<a id="line-1589" name="line-1589"></a><span class="w">		</span><span class="n">suseconds_t</span><span class="w"> </span><span class="n">tv_usec</span><span class="p">;</span>
<a id="line-1590" name="line-1590"></a><span class="w">		</span><span class="n">gint64</span><span class="w"> </span><span class="n">tv</span><span class="p">;</span>
<a id="line-1591" name="line-1591"></a>
<a id="line-1592" name="line-1592"></a><span class="w">		</span><span class="n">sn_launcher_context_get_last_active_time</span><span class="w"> </span><span class="p">(</span><span class="n">sn_context</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tv_sec</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tv_usec</span><span class="p">);</span>
<a id="line-1593" name="line-1593"></a><span class="w">		</span><span class="n">tv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">tv_sec</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">G_USEC_PER_SEC</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tv_usec</span><span class="p">;</span>
<a id="line-1594" name="line-1594"></a><span class="w">		</span><span class="n">elapsed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">now</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tv</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1000.0</span><span class="p">;</span>
<a id="line-1595" name="line-1595"></a><span class="cp">#else</span>
<a id="line-1596" name="line-1596"></a><span class="w">		</span><span class="kt">long</span><span class="w"> </span><span class="n">tv_sec</span><span class="p">,</span><span class="w"> </span><span class="n">tv_usec</span><span class="p">;</span>
<a id="line-1597" name="line-1597"></a>
<a id="line-1598" name="line-1598"></a><span class="w">		</span><span class="n">sn_launcher_context_get_last_active_time</span><span class="w"> </span><span class="p">(</span><span class="n">sn_context</span><span class="p">,</span>
<a id="line-1599" name="line-1599"></a><span class="w">							  </span><span class="o">&amp;</span><span class="n">tv_sec</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tv_usec</span><span class="p">);</span>
<a id="line-1600" name="line-1600"></a>
<a id="line-1601" name="line-1601"></a><span class="w">		</span><span class="n">elapsed</span><span class="w"> </span><span class="o">=</span>
<a id="line-1602" name="line-1602"></a><span class="w">			</span><span class="p">((((</span><span class="kt">double</span><span class="p">)</span><span class="n">now</span><span class="p">.</span><span class="n">tv_sec</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tv_sec</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">G_USEC_PER_SEC</span><span class="w"> </span><span class="o">+</span>
<a id="line-1603" name="line-1603"></a><span class="w">			  </span><span class="p">(</span><span class="n">now</span><span class="p">.</span><span class="n">tv_usec</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tv_usec</span><span class="p">)))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1000.0</span><span class="p">;</span>
<a id="line-1604" name="line-1604"></a><span class="cp">#endif</span>
<a id="line-1605" name="line-1605"></a>
<a id="line-1606" name="line-1606"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">elapsed</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">STARTUP_TIMEOUT_LENGTH</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1607" name="line-1607"></a><span class="w">			</span><span class="n">std</span><span class="o">-&gt;</span><span class="n">contexts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_slist_remove</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">-&gt;</span><span class="n">contexts</span><span class="p">,</span>
<a id="line-1608" name="line-1608"></a><span class="w">							</span><span class="n">sn_context</span><span class="p">);</span>
<a id="line-1609" name="line-1609"></a><span class="w">			</span><span class="n">sn_launcher_context_complete</span><span class="w"> </span><span class="p">(</span><span class="n">sn_context</span><span class="p">);</span>
<a id="line-1610" name="line-1610"></a><span class="w">			</span><span class="n">sn_launcher_context_unref</span><span class="w"> </span><span class="p">(</span><span class="n">sn_context</span><span class="p">);</span>
<a id="line-1611" name="line-1611"></a><span class="w">		</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-1612" name="line-1612"></a><span class="w">			</span><span class="n">min_timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MIN</span><span class="w"> </span><span class="p">(</span><span class="n">min_timeout</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">STARTUP_TIMEOUT_LENGTH</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">elapsed</span><span class="p">));</span>
<a id="line-1613" name="line-1613"></a><span class="w">		</span><span class="p">}</span>
<a id="line-1614" name="line-1614"></a>
<a id="line-1615" name="line-1615"></a><span class="w">		</span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">next</span><span class="p">;</span>
<a id="line-1616" name="line-1616"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1617" name="line-1617"></a>
<a id="line-1618" name="line-1618"></a><span class="w">	</span><span class="cm">/* we&#39;ll use seconds for the timeout */</span>
<a id="line-1619" name="line-1619"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">min_timeout</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1000</span><span class="p">)</span>
<a id="line-1620" name="line-1620"></a><span class="w">		</span><span class="n">min_timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1000</span><span class="p">;</span>
<a id="line-1621" name="line-1621"></a>
<a id="line-1622" name="line-1622"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">-&gt;</span><span class="n">contexts</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1623" name="line-1623"></a><span class="w">		</span><span class="n">std</span><span class="o">-&gt;</span><span class="n">timeout_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="line-1624" name="line-1624"></a><span class="w">	</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-1625" name="line-1625"></a><span class="w">		</span><span class="n">std</span><span class="o">-&gt;</span><span class="n">timeout_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_timeout_add_seconds</span><span class="w"> </span><span class="p">(</span><span class="n">min_timeout</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span>
<a id="line-1626" name="line-1626"></a><span class="w">							 </span><span class="n">startup_timeout</span><span class="p">,</span>
<a id="line-1627" name="line-1627"></a><span class="w">							 </span><span class="n">std</span><span class="p">);</span>
<a id="line-1628" name="line-1628"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1629" name="line-1629"></a>
<a id="line-1630" name="line-1630"></a><span class="w">	</span><span class="cm">/* always remove this one, but we may have reinstalled another one. */</span>
<a id="line-1631" name="line-1631"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-1632" name="line-1632"></a><span class="p">}</span>
<a id="line-1633" name="line-1633"></a>
<a id="line-1634" name="line-1634"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<a id="line-1635" name="line-1635"></a><span class="nf">add_startup_timeout</span><span class="w"> </span><span class="p">(</span><span class="n">GdkScreen</span><span class="w">         </span><span class="o">*</span><span class="n">screen</span><span class="p">,</span>
<a id="line-1636" name="line-1636"></a><span class="w">		     </span><span class="n">SnLauncherContext</span><span class="w"> </span><span class="o">*</span><span class="n">sn_context</span><span class="p">)</span>
<a id="line-1637" name="line-1637"></a><span class="p">{</span>
<a id="line-1638" name="line-1638"></a><span class="w">	</span><span class="n">StartupTimeoutData</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">;</span>
<a id="line-1639" name="line-1639"></a>
<a id="line-1640" name="line-1640"></a><span class="w">	</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_object_get_data</span><span class="w"> </span><span class="p">(</span><span class="n">G_OBJECT</span><span class="w"> </span><span class="p">(</span><span class="n">screen</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;mate-startup-data&quot;</span><span class="p">);</span>
<a id="line-1641" name="line-1641"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1642" name="line-1642"></a><span class="w">		</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_new</span><span class="w"> </span><span class="p">(</span><span class="n">StartupTimeoutData</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="line-1643" name="line-1643"></a><span class="w">		</span><span class="n">data</span><span class="o">-&gt;</span><span class="n">screen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">screen</span><span class="p">;</span>
<a id="line-1644" name="line-1644"></a><span class="w">		</span><span class="n">data</span><span class="o">-&gt;</span><span class="n">contexts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-1645" name="line-1645"></a><span class="w">		</span><span class="n">data</span><span class="o">-&gt;</span><span class="n">timeout_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="line-1646" name="line-1646"></a>
<a id="line-1647" name="line-1647"></a><span class="w">		</span><span class="n">g_object_set_data_full</span><span class="w"> </span><span class="p">(</span><span class="n">G_OBJECT</span><span class="w"> </span><span class="p">(</span><span class="n">screen</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;mate-startup-data&quot;</span><span class="p">,</span>
<a id="line-1648" name="line-1648"></a><span class="w">					</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">free_startup_timeout</span><span class="p">);</span>
<a id="line-1649" name="line-1649"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1650" name="line-1650"></a>
<a id="line-1651" name="line-1651"></a><span class="w">	</span><span class="n">sn_launcher_context_ref</span><span class="w"> </span><span class="p">(</span><span class="n">sn_context</span><span class="p">);</span>
<a id="line-1652" name="line-1652"></a><span class="w">	</span><span class="n">data</span><span class="o">-&gt;</span><span class="n">contexts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_slist_prepend</span><span class="w"> </span><span class="p">(</span><span class="n">data</span><span class="o">-&gt;</span><span class="n">contexts</span><span class="p">,</span><span class="w"> </span><span class="n">sn_context</span><span class="p">);</span>
<a id="line-1653" name="line-1653"></a>
<a id="line-1654" name="line-1654"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">data</span><span class="o">-&gt;</span><span class="n">timeout_id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1655" name="line-1655"></a><span class="w">		</span><span class="n">data</span><span class="o">-&gt;</span><span class="n">timeout_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_timeout_add_seconds</span><span class="w"> </span><span class="p">(</span>
<a id="line-1656" name="line-1656"></a><span class="w">						</span><span class="n">STARTUP_TIMEOUT_LENGTH_SEC</span><span class="p">,</span>
<a id="line-1657" name="line-1657"></a><span class="w">						</span><span class="n">startup_timeout</span><span class="p">,</span>
<a id="line-1658" name="line-1658"></a><span class="w">						</span><span class="n">data</span><span class="p">);</span>
<a id="line-1659" name="line-1659"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1660" name="line-1660"></a><span class="p">}</span>
<a id="line-1661" name="line-1661"></a><span class="cp">#endif </span><span class="cm">/* HAVE_STARTUP_NOTIFICATION - functions should only be reached in x11*/</span>
<a id="line-1662" name="line-1662"></a>
<a id="line-1663" name="line-1663"></a><span class="k">static</span><span class="w"> </span><span class="kr">inline</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span>
<a id="line-1664" name="line-1664"></a><span class="nf">stringify_uris</span><span class="w"> </span><span class="p">(</span><span class="n">GSList</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<a id="line-1665" name="line-1665"></a><span class="p">{</span>
<a id="line-1666" name="line-1666"></a><span class="w">	</span><span class="n">GString</span><span class="w"> </span><span class="o">*</span><span class="n">str</span><span class="p">;</span>
<a id="line-1667" name="line-1667"></a>
<a id="line-1668" name="line-1668"></a><span class="w">	</span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_string_new</span><span class="w"> </span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-1669" name="line-1669"></a>
<a id="line-1670" name="line-1670"></a><span class="w">	</span><span class="n">append_all_converted</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">URI_TO_STRING</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">ADDED_NONE</span><span class="p">);</span>
<a id="line-1671" name="line-1671"></a>
<a id="line-1672" name="line-1672"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">g_string_free</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">FALSE</span><span class="p">);</span>
<a id="line-1673" name="line-1673"></a><span class="p">}</span>
<a id="line-1674" name="line-1674"></a>
<a id="line-1675" name="line-1675"></a><span class="k">static</span><span class="w"> </span><span class="kr">inline</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span>
<a id="line-1676" name="line-1676"></a><span class="nf">stringify_files</span><span class="w"> </span><span class="p">(</span><span class="n">GSList</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<a id="line-1677" name="line-1677"></a><span class="p">{</span>
<a id="line-1678" name="line-1678"></a><span class="w">	</span><span class="n">GString</span><span class="w"> </span><span class="o">*</span><span class="n">str</span><span class="p">;</span>
<a id="line-1679" name="line-1679"></a>
<a id="line-1680" name="line-1680"></a><span class="w">	</span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_string_new</span><span class="w"> </span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-1681" name="line-1681"></a>
<a id="line-1682" name="line-1682"></a><span class="w">	</span><span class="n">append_all_converted</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">URI_TO_LOCAL_PATH</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">ADDED_NONE</span><span class="p">);</span>
<a id="line-1683" name="line-1683"></a>
<a id="line-1684" name="line-1684"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">g_string_free</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">FALSE</span><span class="p">);</span>
<a id="line-1685" name="line-1685"></a><span class="p">}</span>
<a id="line-1686" name="line-1686"></a>
<a id="line-1687" name="line-1687"></a><span class="k">static</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span>
<a id="line-1688" name="line-1688"></a><span class="nf">make_environment_for_screen</span><span class="w"> </span><span class="p">(</span><span class="n">GdkScreen</span><span class="w">  </span><span class="o">*</span><span class="n">screen</span><span class="p">,</span>
<a id="line-1689" name="line-1689"></a><span class="w">			     </span><span class="kt">char</span><span class="w">      </span><span class="o">**</span><span class="n">envp</span><span class="p">)</span>
<a id="line-1690" name="line-1690"></a><span class="p">{</span>
<a id="line-1691" name="line-1691"></a><span class="w">	</span><span class="n">GdkDisplay</span><span class="w"> </span><span class="o">*</span><span class="n">display</span><span class="p">;</span>
<a id="line-1692" name="line-1692"></a><span class="w">	</span><span class="kt">char</span><span class="w">      </span><span class="o">**</span><span class="n">retval</span><span class="p">;</span>
<a id="line-1693" name="line-1693"></a><span class="w">	</span><span class="kt">char</span><span class="w">      </span><span class="o">**</span><span class="n">freeme</span><span class="p">;</span>
<a id="line-1694" name="line-1694"></a><span class="w">	</span><span class="kt">char</span><span class="w">       </span><span class="o">*</span><span class="n">display_name</span><span class="p">;</span>
<a id="line-1695" name="line-1695"></a><span class="w">	</span><span class="kt">int</span><span class="w">         </span><span class="n">display_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<a id="line-1696" name="line-1696"></a><span class="w">	</span><span class="kt">int</span><span class="w">         </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">env_len</span><span class="p">;</span>
<a id="line-1697" name="line-1697"></a>
<a id="line-1698" name="line-1698"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">GDK_IS_SCREEN</span><span class="w"> </span><span class="p">(</span><span class="n">screen</span><span class="p">),</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-1699" name="line-1699"></a>
<a id="line-1700" name="line-1700"></a><span class="w">	</span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">freeme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-1701" name="line-1701"></a>
<a id="line-1702" name="line-1702"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">envp</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1703" name="line-1703"></a><span class="w">		</span><span class="n">envp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">freeme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_listenv</span><span class="w"> </span><span class="p">();</span>
<a id="line-1704" name="line-1704"></a><span class="w">		</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">envp</span><span class="w"> </span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1705" name="line-1705"></a><span class="w">			</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">envp</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="line-1706" name="line-1706"></a>
<a id="line-1707" name="line-1707"></a><span class="w">			</span><span class="n">envp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strjoin</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;=&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">g_getenv</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="p">),</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-1708" name="line-1708"></a><span class="w">			</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<a id="line-1709" name="line-1709"></a><span class="w">		</span><span class="p">}</span>
<a id="line-1710" name="line-1710"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1711" name="line-1711"></a>
<a id="line-1712" name="line-1712"></a><span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">env_len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">envp</span><span class="w"> </span><span class="p">[</span><span class="n">env_len</span><span class="p">];</span><span class="w"> </span><span class="n">env_len</span><span class="o">++</span><span class="p">)</span>
<a id="line-1713" name="line-1713"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">strncmp</span><span class="w"> </span><span class="p">(</span><span class="n">envp</span><span class="w"> </span><span class="p">[</span><span class="n">env_len</span><span class="p">],</span><span class="w"> </span><span class="s">&quot;DISPLAY&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">strlen</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;DISPLAY&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<a id="line-1714" name="line-1714"></a><span class="w">			</span><span class="n">display_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">env_len</span><span class="p">;</span>
<a id="line-1715" name="line-1715"></a>
<a id="line-1716" name="line-1716"></a><span class="w">	</span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_new</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">env_len</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="line-1717" name="line-1717"></a><span class="w">	</span><span class="n">retval</span><span class="w"> </span><span class="p">[</span><span class="n">env_len</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-1718" name="line-1718"></a>
<a id="line-1719" name="line-1719"></a><span class="w">	</span><span class="n">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gdk_screen_get_display</span><span class="w"> </span><span class="p">(</span><span class="n">screen</span><span class="p">);</span>
<a id="line-1720" name="line-1720"></a><span class="w">	</span><span class="n">display_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">gdk_display_get_name</span><span class="w"> </span><span class="p">(</span><span class="n">display</span><span class="p">));</span>
<a id="line-1721" name="line-1721"></a>
<a id="line-1722" name="line-1722"></a><span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">env_len</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<a id="line-1723" name="line-1723"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">display_index</span><span class="p">)</span>
<a id="line-1724" name="line-1724"></a><span class="w">			</span><span class="n">retval</span><span class="w"> </span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strconcat</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;DISPLAY=&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">display_name</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-1725" name="line-1725"></a><span class="w">		</span><span class="k">else</span>
<a id="line-1726" name="line-1726"></a><span class="w">			</span><span class="n">retval</span><span class="w"> </span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">envp</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<a id="line-1727" name="line-1727"></a>
<a id="line-1728" name="line-1728"></a><span class="w">	</span><span class="n">g_assert</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">env_len</span><span class="p">);</span>
<a id="line-1729" name="line-1729"></a>
<a id="line-1730" name="line-1730"></a><span class="w">	</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">display_name</span><span class="p">);</span>
<a id="line-1731" name="line-1731"></a><span class="w">	</span><span class="n">g_strfreev</span><span class="w"> </span><span class="p">(</span><span class="n">freeme</span><span class="p">);</span>
<a id="line-1732" name="line-1732"></a>
<a id="line-1733" name="line-1733"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">retval</span><span class="p">;</span>
<a id="line-1734" name="line-1734"></a><span class="p">}</span>
<a id="line-1735" name="line-1735"></a>
<a id="line-1736" name="line-1736"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<a id="line-1737" name="line-1737"></a><span class="nf">dummy_child_watch</span><span class="w"> </span><span class="p">(</span><span class="n">GPid</span><span class="w">         </span><span class="n">pid</span><span class="p">,</span>
<a id="line-1738" name="line-1738"></a><span class="w">		   </span><span class="n">gint</span><span class="w">         </span><span class="n">status</span><span class="p">,</span>
<a id="line-1739" name="line-1739"></a><span class="w">		   </span><span class="n">gpointer</span><span class="w"> </span><span class="n">user_data</span><span class="p">)</span>
<a id="line-1740" name="line-1740"></a><span class="p">{</span>
<a id="line-1741" name="line-1741"></a><span class="w">	</span><span class="cm">/* Nothing, this is just to ensure we don&#39;t double fork</span>
<a id="line-1742" name="line-1742"></a><span class="cm">	 * and break pkexec:</span>
<a id="line-1743" name="line-1743"></a><span class="cm">	 * https://bugzilla.gnome.org/show_bug.cgi?id=675789</span>
<a id="line-1744" name="line-1744"></a><span class="cm">	 */</span>
<a id="line-1745" name="line-1745"></a><span class="p">}</span>
<a id="line-1746" name="line-1746"></a>
<a id="line-1747" name="line-1747"></a><span class="k">static</span><span class="w"> </span><span class="kt">int</span>
<a id="line-1748" name="line-1748"></a><span class="nf">ditem_execute</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-1749" name="line-1749"></a><span class="w">	       </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">exec</span><span class="p">,</span>
<a id="line-1750" name="line-1750"></a><span class="w">	       </span><span class="n">GList</span><span class="w"> </span><span class="o">*</span><span class="n">file_list</span><span class="p">,</span>
<a id="line-1751" name="line-1751"></a><span class="w">	       </span><span class="n">GdkScreen</span><span class="w"> </span><span class="o">*</span><span class="n">screen</span><span class="p">,</span>
<a id="line-1752" name="line-1752"></a><span class="w">	       </span><span class="kt">int</span><span class="w"> </span><span class="n">workspace</span><span class="p">,</span>
<a id="line-1753" name="line-1753"></a><span class="w">               </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">envp</span><span class="p">,</span>
<a id="line-1754" name="line-1754"></a><span class="w">	       </span><span class="n">gboolean</span><span class="w"> </span><span class="n">launch_only_one</span><span class="p">,</span>
<a id="line-1755" name="line-1755"></a><span class="w">	       </span><span class="n">gboolean</span><span class="w"> </span><span class="n">use_current_dir</span><span class="p">,</span>
<a id="line-1756" name="line-1756"></a><span class="w">	       </span><span class="n">gboolean</span><span class="w"> </span><span class="n">append_uris</span><span class="p">,</span>
<a id="line-1757" name="line-1757"></a><span class="w">	       </span><span class="n">gboolean</span><span class="w"> </span><span class="n">append_paths</span><span class="p">,</span>
<a id="line-1758" name="line-1758"></a><span class="w">	       </span><span class="n">gboolean</span><span class="w"> </span><span class="n">do_not_reap_child</span><span class="p">,</span>
<a id="line-1759" name="line-1759"></a><span class="w">	       </span><span class="n">GError</span><span class="w"> </span><span class="o">**</span><span class="n">error</span><span class="p">)</span>
<a id="line-1760" name="line-1760"></a><span class="p">{</span>
<a id="line-1761" name="line-1761"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">free_me</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-1762" name="line-1762"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">real_argv</span><span class="p">;</span>
<a id="line-1763" name="line-1763"></a><span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<a id="line-1764" name="line-1764"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">term_argv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-1765" name="line-1765"></a><span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">term_argc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="line-1766" name="line-1766"></a><span class="w">	</span><span class="n">GSList</span><span class="w"> </span><span class="o">*</span><span class="n">vector_list</span><span class="p">;</span>
<a id="line-1767" name="line-1767"></a><span class="w">	</span><span class="n">GSList</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">arg_ptr</span><span class="p">;</span>
<a id="line-1768" name="line-1768"></a><span class="w">	</span><span class="n">AddedStatus</span><span class="w"> </span><span class="n">added_status</span><span class="p">;</span>
<a id="line-1769" name="line-1769"></a><span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">working_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-1770" name="line-1770"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">temp_argv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-1771" name="line-1771"></a><span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">temp_argc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="line-1772" name="line-1772"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">new_exec</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">uris</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">temp</span><span class="p">;</span>
<a id="line-1773" name="line-1773"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">exec_locale</span><span class="p">;</span>
<a id="line-1774" name="line-1774"></a><span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">launched</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="line-1775" name="line-1775"></a><span class="w">	</span><span class="n">GPid</span><span class="w"> </span><span class="n">pid</span><span class="p">;</span>
<a id="line-1776" name="line-1776"></a><span class="cp">#ifdef HAVE_STARTUP_NOTIFICATION</span>
<a id="line-1777" name="line-1777"></a><span class="w">	</span><span class="n">GdkDisplay</span><span class="w"> </span><span class="o">*</span><span class="n">gdkdisplay</span><span class="p">;</span>
<a id="line-1778" name="line-1778"></a><span class="w">	</span><span class="n">SnLauncherContext</span><span class="w"> </span><span class="o">*</span><span class="n">sn_context</span><span class="p">;</span>
<a id="line-1779" name="line-1779"></a><span class="w">	</span><span class="n">SnDisplay</span><span class="w"> </span><span class="o">*</span><span class="n">sn_display</span><span class="p">;</span>
<a id="line-1780" name="line-1780"></a><span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">startup_class</span><span class="p">;</span>
<a id="line-1781" name="line-1781"></a><span class="cp">#endif</span>
<a id="line-1782" name="line-1782"></a>
<a id="line-1783" name="line-1783"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
<a id="line-1784" name="line-1784"></a>
<a id="line-1785" name="line-1785"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TYPE_APPLICATION</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1786" name="line-1786"></a><span class="w">		</span><span class="n">working_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mate_desktop_item_get_string</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_PATH</span><span class="p">);</span>
<a id="line-1787" name="line-1787"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">working_dir</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<a id="line-1788" name="line-1788"></a><span class="w">		    </span><span class="o">!</span><span class="n">g_file_test</span><span class="w"> </span><span class="p">(</span><span class="n">working_dir</span><span class="p">,</span><span class="w"> </span><span class="n">G_FILE_TEST_IS_DIR</span><span class="p">))</span>
<a id="line-1789" name="line-1789"></a><span class="w">			</span><span class="n">working_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-1790" name="line-1790"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1791" name="line-1791"></a>
<a id="line-1792" name="line-1792"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">working_dir</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">use_current_dir</span><span class="p">)</span>
<a id="line-1793" name="line-1793"></a><span class="w">		</span><span class="n">working_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_get_home_dir</span><span class="w"> </span><span class="p">();</span>
<a id="line-1794" name="line-1794"></a>
<a id="line-1795" name="line-1795"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mate_desktop_item_get_boolean</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TERMINAL</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="line-1796" name="line-1796"></a><span class="w">		</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">options</span><span class="w"> </span><span class="o">=</span>
<a id="line-1797" name="line-1797"></a><span class="w">			</span><span class="n">mate_desktop_item_get_string</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TERMINAL_OPTIONS</span><span class="p">);</span>
<a id="line-1798" name="line-1798"></a>
<a id="line-1799" name="line-1799"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">options</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1800" name="line-1800"></a><span class="w">			</span><span class="n">g_shell_parse_argv</span><span class="w"> </span><span class="p">(</span><span class="n">options</span><span class="p">,</span>
<a id="line-1801" name="line-1801"></a><span class="w">					    </span><span class="o">&amp;</span><span class="n">term_argc</span><span class="p">,</span>
<a id="line-1802" name="line-1802"></a><span class="w">					    </span><span class="o">&amp;</span><span class="n">term_argv</span><span class="p">,</span>
<a id="line-1803" name="line-1803"></a><span class="w">					    </span><span class="nb">NULL</span><span class="w"> </span><span class="cm">/* error */</span><span class="p">);</span>
<a id="line-1804" name="line-1804"></a><span class="w">			</span><span class="cm">/* ignore errors */</span>
<a id="line-1805" name="line-1805"></a><span class="w">		</span><span class="p">}</span>
<a id="line-1806" name="line-1806"></a>
<a id="line-1807" name="line-1807"></a><span class="w">		</span><span class="n">mate_desktop_prepend_terminal_to_vector</span><span class="w"> </span><span class="p">(</span><span class="o">&amp;</span><span class="n">term_argc</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">term_argv</span><span class="p">);</span>
<a id="line-1808" name="line-1808"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1809" name="line-1809"></a>
<a id="line-1810" name="line-1810"></a><span class="w">	</span><span class="n">args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_args</span><span class="w"> </span><span class="p">(</span><span class="n">file_list</span><span class="p">);</span>
<a id="line-1811" name="line-1811"></a><span class="w">	</span><span class="n">arg_ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_args</span><span class="w"> </span><span class="p">(</span><span class="n">file_list</span><span class="p">);</span>
<a id="line-1812" name="line-1812"></a>
<a id="line-1813" name="line-1813"></a><span class="cp">#ifdef HAVE_STARTUP_NOTIFICATION</span>
<a id="line-1814" name="line-1814"></a><span class="w">	</span><span class="n">GdkDisplay</span><span class="w"> </span><span class="o">*</span><span class="n">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gdk_screen_get_display</span><span class="w"> </span><span class="p">(</span><span class="n">gdk_screen_get_default</span><span class="p">());</span>
<a id="line-1815" name="line-1815"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">GDK_IS_X11_DISPLAY</span><span class="w"> </span><span class="p">(</span><span class="n">display</span><span class="p">))</span>
<a id="line-1816" name="line-1816"></a><span class="w">	</span><span class="p">{</span>
<a id="line-1817" name="line-1817"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">screen</span><span class="p">)</span>
<a id="line-1818" name="line-1818"></a><span class="w">			</span><span class="n">gdkdisplay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gdk_screen_get_display</span><span class="w"> </span><span class="p">(</span><span class="n">screen</span><span class="p">);</span>
<a id="line-1819" name="line-1819"></a><span class="w">		</span><span class="k">else</span>
<a id="line-1820" name="line-1820"></a><span class="w">			</span><span class="n">gdkdisplay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gdk_display_get_default</span><span class="w"> </span><span class="p">();</span>
<a id="line-1821" name="line-1821"></a>
<a id="line-1822" name="line-1822"></a><span class="w">		</span><span class="n">sn_display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sn_display_new</span><span class="w"> </span><span class="p">(</span><span class="n">GDK_DISPLAY_XDISPLAY</span><span class="w"> </span><span class="p">(</span><span class="n">gdkdisplay</span><span class="p">),</span>
<a id="line-1823" name="line-1823"></a><span class="w">					     </span><span class="n">sn_error_trap_push</span><span class="p">,</span>
<a id="line-1824" name="line-1824"></a><span class="w">					     </span><span class="n">sn_error_trap_pop</span><span class="p">);</span>
<a id="line-1825" name="line-1825"></a>
<a id="line-1826" name="line-1826"></a><span class="w">		</span><span class="cm">/* Only initiate notification if desktop file supports it.</span>
<a id="line-1827" name="line-1827"></a><span class="cm">		 * (we could avoid setting up the SnLauncherContext if we aren&#39;t going</span>
<a id="line-1828" name="line-1828"></a><span class="cm">		 * to initiate, but why bother)</span>
<a id="line-1829" name="line-1829"></a><span class="cm">		 */</span>
<a id="line-1830" name="line-1830"></a>
<a id="line-1831" name="line-1831"></a><span class="w">		</span><span class="n">startup_class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mate_desktop_item_get_string</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span>
<a id="line-1832" name="line-1832"></a><span class="w">							      </span><span class="s">&quot;StartupWMClass&quot;</span><span class="p">);</span>
<a id="line-1833" name="line-1833"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">startup_class</span><span class="w"> </span><span class="o">||</span>
<a id="line-1834" name="line-1834"></a><span class="w">		    </span><span class="n">mate_desktop_item_get_boolean</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;StartupNotify&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="line-1835" name="line-1835"></a><span class="w">			</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="p">;</span>
<a id="line-1836" name="line-1836"></a><span class="w">			</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">icon</span><span class="p">;</span>
<a id="line-1837" name="line-1837"></a>
<a id="line-1838" name="line-1838"></a><span class="w">			</span><span class="n">sn_context</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sn_launcher_context_new</span><span class="w"> </span><span class="p">(</span><span class="n">sn_display</span><span class="p">,</span>
<a id="line-1839" name="line-1839"></a><span class="w">							      </span><span class="n">screen</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">gdk_x11_screen_get_screen_number</span><span class="w"> </span><span class="p">(</span><span class="n">screen</span><span class="p">)</span><span class="w"> </span><span class="o">:</span>
<a id="line-1840" name="line-1840"></a><span class="w">							      </span><span class="n">DefaultScreen</span><span class="w"> </span><span class="p">(</span><span class="n">GDK_DISPLAY_XDISPLAY</span><span class="w"> </span><span class="p">(</span><span class="n">gdkdisplay</span><span class="p">)));</span>
<a id="line-1841" name="line-1841"></a>
<a id="line-1842" name="line-1842"></a><span class="w">			</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mate_desktop_item_get_localestring</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span>
<a id="line-1843" name="line-1843"></a><span class="w">								   </span><span class="n">MATE_DESKTOP_ITEM_NAME</span><span class="p">);</span>
<a id="line-1844" name="line-1844"></a>
<a id="line-1845" name="line-1845"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-1846" name="line-1846"></a><span class="w">				</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mate_desktop_item_get_localestring</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span>
<a id="line-1847" name="line-1847"></a><span class="w">									   </span><span class="n">MATE_DESKTOP_ITEM_GENERIC_NAME</span><span class="p">);</span>
<a id="line-1848" name="line-1848"></a>
<a id="line-1849" name="line-1849"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1850" name="line-1850"></a><span class="w">				</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">description</span><span class="p">;</span>
<a id="line-1851" name="line-1851"></a>
<a id="line-1852" name="line-1852"></a><span class="w">				</span><span class="n">sn_launcher_context_set_name</span><span class="w"> </span><span class="p">(</span><span class="n">sn_context</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
<a id="line-1853" name="line-1853"></a>
<a id="line-1854" name="line-1854"></a><span class="w">				</span><span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup_printf</span><span class="w"> </span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Starting %s&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
<a id="line-1855" name="line-1855"></a>
<a id="line-1856" name="line-1856"></a><span class="w">				</span><span class="n">sn_launcher_context_set_description</span><span class="w"> </span><span class="p">(</span><span class="n">sn_context</span><span class="p">,</span><span class="w"> </span><span class="n">description</span><span class="p">);</span>
<a id="line-1857" name="line-1857"></a>
<a id="line-1858" name="line-1858"></a><span class="w">				</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">description</span><span class="p">);</span>
<a id="line-1859" name="line-1859"></a><span class="w">			</span><span class="p">}</span>
<a id="line-1860" name="line-1860"></a>
<a id="line-1861" name="line-1861"></a><span class="w">			</span><span class="n">icon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mate_desktop_item_get_string</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span>
<a id="line-1862" name="line-1862"></a><span class="w">							     </span><span class="n">MATE_DESKTOP_ITEM_ICON</span><span class="p">);</span>
<a id="line-1863" name="line-1863"></a>
<a id="line-1864" name="line-1864"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">icon</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-1865" name="line-1865"></a><span class="w">				</span><span class="n">sn_launcher_context_set_icon_name</span><span class="w"> </span><span class="p">(</span><span class="n">sn_context</span><span class="p">,</span><span class="w"> </span><span class="n">icon</span><span class="p">);</span>
<a id="line-1866" name="line-1866"></a>
<a id="line-1867" name="line-1867"></a><span class="w">			</span><span class="n">sn_launcher_context_set_workspace</span><span class="w"> </span><span class="p">(</span><span class="n">sn_context</span><span class="p">,</span><span class="w"> </span><span class="n">workspace</span><span class="p">);</span>
<a id="line-1868" name="line-1868"></a>
<a id="line-1869" name="line-1869"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">startup_class</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-1870" name="line-1870"></a><span class="w">				</span><span class="n">sn_launcher_context_set_wmclass</span><span class="w"> </span><span class="p">(</span><span class="n">sn_context</span><span class="p">,</span>
<a id="line-1871" name="line-1871"></a><span class="w">								 </span><span class="n">startup_class</span><span class="p">);</span>
<a id="line-1872" name="line-1872"></a><span class="w">		</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-1873" name="line-1873"></a><span class="w">			</span><span class="n">sn_context</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-1874" name="line-1874"></a><span class="w">		</span><span class="p">}</span>
<a id="line-1875" name="line-1875"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1876" name="line-1876"></a><span class="w">	</span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-1877" name="line-1877"></a><span class="w">		</span><span class="n">sn_context</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-1878" name="line-1878"></a><span class="w">		</span><span class="n">sn_display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-1879" name="line-1879"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1880" name="line-1880"></a><span class="cp">#endif</span>
<a id="line-1881" name="line-1881"></a>
<a id="line-1882" name="line-1882"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">screen</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1883" name="line-1883"></a><span class="w">		</span><span class="n">envp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_environment_for_screen</span><span class="w"> </span><span class="p">(</span><span class="n">screen</span><span class="p">,</span><span class="w"> </span><span class="n">envp</span><span class="p">);</span>
<a id="line-1884" name="line-1884"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">free_me</span><span class="p">)</span>
<a id="line-1885" name="line-1885"></a><span class="w">			</span><span class="n">g_strfreev</span><span class="w"> </span><span class="p">(</span><span class="n">free_me</span><span class="p">);</span>
<a id="line-1886" name="line-1886"></a><span class="w">		</span><span class="n">free_me</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">envp</span><span class="p">;</span>
<a id="line-1887" name="line-1887"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1888" name="line-1888"></a>
<a id="line-1889" name="line-1889"></a><span class="w">	</span><span class="n">exec_locale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_filename_from_utf8</span><span class="w"> </span><span class="p">(</span><span class="n">exec</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-1890" name="line-1890"></a>
<a id="line-1891" name="line-1891"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">exec_locale</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1892" name="line-1892"></a><span class="w">		</span><span class="n">exec_locale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">);</span>
<a id="line-1893" name="line-1893"></a><span class="w">	</span><span class="p">}</span>
<a id="line-1894" name="line-1894"></a>
<a id="line-1895" name="line-1895"></a><span class="w">	</span><span class="k">do</span><span class="w"> </span><span class="p">{</span>
<a id="line-1896" name="line-1896"></a><span class="w">		</span><span class="n">added_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ADDED_NONE</span><span class="p">;</span>
<a id="line-1897" name="line-1897"></a><span class="w">		</span><span class="n">new_exec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expand_string</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span>
<a id="line-1898" name="line-1898"></a><span class="w">					  </span><span class="n">exec_locale</span><span class="p">,</span>
<a id="line-1899" name="line-1899"></a><span class="w">					  </span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">arg_ptr</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">added_status</span><span class="p">);</span>
<a id="line-1900" name="line-1900"></a>
<a id="line-1901" name="line-1901"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">launched</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">added_status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ADDED_NONE</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">append_uris</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1902" name="line-1902"></a><span class="w">			</span><span class="n">uris</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stringify_uris</span><span class="w"> </span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
<a id="line-1903" name="line-1903"></a><span class="w">			</span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strconcat</span><span class="w"> </span><span class="p">(</span><span class="n">new_exec</span><span class="p">,</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">uris</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-1904" name="line-1904"></a><span class="w">			</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">uris</span><span class="p">);</span>
<a id="line-1905" name="line-1905"></a><span class="w">			</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">new_exec</span><span class="p">);</span>
<a id="line-1906" name="line-1906"></a><span class="w">			</span><span class="n">new_exec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">;</span>
<a id="line-1907" name="line-1907"></a><span class="w">			</span><span class="n">added_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ADDED_ALL</span><span class="p">;</span>
<a id="line-1908" name="line-1908"></a><span class="w">		</span><span class="p">}</span>
<a id="line-1909" name="line-1909"></a>
<a id="line-1910" name="line-1910"></a><span class="w">		</span><span class="cm">/* append_uris and append_paths are mutually exlusive */</span>
<a id="line-1911" name="line-1911"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">launched</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">added_status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ADDED_NONE</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">append_paths</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1912" name="line-1912"></a><span class="w">			</span><span class="n">uris</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stringify_files</span><span class="w"> </span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
<a id="line-1913" name="line-1913"></a><span class="w">			</span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strconcat</span><span class="w"> </span><span class="p">(</span><span class="n">new_exec</span><span class="p">,</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">uris</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-1914" name="line-1914"></a><span class="w">			</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">uris</span><span class="p">);</span>
<a id="line-1915" name="line-1915"></a><span class="w">			</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">new_exec</span><span class="p">);</span>
<a id="line-1916" name="line-1916"></a><span class="w">			</span><span class="n">new_exec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">;</span>
<a id="line-1917" name="line-1917"></a><span class="w">			</span><span class="n">added_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ADDED_ALL</span><span class="p">;</span>
<a id="line-1918" name="line-1918"></a><span class="w">		</span><span class="p">}</span>
<a id="line-1919" name="line-1919"></a>
<a id="line-1920" name="line-1920"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">launched</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">added_status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ADDED_NONE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1921" name="line-1921"></a><span class="w">			</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">new_exec</span><span class="p">);</span>
<a id="line-1922" name="line-1922"></a><span class="w">			</span><span class="k">break</span><span class="p">;</span>
<a id="line-1923" name="line-1923"></a><span class="w">		</span><span class="p">}</span>
<a id="line-1924" name="line-1924"></a>
<a id="line-1925" name="line-1925"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="n">g_shell_parse_argv</span><span class="w"> </span><span class="p">(</span><span class="n">new_exec</span><span class="p">,</span>
<a id="line-1926" name="line-1926"></a><span class="w">					   </span><span class="o">&amp;</span><span class="n">temp_argc</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp_argv</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="line-1927" name="line-1927"></a><span class="w">			</span><span class="cm">/* The error now comes from g_shell_parse_argv */</span>
<a id="line-1928" name="line-1928"></a><span class="w">			</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">new_exec</span><span class="p">);</span>
<a id="line-1929" name="line-1929"></a><span class="w">			</span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<a id="line-1930" name="line-1930"></a><span class="w">			</span><span class="k">break</span><span class="p">;</span>
<a id="line-1931" name="line-1931"></a><span class="w">		</span><span class="p">}</span>
<a id="line-1932" name="line-1932"></a><span class="w">		</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">new_exec</span><span class="p">);</span>
<a id="line-1933" name="line-1933"></a>
<a id="line-1934" name="line-1934"></a><span class="w">		</span><span class="n">vector_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-1935" name="line-1935"></a><span class="w">		</span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">term_argc</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<a id="line-1936" name="line-1936"></a><span class="w">			</span><span class="n">vector_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_slist_append</span><span class="w"> </span><span class="p">(</span><span class="n">vector_list</span><span class="p">,</span>
<a id="line-1937" name="line-1937"></a><span class="w">						      </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">term_argv</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
<a id="line-1938" name="line-1938"></a>
<a id="line-1939" name="line-1939"></a><span class="w">		</span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">temp_argc</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<a id="line-1940" name="line-1940"></a><span class="w">			</span><span class="n">vector_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_slist_append</span><span class="w"> </span><span class="p">(</span><span class="n">vector_list</span><span class="p">,</span>
<a id="line-1941" name="line-1941"></a><span class="w">						      </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">temp_argv</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
<a id="line-1942" name="line-1942"></a>
<a id="line-1943" name="line-1943"></a><span class="w">		</span><span class="n">g_strfreev</span><span class="w"> </span><span class="p">(</span><span class="n">temp_argv</span><span class="p">);</span>
<a id="line-1944" name="line-1944"></a>
<a id="line-1945" name="line-1945"></a><span class="w">		</span><span class="n">real_argv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">list_to_vector</span><span class="w"> </span><span class="p">(</span><span class="n">vector_list</span><span class="p">);</span>
<a id="line-1946" name="line-1946"></a><span class="w">		</span><span class="n">g_slist_free_full</span><span class="w"> </span><span class="p">(</span><span class="n">vector_list</span><span class="p">,</span><span class="w"> </span><span class="n">g_free</span><span class="p">);</span>
<a id="line-1947" name="line-1947"></a>
<a id="line-1948" name="line-1948"></a><span class="cp">#ifdef HAVE_STARTUP_NOTIFICATION</span>
<a id="line-1949" name="line-1949"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sn_context</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">GDK_IS_X11_DISPLAY</span><span class="w"> </span><span class="p">(</span><span class="n">display</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<a id="line-1950" name="line-1950"></a><span class="w">		    </span><span class="o">!</span><span class="n">sn_launcher_context_get_initiated</span><span class="w"> </span><span class="p">(</span><span class="n">sn_context</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="line-1951" name="line-1951"></a><span class="w">			</span><span class="n">guint32</span><span class="w"> </span><span class="n">launch_time</span><span class="p">;</span>
<a id="line-1952" name="line-1952"></a>
<a id="line-1953" name="line-1953"></a><span class="w">			</span><span class="cm">/* This means that we always use the first real_argv[0]</span>
<a id="line-1954" name="line-1954"></a><span class="cm">			 * we select for the &quot;binary name&quot;, but it&#39;s probably</span>
<a id="line-1955" name="line-1955"></a><span class="cm">			 * OK to do that. Binary name isn&#39;t super-important</span>
<a id="line-1956" name="line-1956"></a><span class="cm">			 * anyway, and we can&#39;t initiate twice, and we</span>
<a id="line-1957" name="line-1957"></a><span class="cm">			 * must initiate prior to fork/exec.</span>
<a id="line-1958" name="line-1958"></a><span class="cm">			 */</span>
<a id="line-1959" name="line-1959"></a>
<a id="line-1960" name="line-1960"></a><span class="w">			</span><span class="n">sn_launcher_context_set_binary_name</span><span class="w"> </span><span class="p">(</span><span class="n">sn_context</span><span class="p">,</span>
<a id="line-1961" name="line-1961"></a><span class="w">							     </span><span class="n">real_argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<a id="line-1962" name="line-1962"></a>
<a id="line-1963" name="line-1963"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">launch_time</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<a id="line-1964" name="line-1964"></a><span class="w">				</span><span class="n">launch_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="o">-&gt;</span><span class="n">launch_time</span><span class="p">;</span>
<a id="line-1965" name="line-1965"></a><span class="w">			</span><span class="k">else</span>
<a id="line-1966" name="line-1966"></a><span class="w">				</span><span class="n">launch_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gdk_x11_display_get_user_time</span><span class="w"> </span><span class="p">(</span><span class="n">gdkdisplay</span><span class="p">);</span>
<a id="line-1967" name="line-1967"></a>
<a id="line-1968" name="line-1968"></a><span class="w">			</span><span class="n">sn_launcher_context_initiate</span><span class="w"> </span><span class="p">(</span><span class="n">sn_context</span><span class="p">,</span>
<a id="line-1969" name="line-1969"></a><span class="w">						      </span><span class="n">g_get_prgname</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">g_get_prgname</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;unknown&quot;</span><span class="p">,</span>
<a id="line-1970" name="line-1970"></a><span class="w">						      </span><span class="n">real_argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<a id="line-1971" name="line-1971"></a><span class="w">						      </span><span class="n">launch_time</span><span class="p">);</span>
<a id="line-1972" name="line-1972"></a>
<a id="line-1973" name="line-1973"></a><span class="w">			</span><span class="cm">/* Don&#39;t allow accidental reuse of same timestamp */</span>
<a id="line-1974" name="line-1974"></a><span class="w">			</span><span class="p">((</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">item</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">launch_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="line-1975" name="line-1975"></a>
<a id="line-1976" name="line-1976"></a><span class="w">			</span><span class="n">envp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_spawn_environment_for_sn_context</span><span class="w"> </span><span class="p">(</span><span class="n">sn_context</span><span class="p">,</span><span class="w"> </span><span class="n">envp</span><span class="p">);</span>
<a id="line-1977" name="line-1977"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">free_me</span><span class="p">)</span>
<a id="line-1978" name="line-1978"></a><span class="w">				</span><span class="n">g_strfreev</span><span class="w"> </span><span class="p">(</span><span class="n">free_me</span><span class="p">);</span>
<a id="line-1979" name="line-1979"></a><span class="w">			</span><span class="n">free_me</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">envp</span><span class="p">;</span>
<a id="line-1980" name="line-1980"></a><span class="w">		</span><span class="p">}</span>
<a id="line-1981" name="line-1981"></a><span class="cp">#endif</span>
<a id="line-1982" name="line-1982"></a>
<a id="line-1983" name="line-1983"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="n">g_spawn_async</span><span class="w"> </span><span class="p">(</span><span class="n">working_dir</span><span class="p">,</span>
<a id="line-1984" name="line-1984"></a><span class="w">				      </span><span class="n">real_argv</span><span class="p">,</span>
<a id="line-1985" name="line-1985"></a><span class="w">				      </span><span class="n">envp</span><span class="p">,</span>
<a id="line-1986" name="line-1986"></a><span class="w">				      </span><span class="p">(</span><span class="n">do_not_reap_child</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">G_SPAWN_DO_NOT_REAP_CHILD</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">G_SPAWN_SEARCH_PATH</span><span class="w"> </span><span class="cm">/* flags */</span><span class="p">,</span>
<a id="line-1987" name="line-1987"></a><span class="w">				      </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="cm">/* child_setup_func */</span>
<a id="line-1988" name="line-1988"></a><span class="w">				      </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="cm">/* child_setup_func_data */</span>
<a id="line-1989" name="line-1989"></a><span class="w">				      </span><span class="p">(</span><span class="n">do_not_reap_child</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="o">&amp;</span><span class="n">pid</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="cm">/* child_pid */</span><span class="p">,</span>
<a id="line-1990" name="line-1990"></a><span class="w">				      </span><span class="n">error</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="line-1991" name="line-1991"></a><span class="w">			</span><span class="cm">/* The error was set for us,</span>
<a id="line-1992" name="line-1992"></a><span class="cm">			 * we just can&#39;t launch this thingie */</span>
<a id="line-1993" name="line-1993"></a><span class="w">			</span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<a id="line-1994" name="line-1994"></a><span class="w">			</span><span class="n">g_strfreev</span><span class="w"> </span><span class="p">(</span><span class="n">real_argv</span><span class="p">);</span>
<a id="line-1995" name="line-1995"></a><span class="w">			</span><span class="k">break</span><span class="p">;</span>
<a id="line-1996" name="line-1996"></a><span class="w">		</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">do_not_reap_child</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-1997" name="line-1997"></a><span class="w">			</span><span class="n">g_child_watch_add</span><span class="w"> </span><span class="p">(</span><span class="n">pid</span><span class="p">,</span><span class="w"> </span><span class="n">dummy_child_watch</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-1998" name="line-1998"></a><span class="w">		</span><span class="p">}</span>
<a id="line-1999" name="line-1999"></a>
<a id="line-2000" name="line-2000"></a><span class="w">		</span><span class="n">launched</span><span class="w"> </span><span class="o">++</span><span class="p">;</span>
<a id="line-2001" name="line-2001"></a>
<a id="line-2002" name="line-2002"></a><span class="w">		</span><span class="n">g_strfreev</span><span class="w"> </span><span class="p">(</span><span class="n">real_argv</span><span class="p">);</span>
<a id="line-2003" name="line-2003"></a>
<a id="line-2004" name="line-2004"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">arg_ptr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-2005" name="line-2005"></a><span class="w">			</span><span class="n">arg_ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">arg_ptr</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
<a id="line-2006" name="line-2006"></a>
<a id="line-2007" name="line-2007"></a><span class="w">	</span><span class="cm">/* rinse, repeat until we run out of arguments (That</span>
<a id="line-2008" name="line-2008"></a><span class="cm">	 * is if we were adding singles anyway) */</span>
<a id="line-2009" name="line-2009"></a><span class="w">	</span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">added_status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ADDED_SINGLE</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<a id="line-2010" name="line-2010"></a><span class="w">		 </span><span class="n">arg_ptr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<a id="line-2011" name="line-2011"></a><span class="w">		 </span><span class="o">!</span><span class="w"> </span><span class="n">launch_only_one</span><span class="p">);</span>
<a id="line-2012" name="line-2012"></a>
<a id="line-2013" name="line-2013"></a><span class="w">	</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">exec_locale</span><span class="p">);</span>
<a id="line-2014" name="line-2014"></a><span class="cp">#ifdef HAVE_STARTUP_NOTIFICATION</span>
<a id="line-2015" name="line-2015"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">sn_context</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">GDK_IS_X11_DISPLAY</span><span class="w"> </span><span class="p">(</span><span class="n">display</span><span class="p">))){</span>
<a id="line-2016" name="line-2016"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<a id="line-2017" name="line-2017"></a><span class="w">			</span><span class="n">sn_launcher_context_complete</span><span class="w"> </span><span class="p">(</span><span class="n">sn_context</span><span class="p">);</span><span class="w"> </span><span class="cm">/* end sequence */</span>
<a id="line-2018" name="line-2018"></a><span class="w">		</span><span class="k">else</span>
<a id="line-2019" name="line-2019"></a><span class="w">			</span><span class="n">add_startup_timeout</span><span class="w"> </span><span class="p">(</span><span class="n">screen</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">screen</span><span class="w"> </span><span class="o">:</span>
<a id="line-2020" name="line-2020"></a><span class="w">					     </span><span class="n">gdk_display_get_default_screen</span><span class="w"> </span><span class="p">(</span><span class="n">gdk_display_get_default</span><span class="w"> </span><span class="p">()),</span>
<a id="line-2021" name="line-2021"></a><span class="w">					     </span><span class="n">sn_context</span><span class="p">);</span>
<a id="line-2022" name="line-2022"></a><span class="w">		</span><span class="n">sn_launcher_context_unref</span><span class="w"> </span><span class="p">(</span><span class="n">sn_context</span><span class="p">);</span>
<a id="line-2023" name="line-2023"></a><span class="w">	</span><span class="p">}</span>
<a id="line-2024" name="line-2024"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">GDK_IS_X11_DISPLAY</span><span class="w"> </span><span class="p">(</span><span class="n">display</span><span class="p">))</span>
<a id="line-2025" name="line-2025"></a><span class="w">		</span><span class="n">sn_display_unref</span><span class="w"> </span><span class="p">(</span><span class="n">sn_display</span><span class="p">);</span>
<a id="line-2026" name="line-2026"></a>
<a id="line-2027" name="line-2027"></a><span class="cp">#endif </span><span class="cm">/* HAVE_STARTUP_NOTIFICATION */</span>
<a id="line-2028" name="line-2028"></a>
<a id="line-2029" name="line-2029"></a><span class="w">	</span><span class="n">free_args</span><span class="w"> </span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
<a id="line-2030" name="line-2030"></a>
<a id="line-2031" name="line-2031"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">term_argv</span><span class="p">)</span>
<a id="line-2032" name="line-2032"></a><span class="w">		</span><span class="n">g_strfreev</span><span class="w"> </span><span class="p">(</span><span class="n">term_argv</span><span class="p">);</span>
<a id="line-2033" name="line-2033"></a>
<a id="line-2034" name="line-2034"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">free_me</span><span class="p">)</span>
<a id="line-2035" name="line-2035"></a><span class="w">		</span><span class="n">g_strfreev</span><span class="w"> </span><span class="p">(</span><span class="n">free_me</span><span class="p">);</span>
<a id="line-2036" name="line-2036"></a>
<a id="line-2037" name="line-2037"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<a id="line-2038" name="line-2038"></a><span class="p">}</span>
<a id="line-2039" name="line-2039"></a>
<a id="line-2040" name="line-2040"></a><span class="cm">/* strip any trailing &amp;, return FALSE if bad things happen and</span>
<a id="line-2041" name="line-2041"></a><span class="cm">   we end up with an empty string */</span>
<a id="line-2042" name="line-2042"></a><span class="k">static</span><span class="w"> </span><span class="n">gboolean</span>
<a id="line-2043" name="line-2043"></a><span class="nf">strip_the_amp</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">exec</span><span class="p">)</span>
<a id="line-2044" name="line-2044"></a><span class="p">{</span>
<a id="line-2045" name="line-2045"></a><span class="w">	</span><span class="kt">size_t</span><span class="w"> </span><span class="n">exec_len</span><span class="p">;</span>
<a id="line-2046" name="line-2046"></a>
<a id="line-2047" name="line-2047"></a><span class="w">	</span><span class="n">g_strstrip</span><span class="w"> </span><span class="p">(</span><span class="n">exec</span><span class="p">);</span>
<a id="line-2048" name="line-2048"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">exec</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">)</span>
<a id="line-2049" name="line-2049"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-2050" name="line-2050"></a>
<a id="line-2051" name="line-2051"></a><span class="w">	</span><span class="n">exec_len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strlen</span><span class="w"> </span><span class="p">(</span><span class="n">exec</span><span class="p">);</span>
<a id="line-2052" name="line-2052"></a><span class="w">	</span><span class="cm">/* kill any trailing &#39;&amp;&#39; */</span>
<a id="line-2053" name="line-2053"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">exec</span><span class="p">[</span><span class="n">exec_len</span><span class="mi">-1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;&amp;&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-2054" name="line-2054"></a><span class="w">		</span><span class="n">exec</span><span class="p">[</span><span class="n">exec_len</span><span class="mi">-1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">;</span>
<a id="line-2055" name="line-2055"></a><span class="w">		</span><span class="n">g_strchomp</span><span class="w"> </span><span class="p">(</span><span class="n">exec</span><span class="p">);</span>
<a id="line-2056" name="line-2056"></a><span class="w">	</span><span class="p">}</span>
<a id="line-2057" name="line-2057"></a>
<a id="line-2058" name="line-2058"></a><span class="w">	</span><span class="cm">/* can&#39;t exactly launch an empty thing */</span>
<a id="line-2059" name="line-2059"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">exec</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">)</span>
<a id="line-2060" name="line-2060"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-2061" name="line-2061"></a>
<a id="line-2062" name="line-2062"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
<a id="line-2063" name="line-2063"></a><span class="p">}</span>
<a id="line-2064" name="line-2064"></a>
<a id="line-2065" name="line-2065"></a><span class="k">static</span><span class="w"> </span><span class="kt">int</span>
<a id="line-2066" name="line-2066"></a><span class="nf">mate_desktop_item_launch_on_screen_with_env</span><span class="w"> </span><span class="p">(</span>
<a id="line-2067" name="line-2067"></a><span class="w">		</span><span class="k">const</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w">       </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-2068" name="line-2068"></a><span class="w">		</span><span class="n">GList</span><span class="w">                        </span><span class="o">*</span><span class="n">file_list</span><span class="p">,</span>
<a id="line-2069" name="line-2069"></a><span class="w">		</span><span class="n">MateDesktopItemLaunchFlags</span><span class="w">   </span><span class="n">flags</span><span class="p">,</span>
<a id="line-2070" name="line-2070"></a><span class="w">		</span><span class="n">GdkScreen</span><span class="w">                    </span><span class="o">*</span><span class="n">screen</span><span class="p">,</span>
<a id="line-2071" name="line-2071"></a><span class="w">		</span><span class="kt">int</span><span class="w">                           </span><span class="n">workspace</span><span class="p">,</span>
<a id="line-2072" name="line-2072"></a><span class="w">		</span><span class="kt">char</span><span class="w">                        </span><span class="o">**</span><span class="n">envp</span><span class="p">,</span>
<a id="line-2073" name="line-2073"></a><span class="w">		</span><span class="n">GError</span><span class="w">                      </span><span class="o">**</span><span class="n">error</span><span class="p">)</span>
<a id="line-2074" name="line-2074"></a><span class="p">{</span>
<a id="line-2075" name="line-2075"></a><span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">exec</span><span class="p">;</span>
<a id="line-2076" name="line-2076"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">the_exec</span><span class="p">;</span>
<a id="line-2077" name="line-2077"></a><span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<a id="line-2078" name="line-2078"></a>
<a id="line-2079" name="line-2079"></a><span class="w">	</span><span class="n">exec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mate_desktop_item_get_string</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_EXEC</span><span class="p">);</span>
<a id="line-2080" name="line-2080"></a><span class="w">	</span><span class="cm">/* This is a URL, so launch it as a url */</span>
<a id="line-2081" name="line-2081"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TYPE_LINK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-2082" name="line-2082"></a><span class="w">		</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">url</span><span class="p">;</span>
<a id="line-2083" name="line-2083"></a><span class="w">		</span><span class="n">gboolean</span><span class="w">    </span><span class="n">retval</span><span class="p">;</span>
<a id="line-2084" name="line-2084"></a>
<a id="line-2085" name="line-2085"></a><span class="w">		</span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mate_desktop_item_get_string</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_URL</span><span class="p">);</span>
<a id="line-2086" name="line-2086"></a><span class="w">		</span><span class="cm">/* Mate panel used to put this in Exec */</span>
<a id="line-2087" name="line-2087"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">url</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">url</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">))</span>
<a id="line-2088" name="line-2088"></a><span class="w">			</span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">exec</span><span class="p">;</span>
<a id="line-2089" name="line-2089"></a>
<a id="line-2090" name="line-2090"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">url</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">url</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="line-2091" name="line-2091"></a><span class="w">			</span><span class="n">g_set_error</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">,</span>
<a id="line-2092" name="line-2092"></a><span class="w">				     </span><span class="n">MATE_DESKTOP_ITEM_ERROR</span><span class="p">,</span>
<a id="line-2093" name="line-2093"></a><span class="w">				     </span><span class="n">MATE_DESKTOP_ITEM_ERROR_NO_URL</span><span class="p">,</span>
<a id="line-2094" name="line-2094"></a><span class="w">				     </span><span class="n">_</span><span class="p">(</span><span class="s">&quot;No URL to launch&quot;</span><span class="p">));</span>
<a id="line-2095" name="line-2095"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<a id="line-2096" name="line-2096"></a><span class="w">		</span><span class="p">}</span>
<a id="line-2097" name="line-2097"></a>
<a id="line-2098" name="line-2098"></a><span class="w">		</span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtk_show_uri_on_window</span><span class="w">  </span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span>
<a id="line-2099" name="line-2099"></a><span class="w">		                                  </span><span class="n">url</span><span class="p">,</span>
<a id="line-2100" name="line-2100"></a><span class="w">		                                  </span><span class="n">GDK_CURRENT_TIME</span><span class="p">,</span>
<a id="line-2101" name="line-2101"></a><span class="w">		                                  </span><span class="n">error</span><span class="p">);</span>
<a id="line-2102" name="line-2102"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">retval</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<a id="line-2103" name="line-2103"></a><span class="w">	</span><span class="p">}</span>
<a id="line-2104" name="line-2104"></a>
<a id="line-2105" name="line-2105"></a><span class="w">	</span><span class="cm">/* check the type, if there is one set */</span>
<a id="line-2106" name="line-2106"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">type</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TYPE_APPLICATION</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-2107" name="line-2107"></a><span class="w">		</span><span class="n">g_set_error</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">,</span>
<a id="line-2108" name="line-2108"></a><span class="w">			     </span><span class="n">MATE_DESKTOP_ITEM_ERROR</span><span class="p">,</span>
<a id="line-2109" name="line-2109"></a><span class="w">			     </span><span class="n">MATE_DESKTOP_ITEM_ERROR_NOT_LAUNCHABLE</span><span class="p">,</span>
<a id="line-2110" name="line-2110"></a><span class="w">			     </span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Not a launchable item&quot;</span><span class="p">));</span>
<a id="line-2111" name="line-2111"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<a id="line-2112" name="line-2112"></a><span class="w">	</span><span class="p">}</span>
<a id="line-2113" name="line-2113"></a>
<a id="line-2114" name="line-2114"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">exec</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">||</span>
<a id="line-2115" name="line-2115"></a><span class="w">	    </span><span class="n">exec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-2116" name="line-2116"></a><span class="w">		</span><span class="n">g_set_error</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">,</span>
<a id="line-2117" name="line-2117"></a><span class="w">			     </span><span class="n">MATE_DESKTOP_ITEM_ERROR</span><span class="p">,</span>
<a id="line-2118" name="line-2118"></a><span class="w">			     </span><span class="n">MATE_DESKTOP_ITEM_ERROR_NO_EXEC_STRING</span><span class="p">,</span>
<a id="line-2119" name="line-2119"></a><span class="w">			     </span><span class="n">_</span><span class="p">(</span><span class="s">&quot;No command (Exec) to launch&quot;</span><span class="p">));</span>
<a id="line-2120" name="line-2120"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<a id="line-2121" name="line-2121"></a><span class="w">	</span><span class="p">}</span>
<a id="line-2122" name="line-2122"></a>
<a id="line-2123" name="line-2123"></a><span class="w">	</span><span class="cm">/* make a new copy and get rid of spaces */</span>
<a id="line-2124" name="line-2124"></a><span class="w">	</span><span class="n">the_exec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_alloca</span><span class="w"> </span><span class="p">(</span><span class="n">strlen</span><span class="w"> </span><span class="p">(</span><span class="n">exec</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="line-2125" name="line-2125"></a><span class="w">	</span><span class="n">g_strlcpy</span><span class="w"> </span><span class="p">(</span><span class="n">the_exec</span><span class="p">,</span><span class="w"> </span><span class="n">exec</span><span class="p">,</span><span class="w"> </span><span class="n">strlen</span><span class="w"> </span><span class="p">(</span><span class="n">exec</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="line-2126" name="line-2126"></a>
<a id="line-2127" name="line-2127"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="n">strip_the_amp</span><span class="w"> </span><span class="p">(</span><span class="n">the_exec</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="line-2128" name="line-2128"></a><span class="w">		</span><span class="n">g_set_error</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">,</span>
<a id="line-2129" name="line-2129"></a><span class="w">			     </span><span class="n">MATE_DESKTOP_ITEM_ERROR</span><span class="p">,</span>
<a id="line-2130" name="line-2130"></a><span class="w">			     </span><span class="n">MATE_DESKTOP_ITEM_ERROR_BAD_EXEC_STRING</span><span class="p">,</span>
<a id="line-2131" name="line-2131"></a><span class="w">			     </span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Bad command (Exec) to launch&quot;</span><span class="p">));</span>
<a id="line-2132" name="line-2132"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<a id="line-2133" name="line-2133"></a><span class="w">	</span><span class="p">}</span>
<a id="line-2134" name="line-2134"></a>
<a id="line-2135" name="line-2135"></a><span class="w">	</span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ditem_execute</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">the_exec</span><span class="p">,</span><span class="w"> </span><span class="n">file_list</span><span class="p">,</span><span class="w"> </span><span class="n">screen</span><span class="p">,</span><span class="w"> </span><span class="n">workspace</span><span class="p">,</span><span class="w"> </span><span class="n">envp</span><span class="p">,</span>
<a id="line-2136" name="line-2136"></a><span class="w">			     </span><span class="p">(</span><span class="n">flags</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_LAUNCH_ONLY_ONE</span><span class="p">),</span>
<a id="line-2137" name="line-2137"></a><span class="w">			     </span><span class="p">(</span><span class="n">flags</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_LAUNCH_USE_CURRENT_DIR</span><span class="p">),</span>
<a id="line-2138" name="line-2138"></a><span class="w">			     </span><span class="p">(</span><span class="n">flags</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_LAUNCH_APPEND_URIS</span><span class="p">),</span>
<a id="line-2139" name="line-2139"></a><span class="w">			     </span><span class="p">(</span><span class="n">flags</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_LAUNCH_APPEND_PATHS</span><span class="p">),</span>
<a id="line-2140" name="line-2140"></a><span class="w">			     </span><span class="p">(</span><span class="n">flags</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_LAUNCH_DO_NOT_REAP_CHILD</span><span class="p">),</span>
<a id="line-2141" name="line-2141"></a><span class="w">			     </span><span class="n">error</span><span class="p">);</span>
<a id="line-2142" name="line-2142"></a>
<a id="line-2143" name="line-2143"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<a id="line-2144" name="line-2144"></a><span class="p">}</span>
<a id="line-2145" name="line-2145"></a>
<a id="line-2146" name="line-2146"></a><span class="cm">/**</span>
<a id="line-2147" name="line-2147"></a><span class="cm"> * mate_desktop_item_launch:</span>
<a id="line-2148" name="line-2148"></a><span class="cm"> * @item: A desktop item</span>
<a id="line-2149" name="line-2149"></a><span class="cm"> * @file_list:  Files/URIs to launch this item with, can be %NULL</span>
<a id="line-2150" name="line-2150"></a><span class="cm"> * @flags: FIXME</span>
<a id="line-2151" name="line-2151"></a><span class="cm"> * @error: FIXME</span>
<a id="line-2152" name="line-2152"></a><span class="cm"> *</span>
<a id="line-2153" name="line-2153"></a><span class="cm"> * This function runs the program listed in the specified &#39;item&#39;,</span>
<a id="line-2154" name="line-2154"></a><span class="cm"> * optionally appending additional arguments to its command line.  It uses</span>
<a id="line-2155" name="line-2155"></a><span class="cm"> * #g_shell_parse_argv to parse the the exec string into a vector which is</span>
<a id="line-2156" name="line-2156"></a><span class="cm"> * then passed to #g_spawn_async for execution. This can return all</span>
<a id="line-2157" name="line-2157"></a><span class="cm"> * the errors from MateURL, #g_shell_parse_argv and #g_spawn_async,</span>
<a id="line-2158" name="line-2158"></a><span class="cm"> * in addition to it&#39;s own.  The files are</span>
<a id="line-2159" name="line-2159"></a><span class="cm"> * only added if the entry defines one of the standard % strings in it&#39;s</span>
<a id="line-2160" name="line-2160"></a><span class="cm"> * Exec field.</span>
<a id="line-2161" name="line-2161"></a><span class="cm"> *</span>
<a id="line-2162" name="line-2162"></a><span class="cm"> * Returns: The the pid of the process spawned.  If more then one</span>
<a id="line-2163" name="line-2163"></a><span class="cm"> * process was spawned the last pid is returned.  On error -1</span>
<a id="line-2164" name="line-2164"></a><span class="cm"> * is returned and @error is set.</span>
<a id="line-2165" name="line-2165"></a><span class="cm"> */</span>
<a id="line-2166" name="line-2166"></a><span class="kt">int</span>
<a id="line-2167" name="line-2167"></a><span class="nf">mate_desktop_item_launch</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w">       </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-2168" name="line-2168"></a><span class="w">			   </span><span class="n">GList</span><span class="w">                        </span><span class="o">*</span><span class="n">file_list</span><span class="p">,</span>
<a id="line-2169" name="line-2169"></a><span class="w">			   </span><span class="n">MateDesktopItemLaunchFlags</span><span class="w">   </span><span class="n">flags</span><span class="p">,</span>
<a id="line-2170" name="line-2170"></a><span class="w">			   </span><span class="n">GError</span><span class="w">                      </span><span class="o">**</span><span class="n">error</span><span class="p">)</span>
<a id="line-2171" name="line-2171"></a><span class="p">{</span>
<a id="line-2172" name="line-2172"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">mate_desktop_item_launch_on_screen_with_env</span><span class="w"> </span><span class="p">(</span>
<a id="line-2173" name="line-2173"></a><span class="w">			</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">file_list</span><span class="p">,</span><span class="w"> </span><span class="n">flags</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">);</span>
<a id="line-2174" name="line-2174"></a><span class="p">}</span>
<a id="line-2175" name="line-2175"></a>
<a id="line-2176" name="line-2176"></a><span class="cm">/**</span>
<a id="line-2177" name="line-2177"></a><span class="cm"> * mate_desktop_item_launch_with_env:</span>
<a id="line-2178" name="line-2178"></a><span class="cm"> * @item: A desktop item</span>
<a id="line-2179" name="line-2179"></a><span class="cm"> * @file_list:  Files/URIs to launch this item with, can be %NULL</span>
<a id="line-2180" name="line-2180"></a><span class="cm"> * @flags: FIXME</span>
<a id="line-2181" name="line-2181"></a><span class="cm"> * @envp: child&#39;s environment, or %NULL to inherit parent&#39;s</span>
<a id="line-2182" name="line-2182"></a><span class="cm"> * @error: FIXME</span>
<a id="line-2183" name="line-2183"></a><span class="cm"> *</span>
<a id="line-2184" name="line-2184"></a><span class="cm"> * See mate_desktop_item_launch for a full description. This function</span>
<a id="line-2185" name="line-2185"></a><span class="cm"> * additionally passes an environment vector for the child process</span>
<a id="line-2186" name="line-2186"></a><span class="cm"> * which is to be launched.</span>
<a id="line-2187" name="line-2187"></a><span class="cm"> *</span>
<a id="line-2188" name="line-2188"></a><span class="cm"> * Returns: The the pid of the process spawned.  If more then one</span>
<a id="line-2189" name="line-2189"></a><span class="cm"> * process was spawned the last pid is returned.  On error -1</span>
<a id="line-2190" name="line-2190"></a><span class="cm"> * is returned and @error is set.</span>
<a id="line-2191" name="line-2191"></a><span class="cm"> */</span>
<a id="line-2192" name="line-2192"></a><span class="kt">int</span>
<a id="line-2193" name="line-2193"></a><span class="nf">mate_desktop_item_launch_with_env</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w">       </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-2194" name="line-2194"></a><span class="w">				    </span><span class="n">GList</span><span class="w">                        </span><span class="o">*</span><span class="n">file_list</span><span class="p">,</span>
<a id="line-2195" name="line-2195"></a><span class="w">				    </span><span class="n">MateDesktopItemLaunchFlags</span><span class="w">   </span><span class="n">flags</span><span class="p">,</span>
<a id="line-2196" name="line-2196"></a><span class="w">				    </span><span class="kt">char</span><span class="w">                        </span><span class="o">**</span><span class="n">envp</span><span class="p">,</span>
<a id="line-2197" name="line-2197"></a><span class="w">				    </span><span class="n">GError</span><span class="w">                      </span><span class="o">**</span><span class="n">error</span><span class="p">)</span>
<a id="line-2198" name="line-2198"></a><span class="p">{</span>
<a id="line-2199" name="line-2199"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">mate_desktop_item_launch_on_screen_with_env</span><span class="w"> </span><span class="p">(</span>
<a id="line-2200" name="line-2200"></a><span class="w">			</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">file_list</span><span class="p">,</span><span class="w"> </span><span class="n">flags</span><span class="p">,</span>
<a id="line-2201" name="line-2201"></a><span class="w">			</span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="n">envp</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">);</span>
<a id="line-2202" name="line-2202"></a><span class="p">}</span>
<a id="line-2203" name="line-2203"></a>
<a id="line-2204" name="line-2204"></a><span class="cm">/**</span>
<a id="line-2205" name="line-2205"></a><span class="cm"> * mate_desktop_item_launch_on_screen:</span>
<a id="line-2206" name="line-2206"></a><span class="cm"> * @item: A desktop item</span>
<a id="line-2207" name="line-2207"></a><span class="cm"> * @file_list:  Files/URIs to launch this item with, can be %NULL</span>
<a id="line-2208" name="line-2208"></a><span class="cm"> * @flags: FIXME</span>
<a id="line-2209" name="line-2209"></a><span class="cm"> * @screen: the %GdkScreen on which the application should be launched</span>
<a id="line-2210" name="line-2210"></a><span class="cm"> * @workspace: the workspace on which the app should be launched (-1 for current)</span>
<a id="line-2211" name="line-2211"></a><span class="cm"> * @error: FIXME</span>
<a id="line-2212" name="line-2212"></a><span class="cm"> *</span>
<a id="line-2213" name="line-2213"></a><span class="cm"> * See mate_desktop_item_launch for a full description. This function</span>
<a id="line-2214" name="line-2214"></a><span class="cm"> * additionally attempts to launch the application on a given screen</span>
<a id="line-2215" name="line-2215"></a><span class="cm"> * and workspace.</span>
<a id="line-2216" name="line-2216"></a><span class="cm"> *</span>
<a id="line-2217" name="line-2217"></a><span class="cm"> * Returns: The the pid of the process spawned.  If more then one</span>
<a id="line-2218" name="line-2218"></a><span class="cm"> * process was spawned the last pid is returned.  On error -1</span>
<a id="line-2219" name="line-2219"></a><span class="cm"> * is returned and @error is set.</span>
<a id="line-2220" name="line-2220"></a><span class="cm"> */</span>
<a id="line-2221" name="line-2221"></a><span class="kt">int</span>
<a id="line-2222" name="line-2222"></a><span class="nf">mate_desktop_item_launch_on_screen</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w">       </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-2223" name="line-2223"></a><span class="w">				     </span><span class="n">GList</span><span class="w">                        </span><span class="o">*</span><span class="n">file_list</span><span class="p">,</span>
<a id="line-2224" name="line-2224"></a><span class="w">				     </span><span class="n">MateDesktopItemLaunchFlags</span><span class="w">   </span><span class="n">flags</span><span class="p">,</span>
<a id="line-2225" name="line-2225"></a><span class="w">				     </span><span class="n">GdkScreen</span><span class="w">                    </span><span class="o">*</span><span class="n">screen</span><span class="p">,</span>
<a id="line-2226" name="line-2226"></a><span class="w">				     </span><span class="kt">int</span><span class="w">                           </span><span class="n">workspace</span><span class="p">,</span>
<a id="line-2227" name="line-2227"></a><span class="w">				     </span><span class="n">GError</span><span class="w">                      </span><span class="o">**</span><span class="n">error</span><span class="p">)</span>
<a id="line-2228" name="line-2228"></a><span class="p">{</span>
<a id="line-2229" name="line-2229"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">mate_desktop_item_launch_on_screen_with_env</span><span class="w"> </span><span class="p">(</span>
<a id="line-2230" name="line-2230"></a><span class="w">			</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">file_list</span><span class="p">,</span><span class="w"> </span><span class="n">flags</span><span class="p">,</span>
<a id="line-2231" name="line-2231"></a><span class="w">			</span><span class="n">screen</span><span class="p">,</span><span class="w"> </span><span class="n">workspace</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">);</span>
<a id="line-2232" name="line-2232"></a><span class="p">}</span>
<a id="line-2233" name="line-2233"></a>
<a id="line-2234" name="line-2234"></a><span class="cm">/**</span>
<a id="line-2235" name="line-2235"></a><span class="cm"> * mate_desktop_item_drop_uri_list:</span>
<a id="line-2236" name="line-2236"></a><span class="cm"> * @item: A desktop item</span>
<a id="line-2237" name="line-2237"></a><span class="cm"> * @uri_list: text as gotten from a text/uri-list</span>
<a id="line-2238" name="line-2238"></a><span class="cm"> * @flags: FIXME</span>
<a id="line-2239" name="line-2239"></a><span class="cm"> * @error: FIXME</span>
<a id="line-2240" name="line-2240"></a><span class="cm"> *</span>
<a id="line-2241" name="line-2241"></a><span class="cm"> * A list of files or urls dropped onto an icon, the proper (Url or File)</span>
<a id="line-2242" name="line-2242"></a><span class="cm"> * exec is run you can pass directly string that you got as the</span>
<a id="line-2243" name="line-2243"></a><span class="cm"> * text/uri-list.  This just parses the list and calls</span>
<a id="line-2244" name="line-2244"></a><span class="cm"> *</span>
<a id="line-2245" name="line-2245"></a><span class="cm"> * Returns: The value returned by #mate_execute_async() upon execution of</span>
<a id="line-2246" name="line-2246"></a><span class="cm"> * the specified item or -1 on error.  If multiple instances are run, the</span>
<a id="line-2247" name="line-2247"></a><span class="cm"> * return of the last one is returned.</span>
<a id="line-2248" name="line-2248"></a><span class="cm"> */</span>
<a id="line-2249" name="line-2249"></a><span class="kt">int</span>
<a id="line-2250" name="line-2250"></a><span class="nf">mate_desktop_item_drop_uri_list</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-2251" name="line-2251"></a><span class="w">				  </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">uri_list</span><span class="p">,</span>
<a id="line-2252" name="line-2252"></a><span class="w">				  </span><span class="n">MateDesktopItemLaunchFlags</span><span class="w"> </span><span class="n">flags</span><span class="p">,</span>
<a id="line-2253" name="line-2253"></a><span class="w">				  </span><span class="n">GError</span><span class="w"> </span><span class="o">**</span><span class="n">error</span><span class="p">)</span>
<a id="line-2254" name="line-2254"></a><span class="p">{</span>
<a id="line-2255" name="line-2255"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">mate_desktop_item_drop_uri_list_with_env</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">uri_list</span><span class="p">,</span>
<a id="line-2256" name="line-2256"></a><span class="w">							  </span><span class="n">flags</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">);</span>
<a id="line-2257" name="line-2257"></a><span class="p">}</span>
<a id="line-2258" name="line-2258"></a>
<a id="line-2259" name="line-2259"></a><span class="cm">/**</span>
<a id="line-2260" name="line-2260"></a><span class="cm">* mate_desktop_item_drop_uri_list_with_env:</span>
<a id="line-2261" name="line-2261"></a><span class="cm">* @item: A desktop item</span>
<a id="line-2262" name="line-2262"></a><span class="cm">* @uri_list: text as gotten from a text/uri-list</span>
<a id="line-2263" name="line-2263"></a><span class="cm">* @flags: FIXME</span>
<a id="line-2264" name="line-2264"></a><span class="cm">* @envp: child&#39;s environment</span>
<a id="line-2265" name="line-2265"></a><span class="cm">* @error: FIXME</span>
<a id="line-2266" name="line-2266"></a><span class="cm">*</span>
<a id="line-2267" name="line-2267"></a><span class="cm">* See mate_desktop_item_drop_uri_list for a full description. This function</span>
<a id="line-2268" name="line-2268"></a><span class="cm">* additionally passes an environment vector for the child process</span>
<a id="line-2269" name="line-2269"></a><span class="cm">* which is to be launched.</span>
<a id="line-2270" name="line-2270"></a><span class="cm">*</span>
<a id="line-2271" name="line-2271"></a><span class="cm">* Returns: The value returned by #mate_execute_async() upon execution of</span>
<a id="line-2272" name="line-2272"></a><span class="cm">* the specified item or -1 on error.  If multiple instances are run, the</span>
<a id="line-2273" name="line-2273"></a><span class="cm">* return of the last one is returned.</span>
<a id="line-2274" name="line-2274"></a><span class="cm">*/</span>
<a id="line-2275" name="line-2275"></a><span class="kt">int</span>
<a id="line-2276" name="line-2276"></a><span class="nf">mate_desktop_item_drop_uri_list_with_env</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-2277" name="line-2277"></a><span class="w">					   </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">uri_list</span><span class="p">,</span>
<a id="line-2278" name="line-2278"></a><span class="w">					   </span><span class="n">MateDesktopItemLaunchFlags</span><span class="w"> </span><span class="n">flags</span><span class="p">,</span>
<a id="line-2279" name="line-2279"></a><span class="w">					   </span><span class="kt">char</span><span class="w">                        </span><span class="o">**</span><span class="n">envp</span><span class="p">,</span>
<a id="line-2280" name="line-2280"></a><span class="w">					   </span><span class="n">GError</span><span class="w"> </span><span class="o">**</span><span class="n">error</span><span class="p">)</span>
<a id="line-2281" name="line-2281"></a><span class="p">{</span>
<a id="line-2282" name="line-2282"></a><span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<a id="line-2283" name="line-2283"></a><span class="w">	</span><span class="kt">char</span><span class="w">  </span><span class="o">*</span><span class="n">uri</span><span class="p">;</span>
<a id="line-2284" name="line-2284"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">uris</span><span class="p">;</span>
<a id="line-2285" name="line-2285"></a><span class="w">	</span><span class="n">GList</span><span class="w"> </span><span class="o">*</span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-2286" name="line-2286"></a>
<a id="line-2287" name="line-2287"></a><span class="w">	</span><span class="n">uris</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_uri_list_extract_uris</span><span class="w"> </span><span class="p">(</span><span class="n">uri_list</span><span class="p">);</span>
<a id="line-2288" name="line-2288"></a>
<a id="line-2289" name="line-2289"></a><span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uris</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w"> </span><span class="n">uri</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"> </span><span class="n">uri</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-2290" name="line-2290"></a><span class="w">		</span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_list_prepend</span><span class="w"> </span><span class="p">(</span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="n">uri</span><span class="p">);</span>
<a id="line-2291" name="line-2291"></a><span class="w">	</span><span class="p">}</span>
<a id="line-2292" name="line-2292"></a><span class="w">	</span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_list_reverse</span><span class="w"> </span><span class="p">(</span><span class="n">list</span><span class="p">);</span>
<a id="line-2293" name="line-2293"></a>
<a id="line-2294" name="line-2294"></a><span class="w">	</span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">mate_desktop_item_launch_with_env</span><span class="w"> </span><span class="p">(</span>
<a id="line-2295" name="line-2295"></a><span class="w">			</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="n">flags</span><span class="p">,</span><span class="w"> </span><span class="n">envp</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">);</span>
<a id="line-2296" name="line-2296"></a>
<a id="line-2297" name="line-2297"></a><span class="w">	</span><span class="n">g_strfreev</span><span class="w"> </span><span class="p">(</span><span class="n">uris</span><span class="p">);</span>
<a id="line-2298" name="line-2298"></a><span class="w">	</span><span class="n">g_list_free</span><span class="w"> </span><span class="p">(</span><span class="n">list</span><span class="p">);</span>
<a id="line-2299" name="line-2299"></a>
<a id="line-2300" name="line-2300"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<a id="line-2301" name="line-2301"></a><span class="p">}</span>
<a id="line-2302" name="line-2302"></a>
<a id="line-2303" name="line-2303"></a><span class="k">static</span><span class="w"> </span><span class="n">gboolean</span>
<a id="line-2304" name="line-2304"></a><span class="nf">exec_exists</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">exec</span><span class="p">)</span>
<a id="line-2305" name="line-2305"></a><span class="p">{</span>
<a id="line-2306" name="line-2306"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">g_path_is_absolute</span><span class="w"> </span><span class="p">(</span><span class="n">exec</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="line-2307" name="line-2307"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">access</span><span class="w"> </span><span class="p">(</span><span class="n">exec</span><span class="p">,</span><span class="w"> </span><span class="n">X_OK</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<a id="line-2308" name="line-2308"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
<a id="line-2309" name="line-2309"></a><span class="w">		</span><span class="k">else</span>
<a id="line-2310" name="line-2310"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-2311" name="line-2311"></a><span class="w">	</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-2312" name="line-2312"></a><span class="w">		</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">tryme</span><span class="p">;</span>
<a id="line-2313" name="line-2313"></a>
<a id="line-2314" name="line-2314"></a><span class="w">		</span><span class="n">tryme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_find_program_in_path</span><span class="w"> </span><span class="p">(</span><span class="n">exec</span><span class="p">);</span>
<a id="line-2315" name="line-2315"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tryme</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-2316" name="line-2316"></a><span class="w">			</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">tryme</span><span class="p">);</span>
<a id="line-2317" name="line-2317"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
<a id="line-2318" name="line-2318"></a><span class="w">		</span><span class="p">}</span>
<a id="line-2319" name="line-2319"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-2320" name="line-2320"></a><span class="w">	</span><span class="p">}</span>
<a id="line-2321" name="line-2321"></a><span class="p">}</span>
<a id="line-2322" name="line-2322"></a>
<a id="line-2323" name="line-2323"></a><span class="cm">/**</span>
<a id="line-2324" name="line-2324"></a><span class="cm"> * mate_desktop_item_exists:</span>
<a id="line-2325" name="line-2325"></a><span class="cm"> * @item: A desktop item</span>
<a id="line-2326" name="line-2326"></a><span class="cm"> *</span>
<a id="line-2327" name="line-2327"></a><span class="cm"> * Attempt to figure out if the program that can be executed by this item</span>
<a id="line-2328" name="line-2328"></a><span class="cm"> * actually exists.  First it tries the TryExec attribute to see if that</span>
<a id="line-2329" name="line-2329"></a><span class="cm"> * contains a program that is in the path.  Then if there is no such</span>
<a id="line-2330" name="line-2330"></a><span class="cm"> * attribute, it tries the first word of the Exec attribute.</span>
<a id="line-2331" name="line-2331"></a><span class="cm"> *</span>
<a id="line-2332" name="line-2332"></a><span class="cm"> * Returns: A boolean, %TRUE if it exists, %FALSE otherwise.</span>
<a id="line-2333" name="line-2333"></a><span class="cm"> */</span>
<a id="line-2334" name="line-2334"></a><span class="n">gboolean</span>
<a id="line-2335" name="line-2335"></a><span class="nf">mate_desktop_item_exists</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">)</span>
<a id="line-2336" name="line-2336"></a><span class="p">{</span>
<a id="line-2337" name="line-2337"></a><span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">try_exec</span><span class="p">;</span>
<a id="line-2338" name="line-2338"></a><span class="hll"><span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">exec</span><span class="p">;</span><div class="verbose expandable"><span class="error2">&lt;--- The scope of the variable 'exec' can be reduced. <span class="marker">[+]</span></span><div class="content">The scope of the variable &apos;exec&apos; can be reduced. Warning: Be careful when fixing this message, especially when there are inner loops. Here is an example where cppcheck will write that the scope for &apos;i&apos; can be reduced:
void f(int x)
{
    int i = 0;
    if (x) {
        // it&apos;s safe to move &apos;int i = 0;&apos; here
        for (int n = 0; n &lt; 10; ++n) {
            // it is possible but not safe to move &apos;int i = 0;&apos; here
            do_something(&amp;i);
        }
    }
}
When you see this message it is always safe to reduce the variable scope 1 level.</div></div>
</span><a id="line-2339" name="line-2339"></a>
<a id="line-2340" name="line-2340"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">FALSE</span><span class="p">);</span>
<a id="line-2341" name="line-2341"></a>
<a id="line-2342" name="line-2342"></a><span class="w">	</span><span class="n">try_exec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lookup</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TRY_EXEC</span><span class="p">);</span>
<a id="line-2343" name="line-2343"></a>
<a id="line-2344" name="line-2344"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">try_exec</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<a id="line-2345" name="line-2345"></a><span class="w">	    </span><span class="o">!</span><span class="w"> </span><span class="n">exec_exists</span><span class="w"> </span><span class="p">(</span><span class="n">try_exec</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="line-2346" name="line-2346"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-2347" name="line-2347"></a><span class="w">	</span><span class="p">}</span>
<a id="line-2348" name="line-2348"></a>
<a id="line-2349" name="line-2349"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TYPE_APPLICATION</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-2350" name="line-2350"></a><span class="w">		</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">;</span>
<a id="line-2351" name="line-2351"></a><span class="w">		</span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">argv</span><span class="p">;</span>
<a id="line-2352" name="line-2352"></a><span class="w">		</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">exe</span><span class="p">;</span>
<a id="line-2353" name="line-2353"></a>
<a id="line-2354" name="line-2354"></a><span class="w">		</span><span class="n">exec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lookup</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_EXEC</span><span class="p">);</span>
<a id="line-2355" name="line-2355"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">exec</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-2356" name="line-2356"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-2357" name="line-2357"></a>
<a id="line-2358" name="line-2358"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="n">g_shell_parse_argv</span><span class="w"> </span><span class="p">(</span><span class="n">exec</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">argv</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">))</span>
<a id="line-2359" name="line-2359"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-2360" name="line-2360"></a>
<a id="line-2361" name="line-2361"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">argc</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-2362" name="line-2362"></a><span class="w">			</span><span class="n">g_strfreev</span><span class="w"> </span><span class="p">(</span><span class="n">argv</span><span class="p">);</span>
<a id="line-2363" name="line-2363"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-2364" name="line-2364"></a><span class="w">		</span><span class="p">}</span>
<a id="line-2365" name="line-2365"></a>
<a id="line-2366" name="line-2366"></a><span class="w">		</span><span class="n">exe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<a id="line-2367" name="line-2367"></a>
<a id="line-2368" name="line-2368"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="n">exec_exists</span><span class="w"> </span><span class="p">(</span><span class="n">exe</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="line-2369" name="line-2369"></a><span class="w">			</span><span class="n">g_strfreev</span><span class="w"> </span><span class="p">(</span><span class="n">argv</span><span class="p">);</span>
<a id="line-2370" name="line-2370"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-2371" name="line-2371"></a><span class="w">		</span><span class="p">}</span>
<a id="line-2372" name="line-2372"></a><span class="w">		</span><span class="n">g_strfreev</span><span class="w"> </span><span class="p">(</span><span class="n">argv</span><span class="p">);</span>
<a id="line-2373" name="line-2373"></a><span class="w">	</span><span class="p">}</span>
<a id="line-2374" name="line-2374"></a>
<a id="line-2375" name="line-2375"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
<a id="line-2376" name="line-2376"></a><span class="p">}</span>
<a id="line-2377" name="line-2377"></a>
<a id="line-2378" name="line-2378"></a><span class="cm">/**</span>
<a id="line-2379" name="line-2379"></a><span class="cm"> * mate_desktop_item_get_entry_type:</span>
<a id="line-2380" name="line-2380"></a><span class="cm"> * @item: A desktop item</span>
<a id="line-2381" name="line-2381"></a><span class="cm"> *</span>
<a id="line-2382" name="line-2382"></a><span class="cm"> * Gets the type attribute (the &#39;Type&#39; field) of the item.  This should</span>
<a id="line-2383" name="line-2383"></a><span class="cm"> * usually be &#39;Application&#39; for an application, but it can be &#39;Directory&#39;</span>
<a id="line-2384" name="line-2384"></a><span class="cm"> * for a directory description.  There are other types available as well.</span>
<a id="line-2385" name="line-2385"></a><span class="cm"> * The type usually indicates how the desktop item should be handeled and</span>
<a id="line-2386" name="line-2386"></a><span class="cm"> * how the &#39;Exec&#39; field should be handeled.</span>
<a id="line-2387" name="line-2387"></a><span class="cm"> *</span>
<a id="line-2388" name="line-2388"></a><span class="cm"> * Returns: The type of the specified &#39;item&#39;. The returned</span>
<a id="line-2389" name="line-2389"></a><span class="cm"> * memory remains owned by the MateDesktopItem and should not be freed.</span>
<a id="line-2390" name="line-2390"></a><span class="cm"> */</span>
<a id="line-2391" name="line-2391"></a><span class="n">MateDesktopItemType</span>
<a id="line-2392" name="line-2392"></a><span class="nf">mate_desktop_item_get_entry_type</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">)</span>
<a id="line-2393" name="line-2393"></a><span class="p">{</span>
<a id="line-2394" name="line-2394"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<a id="line-2395" name="line-2395"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<a id="line-2396" name="line-2396"></a>
<a id="line-2397" name="line-2397"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">item</span><span class="o">-&gt;</span><span class="n">type</span><span class="p">;</span>
<a id="line-2398" name="line-2398"></a><span class="p">}</span>
<a id="line-2399" name="line-2399"></a>
<a id="line-2400" name="line-2400"></a><span class="kt">void</span>
<a id="line-2401" name="line-2401"></a><span class="nf">mate_desktop_item_set_entry_type</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-2402" name="line-2402"></a><span class="w">				   </span><span class="n">MateDesktopItemType</span><span class="w"> </span><span class="n">type</span><span class="p">)</span>
<a id="line-2403" name="line-2403"></a><span class="p">{</span>
<a id="line-2404" name="line-2404"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2405" name="line-2405"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<a id="line-2406" name="line-2406"></a>
<a id="line-2407" name="line-2407"></a><span class="w">	</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">type</span><span class="p">;</span>
<a id="line-2408" name="line-2408"></a>
<a id="line-2409" name="line-2409"></a><span class="w">	</span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-2410" name="line-2410"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="no">MATE_DESKTOP_ITEM_TYPE_NULL</span><span class="p">:</span>
<a id="line-2411" name="line-2411"></a><span class="w">		</span><span class="n">set</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TYPE</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2412" name="line-2412"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-2413" name="line-2413"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="no">MATE_DESKTOP_ITEM_TYPE_APPLICATION</span><span class="p">:</span>
<a id="line-2414" name="line-2414"></a><span class="w">		</span><span class="n">set</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TYPE</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Application&quot;</span><span class="p">);</span>
<a id="line-2415" name="line-2415"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-2416" name="line-2416"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="no">MATE_DESKTOP_ITEM_TYPE_LINK</span><span class="p">:</span>
<a id="line-2417" name="line-2417"></a><span class="w">		</span><span class="n">set</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TYPE</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Link&quot;</span><span class="p">);</span>
<a id="line-2418" name="line-2418"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-2419" name="line-2419"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="no">MATE_DESKTOP_ITEM_TYPE_FSDEVICE</span><span class="p">:</span>
<a id="line-2420" name="line-2420"></a><span class="w">		</span><span class="n">set</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TYPE</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;FSDevice&quot;</span><span class="p">);</span>
<a id="line-2421" name="line-2421"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-2422" name="line-2422"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="no">MATE_DESKTOP_ITEM_TYPE_MIME_TYPE</span><span class="p">:</span>
<a id="line-2423" name="line-2423"></a><span class="w">		</span><span class="n">set</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TYPE</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;MimeType&quot;</span><span class="p">);</span>
<a id="line-2424" name="line-2424"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-2425" name="line-2425"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="no">MATE_DESKTOP_ITEM_TYPE_DIRECTORY</span><span class="p">:</span>
<a id="line-2426" name="line-2426"></a><span class="w">		</span><span class="n">set</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TYPE</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Directory&quot;</span><span class="p">);</span>
<a id="line-2427" name="line-2427"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-2428" name="line-2428"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="no">MATE_DESKTOP_ITEM_TYPE_SERVICE</span><span class="p">:</span>
<a id="line-2429" name="line-2429"></a><span class="w">		</span><span class="n">set</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TYPE</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Service&quot;</span><span class="p">);</span>
<a id="line-2430" name="line-2430"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-2431" name="line-2431"></a><span class="w">	</span><span class="k">case</span><span class="w"> </span><span class="no">MATE_DESKTOP_ITEM_TYPE_SERVICE_TYPE</span><span class="p">:</span>
<a id="line-2432" name="line-2432"></a><span class="w">		</span><span class="n">set</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TYPE</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ServiceType&quot;</span><span class="p">);</span>
<a id="line-2433" name="line-2433"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-2434" name="line-2434"></a><span class="w">	</span><span class="k">default</span><span class="o">:</span>
<a id="line-2435" name="line-2435"></a><span class="w">		</span><span class="k">break</span><span class="p">;</span>
<a id="line-2436" name="line-2436"></a><span class="w">	</span><span class="p">}</span>
<a id="line-2437" name="line-2437"></a><span class="p">}</span>
<a id="line-2438" name="line-2438"></a>
<a id="line-2439" name="line-2439"></a><span class="cm">/**</span>
<a id="line-2440" name="line-2440"></a><span class="cm"> * mate_desktop_item_get_file_status:</span>
<a id="line-2441" name="line-2441"></a><span class="cm"> * @item: A desktop item</span>
<a id="line-2442" name="line-2442"></a><span class="cm"> *</span>
<a id="line-2443" name="line-2443"></a><span class="cm"> * This function checks the modification time of the on-disk file to</span>
<a id="line-2444" name="line-2444"></a><span class="cm"> * see if it is more recent than the in-memory data.</span>
<a id="line-2445" name="line-2445"></a><span class="cm"> *</span>
<a id="line-2446" name="line-2446"></a><span class="cm"> * Returns: An enum value that specifies whether the item has changed since being loaded.</span>
<a id="line-2447" name="line-2447"></a><span class="cm"> */</span>
<a id="line-2448" name="line-2448"></a><span class="n">MateDesktopItemStatus</span>
<a id="line-2449" name="line-2449"></a><span class="nf">mate_desktop_item_get_file_status</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">)</span>
<a id="line-2450" name="line-2450"></a><span class="p">{</span>
<a id="line-2451" name="line-2451"></a><span class="w">	</span><span class="n">MateDesktopItemStatus</span><span class="w"> </span><span class="n">retval</span><span class="p">;</span>
<a id="line-2452" name="line-2452"></a><span class="w">	</span><span class="n">GFile</span><span class="w"> </span><span class="o">*</span><span class="n">file</span><span class="p">;</span>
<a id="line-2453" name="line-2453"></a><span class="w">	</span><span class="n">GFileInfo</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">;</span>
<a id="line-2454" name="line-2454"></a>
<a id="line-2455" name="line-2455"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_DISAPPEARED</span><span class="p">);</span>
<a id="line-2456" name="line-2456"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_DISAPPEARED</span><span class="p">);</span>
<a id="line-2457" name="line-2457"></a>
<a id="line-2458" name="line-2458"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">location</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-2459" name="line-2459"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_DISAPPEARED</span><span class="p">;</span>
<a id="line-2460" name="line-2460"></a>
<a id="line-2461" name="line-2461"></a><span class="w">	</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_new_for_uri</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">location</span><span class="p">);</span>
<a id="line-2462" name="line-2462"></a><span class="w">	</span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_query_info</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">G_FILE_ATTRIBUTE_TIME_MODIFIED</span><span class="p">,</span>
<a id="line-2463" name="line-2463"></a><span class="w">				  </span><span class="n">G_FILE_QUERY_INFO_NONE</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2464" name="line-2464"></a>
<a id="line-2465" name="line-2465"></a><span class="w">	</span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_UNCHANGED</span><span class="p">;</span>
<a id="line-2466" name="line-2466"></a>
<a id="line-2467" name="line-2467"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">g_file_info_has_attribute</span><span class="w"> </span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="w"> </span><span class="n">G_FILE_ATTRIBUTE_TIME_MODIFIED</span><span class="p">))</span>
<a id="line-2468" name="line-2468"></a><span class="w">		</span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_DISAPPEARED</span><span class="p">;</span>
<a id="line-2469" name="line-2469"></a><span class="w">	</span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(((</span><span class="n">guint64</span><span class="p">)</span><span class="w"> </span><span class="n">item</span><span class="o">-&gt;</span><span class="n">mtime</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">g_file_info_get_attribute_uint64</span><span class="w"> </span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="w"> </span><span class="n">G_FILE_ATTRIBUTE_TIME_MODIFIED</span><span class="p">))</span>
<a id="line-2470" name="line-2470"></a><span class="w">		</span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_CHANGED</span><span class="p">;</span>
<a id="line-2471" name="line-2471"></a>
<a id="line-2472" name="line-2472"></a><span class="w">	</span><span class="n">g_object_unref</span><span class="w"> </span><span class="p">(</span><span class="n">info</span><span class="p">);</span>
<a id="line-2473" name="line-2473"></a><span class="w">	</span><span class="n">g_object_unref</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<a id="line-2474" name="line-2474"></a>
<a id="line-2475" name="line-2475"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">retval</span><span class="p">;</span>
<a id="line-2476" name="line-2476"></a><span class="p">}</span>
<a id="line-2477" name="line-2477"></a>
<a id="line-2478" name="line-2478"></a><span class="cm">/**</span>
<a id="line-2479" name="line-2479"></a><span class="cm"> * mate_desktop_item_find_icon:</span>
<a id="line-2480" name="line-2480"></a><span class="cm"> * @icon_theme: a #GtkIconTheme</span>
<a id="line-2481" name="line-2481"></a><span class="cm"> * @icon: icon name, something you&#39;d get out of the Icon key</span>
<a id="line-2482" name="line-2482"></a><span class="cm"> * @desired_size: FIXME</span>
<a id="line-2483" name="line-2483"></a><span class="cm"> * @flags: FIXME</span>
<a id="line-2484" name="line-2484"></a><span class="cm"> *</span>
<a id="line-2485" name="line-2485"></a><span class="cm"> * Description:  This function goes and looks for the icon file.  If the icon</span>
<a id="line-2486" name="line-2486"></a><span class="cm"> * is not an absolute filename, this will look for it in the standard places.</span>
<a id="line-2487" name="line-2487"></a><span class="cm"> * If it can&#39;t find the icon, it will return %NULL</span>
<a id="line-2488" name="line-2488"></a><span class="cm"> *</span>
<a id="line-2489" name="line-2489"></a><span class="cm"> * Returns: A newly allocated string</span>
<a id="line-2490" name="line-2490"></a><span class="cm"> */</span>
<a id="line-2491" name="line-2491"></a><span class="kt">char</span><span class="w"> </span><span class="o">*</span>
<a id="line-2492" name="line-2492"></a><span class="nf">mate_desktop_item_find_icon</span><span class="w"> </span><span class="p">(</span><span class="n">GtkIconTheme</span><span class="w"> </span><span class="o">*</span><span class="n">icon_theme</span><span class="p">,</span>
<a id="line-2493" name="line-2493"></a><span class="w">			      </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">icon</span><span class="p">,</span>
<a id="line-2494" name="line-2494"></a><span class="w">			      </span><span class="kt">int</span><span class="w"> </span><span class="n">desired_size</span><span class="p">,</span>
<a id="line-2495" name="line-2495"></a><span class="w">			      </span><span class="kt">int</span><span class="w"> </span><span class="n">flags</span><span class="p">)</span>
<a id="line-2496" name="line-2496"></a><span class="p">{</span>
<a id="line-2497" name="line-2497"></a><span class="hll"><span class="w">	</span><span class="n">GtkIconInfo</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">;</span><div class="verbose expandable"><span class="error2">&lt;--- The scope of the variable 'info' can be reduced. <span class="marker">[+]</span></span><div class="content">The scope of the variable &apos;info&apos; can be reduced. Warning: Be careful when fixing this message, especially when there are inner loops. Here is an example where cppcheck will write that the scope for &apos;i&apos; can be reduced:
void f(int x)
{
    int i = 0;
    if (x) {
        // it&apos;s safe to move &apos;int i = 0;&apos; here
        for (int n = 0; n &lt; 10; ++n) {
            // it is possible but not safe to move &apos;int i = 0;&apos; here
            do_something(&amp;i);
        }
    }
}
When you see this message it is always safe to reduce the variable scope 1 level.</div></div>
</span><a id="line-2498" name="line-2498"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">full</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-2499" name="line-2499"></a>
<a id="line-2500" name="line-2500"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">icon_theme</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">||</span>
<a id="line-2501" name="line-2501"></a><span class="w">			      </span><span class="n">GTK_IS_ICON_THEME</span><span class="w"> </span><span class="p">(</span><span class="n">icon_theme</span><span class="p">),</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2502" name="line-2502"></a>
<a id="line-2503" name="line-2503"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">icon</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">strcmp</span><span class="p">(</span><span class="n">icon</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-2504" name="line-2504"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-2505" name="line-2505"></a><span class="w">	</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">g_path_is_absolute</span><span class="w"> </span><span class="p">(</span><span class="n">icon</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="line-2506" name="line-2506"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">g_file_test</span><span class="w"> </span><span class="p">(</span><span class="n">icon</span><span class="p">,</span><span class="w"> </span><span class="n">G_FILE_TEST_EXISTS</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="line-2507" name="line-2507"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">icon</span><span class="p">);</span>
<a id="line-2508" name="line-2508"></a><span class="w">		</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-2509" name="line-2509"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-2510" name="line-2510"></a><span class="w">		</span><span class="p">}</span>
<a id="line-2511" name="line-2511"></a><span class="w">	</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-2512" name="line-2512"></a><span class="w">		</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">icon_no_extension</span><span class="p">;</span>
<a id="line-2513" name="line-2513"></a><span class="w">		</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">;</span>
<a id="line-2514" name="line-2514"></a>
<a id="line-2515" name="line-2515"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">icon_theme</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-2516" name="line-2516"></a><span class="w">			</span><span class="n">icon_theme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtk_icon_theme_get_default</span><span class="w"> </span><span class="p">();</span>
<a id="line-2517" name="line-2517"></a>
<a id="line-2518" name="line-2518"></a><span class="w">		</span><span class="n">icon_no_extension</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">icon</span><span class="p">);</span>
<a id="line-2519" name="line-2519"></a><span class="w">		</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strrchr</span><span class="w"> </span><span class="p">(</span><span class="n">icon_no_extension</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;.&#39;</span><span class="p">);</span>
<a id="line-2520" name="line-2520"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<a id="line-2521" name="line-2521"></a><span class="w">		    </span><span class="p">(</span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;.png&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">||</span>
<a id="line-2522" name="line-2522"></a><span class="w">		     </span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;.xpm&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">||</span>
<a id="line-2523" name="line-2523"></a><span class="w">		     </span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;.svg&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="line-2524" name="line-2524"></a><span class="w">		    </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="line-2525" name="line-2525"></a><span class="w">		</span><span class="p">}</span>
<a id="line-2526" name="line-2526"></a>
<a id="line-2527" name="line-2527"></a><span class="w">		</span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gtk_icon_theme_lookup_icon</span><span class="w"> </span><span class="p">(</span><span class="n">icon_theme</span><span class="p">,</span>
<a id="line-2528" name="line-2528"></a><span class="w">						   </span><span class="n">icon_no_extension</span><span class="p">,</span>
<a id="line-2529" name="line-2529"></a><span class="w">						   </span><span class="n">desired_size</span><span class="p">,</span>
<a id="line-2530" name="line-2530"></a><span class="w">						   </span><span class="mi">0</span><span class="p">);</span>
<a id="line-2531" name="line-2531"></a>
<a id="line-2532" name="line-2532"></a><span class="w">		</span><span class="n">full</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-2533" name="line-2533"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">info</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-2534" name="line-2534"></a><span class="w">			</span><span class="n">full</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">gtk_icon_info_get_filename</span><span class="w"> </span><span class="p">(</span><span class="n">info</span><span class="p">));</span>
<a id="line-2535" name="line-2535"></a><span class="w">			</span><span class="n">g_object_unref</span><span class="w"> </span><span class="p">(</span><span class="n">info</span><span class="p">);</span>
<a id="line-2536" name="line-2536"></a><span class="w">		</span><span class="p">}</span>
<a id="line-2537" name="line-2537"></a><span class="w">		</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">icon_no_extension</span><span class="p">);</span>
<a id="line-2538" name="line-2538"></a><span class="w">	</span><span class="p">}</span>
<a id="line-2539" name="line-2539"></a>
<a id="line-2540" name="line-2540"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">full</span><span class="p">;</span>
<a id="line-2541" name="line-2541"></a>
<a id="line-2542" name="line-2542"></a><span class="p">}</span>
<a id="line-2543" name="line-2543"></a>
<a id="line-2544" name="line-2544"></a><span class="cm">/**</span>
<a id="line-2545" name="line-2545"></a><span class="cm"> * mate_desktop_item_get_icon:</span>
<a id="line-2546" name="line-2546"></a><span class="cm"> * @icon_theme: a #GtkIconTheme</span>
<a id="line-2547" name="line-2547"></a><span class="cm"> * @item: A desktop item</span>
<a id="line-2548" name="line-2548"></a><span class="cm"> *</span>
<a id="line-2549" name="line-2549"></a><span class="cm"> * Description:  This function goes and looks for the icon file.  If the icon</span>
<a id="line-2550" name="line-2550"></a><span class="cm"> * is not set as an absolute filename, this will look for it in the standard places.</span>
<a id="line-2551" name="line-2551"></a><span class="cm"> * If it can&#39;t find the icon, it will return %NULL</span>
<a id="line-2552" name="line-2552"></a><span class="cm"> *</span>
<a id="line-2553" name="line-2553"></a><span class="cm"> * Returns: A newly allocated string</span>
<a id="line-2554" name="line-2554"></a><span class="cm"> */</span>
<a id="line-2555" name="line-2555"></a><span class="kt">char</span><span class="w"> </span><span class="o">*</span>
<a id="line-2556" name="line-2556"></a><span class="nf">mate_desktop_item_get_icon</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-2557" name="line-2557"></a><span class="w">			     </span><span class="n">GtkIconTheme</span><span class="w"> </span><span class="o">*</span><span class="n">icon_theme</span><span class="p">)</span>
<a id="line-2558" name="line-2558"></a><span class="p">{</span>
<a id="line-2559" name="line-2559"></a><span class="w">	</span><span class="cm">/* maybe this function should be deprecated in favour of find icon</span>
<a id="line-2560" name="line-2560"></a><span class="cm">	 * -George */</span>
<a id="line-2561" name="line-2561"></a><span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">icon</span><span class="p">;</span>
<a id="line-2562" name="line-2562"></a>
<a id="line-2563" name="line-2563"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2564" name="line-2564"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2565" name="line-2565"></a>
<a id="line-2566" name="line-2566"></a><span class="w">	</span><span class="n">icon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mate_desktop_item_get_string</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_ICON</span><span class="p">);</span>
<a id="line-2567" name="line-2567"></a>
<a id="line-2568" name="line-2568"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">mate_desktop_item_find_icon</span><span class="w"> </span><span class="p">(</span><span class="n">icon_theme</span><span class="p">,</span><span class="w"> </span><span class="n">icon</span><span class="p">,</span>
<a id="line-2569" name="line-2569"></a><span class="w">					     </span><span class="mi">48</span><span class="w"> </span><span class="cm">/* desired_size */</span><span class="p">,</span>
<a id="line-2570" name="line-2570"></a><span class="w">					     </span><span class="mi">0</span><span class="w"> </span><span class="cm">/* flags */</span><span class="p">);</span>
<a id="line-2571" name="line-2571"></a><span class="p">}</span>
<a id="line-2572" name="line-2572"></a>
<a id="line-2573" name="line-2573"></a><span class="cm">/**</span>
<a id="line-2574" name="line-2574"></a><span class="cm"> * mate_desktop_item_get_location:</span>
<a id="line-2575" name="line-2575"></a><span class="cm"> * @item: A desktop item</span>
<a id="line-2576" name="line-2576"></a><span class="cm"> *</span>
<a id="line-2577" name="line-2577"></a><span class="cm"> * Returns: The file location associated with &#39;item&#39;.</span>
<a id="line-2578" name="line-2578"></a><span class="cm"> *</span>
<a id="line-2579" name="line-2579"></a><span class="cm"> */</span>
<a id="line-2580" name="line-2580"></a><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span>
<a id="line-2581" name="line-2581"></a><span class="nf">mate_desktop_item_get_location</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">)</span>
<a id="line-2582" name="line-2582"></a><span class="p">{</span>
<a id="line-2583" name="line-2583"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2584" name="line-2584"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2585" name="line-2585"></a>
<a id="line-2586" name="line-2586"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">item</span><span class="o">-&gt;</span><span class="n">location</span><span class="p">;</span>
<a id="line-2587" name="line-2587"></a><span class="p">}</span>
<a id="line-2588" name="line-2588"></a>
<a id="line-2589" name="line-2589"></a><span class="cm">/**</span>
<a id="line-2590" name="line-2590"></a><span class="cm"> * mate_desktop_item_set_location:</span>
<a id="line-2591" name="line-2591"></a><span class="cm"> * @item: A desktop item</span>
<a id="line-2592" name="line-2592"></a><span class="cm"> * @location: A uri string specifying the file location of this particular item.</span>
<a id="line-2593" name="line-2593"></a><span class="cm"> *</span>
<a id="line-2594" name="line-2594"></a><span class="cm"> * Set&#39;s the &#39;location&#39; uri of this item.</span>
<a id="line-2595" name="line-2595"></a><span class="cm"> */</span>
<a id="line-2596" name="line-2596"></a><span class="kt">void</span>
<a id="line-2597" name="line-2597"></a><span class="nf">mate_desktop_item_set_location</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">location</span><span class="p">)</span>
<a id="line-2598" name="line-2598"></a><span class="p">{</span>
<a id="line-2599" name="line-2599"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2600" name="line-2600"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<a id="line-2601" name="line-2601"></a>
<a id="line-2602" name="line-2602"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">location</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<a id="line-2603" name="line-2603"></a><span class="w">	    </span><span class="n">location</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<a id="line-2604" name="line-2604"></a><span class="w">	    </span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">location</span><span class="p">,</span><span class="w"> </span><span class="n">location</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<a id="line-2605" name="line-2605"></a><span class="w">		</span><span class="k">return</span><span class="p">;</span>
<a id="line-2606" name="line-2606"></a>
<a id="line-2607" name="line-2607"></a><span class="w">	</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">location</span><span class="p">);</span>
<a id="line-2608" name="line-2608"></a><span class="w">	</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">location</span><span class="p">);</span>
<a id="line-2609" name="line-2609"></a>
<a id="line-2610" name="line-2610"></a><span class="w">	</span><span class="cm">/* This is ugly, but useful internally */</span>
<a id="line-2611" name="line-2611"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">mtime</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">DONT_UPDATE_MTIME</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-2612" name="line-2612"></a><span class="w">		</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">mtime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="line-2613" name="line-2613"></a>
<a id="line-2614" name="line-2614"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">location</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-2615" name="line-2615"></a><span class="w">			</span><span class="n">GFile</span><span class="w">     </span><span class="o">*</span><span class="n">file</span><span class="p">;</span>
<a id="line-2616" name="line-2616"></a><span class="w">			</span><span class="n">GFileInfo</span><span class="w"> </span><span class="o">*</span><span class="n">info</span><span class="p">;</span>
<a id="line-2617" name="line-2617"></a>
<a id="line-2618" name="line-2618"></a><span class="w">			</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_new_for_uri</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">location</span><span class="p">);</span>
<a id="line-2619" name="line-2619"></a>
<a id="line-2620" name="line-2620"></a><span class="w">			</span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_query_info</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">,</span>
<a id="line-2621" name="line-2621"></a><span class="w">						  </span><span class="n">G_FILE_ATTRIBUTE_TIME_MODIFIED</span><span class="p">,</span>
<a id="line-2622" name="line-2622"></a><span class="w">						  </span><span class="n">G_FILE_QUERY_INFO_NONE</span><span class="p">,</span>
<a id="line-2623" name="line-2623"></a><span class="w">						  </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2624" name="line-2624"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">info</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-2625" name="line-2625"></a><span class="w">				</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">g_file_info_has_attribute</span><span class="w"> </span><span class="p">(</span><span class="n">info</span><span class="p">,</span>
<a id="line-2626" name="line-2626"></a><span class="w">							       </span><span class="n">G_FILE_ATTRIBUTE_TIME_MODIFIED</span><span class="p">))</span>
<a id="line-2627" name="line-2627"></a><span class="w">					</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">mtime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_info_get_attribute_uint64</span><span class="w"> </span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="w"> </span><span class="n">G_FILE_ATTRIBUTE_TIME_MODIFIED</span><span class="p">);</span>
<a id="line-2628" name="line-2628"></a><span class="w">				</span><span class="n">g_object_unref</span><span class="w"> </span><span class="p">(</span><span class="n">info</span><span class="p">);</span>
<a id="line-2629" name="line-2629"></a><span class="w">			</span><span class="p">}</span>
<a id="line-2630" name="line-2630"></a>
<a id="line-2631" name="line-2631"></a><span class="w">			</span><span class="n">g_object_unref</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<a id="line-2632" name="line-2632"></a><span class="w">		</span><span class="p">}</span>
<a id="line-2633" name="line-2633"></a><span class="w">	</span><span class="p">}</span>
<a id="line-2634" name="line-2634"></a>
<a id="line-2635" name="line-2635"></a><span class="w">	</span><span class="cm">/* Make sure that save actually saves */</span>
<a id="line-2636" name="line-2636"></a><span class="w">	</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">modified</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
<a id="line-2637" name="line-2637"></a><span class="p">}</span>
<a id="line-2638" name="line-2638"></a>
<a id="line-2639" name="line-2639"></a><span class="cm">/**</span>
<a id="line-2640" name="line-2640"></a><span class="cm"> * mate_desktop_item_set_location_file:</span>
<a id="line-2641" name="line-2641"></a><span class="cm"> * @item: A desktop item</span>
<a id="line-2642" name="line-2642"></a><span class="cm"> * @file: A local filename specifying the file location of this particular item.</span>
<a id="line-2643" name="line-2643"></a><span class="cm"> *</span>
<a id="line-2644" name="line-2644"></a><span class="cm"> * Set&#39;s the &#39;location&#39; uri of this item to the given @file.</span>
<a id="line-2645" name="line-2645"></a><span class="cm"> */</span>
<a id="line-2646" name="line-2646"></a><span class="kt">void</span>
<a id="line-2647" name="line-2647"></a><span class="nf">mate_desktop_item_set_location_file</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">file</span><span class="p">)</span>
<a id="line-2648" name="line-2648"></a><span class="p">{</span>
<a id="line-2649" name="line-2649"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2650" name="line-2650"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<a id="line-2651" name="line-2651"></a>
<a id="line-2652" name="line-2652"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-2653" name="line-2653"></a><span class="w">		</span><span class="n">GFile</span><span class="w"> </span><span class="o">*</span><span class="n">gfile</span><span class="p">;</span>
<a id="line-2654" name="line-2654"></a>
<a id="line-2655" name="line-2655"></a><span class="w">		</span><span class="n">gfile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_new_for_path</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<a id="line-2656" name="line-2656"></a><span class="w">		</span><span class="n">mate_desktop_item_set_location_gfile</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">gfile</span><span class="p">);</span>
<a id="line-2657" name="line-2657"></a><span class="w">		</span><span class="n">g_object_unref</span><span class="w"> </span><span class="p">(</span><span class="n">gfile</span><span class="p">);</span>
<a id="line-2658" name="line-2658"></a><span class="w">	</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-2659" name="line-2659"></a><span class="w">		</span><span class="n">mate_desktop_item_set_location</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2660" name="line-2660"></a><span class="w">	</span><span class="p">}</span>
<a id="line-2661" name="line-2661"></a><span class="p">}</span>
<a id="line-2662" name="line-2662"></a>
<a id="line-2663" name="line-2663"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<a id="line-2664" name="line-2664"></a><span class="nf">mate_desktop_item_set_location_gfile</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">GFile</span><span class="w"> </span><span class="o">*</span><span class="n">file</span><span class="p">)</span>
<a id="line-2665" name="line-2665"></a><span class="p">{</span>
<a id="line-2666" name="line-2666"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2667" name="line-2667"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<a id="line-2668" name="line-2668"></a>
<a id="line-2669" name="line-2669"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-2670" name="line-2670"></a><span class="w">		</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">uri</span><span class="p">;</span>
<a id="line-2671" name="line-2671"></a>
<a id="line-2672" name="line-2672"></a><span class="w">		</span><span class="n">uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_get_uri</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<a id="line-2673" name="line-2673"></a><span class="w">		</span><span class="n">mate_desktop_item_set_location</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">uri</span><span class="p">);</span>
<a id="line-2674" name="line-2674"></a><span class="w">		</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">uri</span><span class="p">);</span>
<a id="line-2675" name="line-2675"></a><span class="w">	</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-2676" name="line-2676"></a><span class="w">		</span><span class="n">mate_desktop_item_set_location</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2677" name="line-2677"></a><span class="w">	</span><span class="p">}</span>
<a id="line-2678" name="line-2678"></a><span class="p">}</span>
<a id="line-2679" name="line-2679"></a>
<a id="line-2680" name="line-2680"></a><span class="cm">/*</span>
<a id="line-2681" name="line-2681"></a><span class="cm"> * Reading/Writing different sections, NULL is the standard section</span>
<a id="line-2682" name="line-2682"></a><span class="cm"> */</span>
<a id="line-2683" name="line-2683"></a>
<a id="line-2684" name="line-2684"></a><span class="n">gboolean</span>
<a id="line-2685" name="line-2685"></a><span class="nf">mate_desktop_item_attr_exists</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-2686" name="line-2686"></a><span class="w">				</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">attr</span><span class="p">)</span>
<a id="line-2687" name="line-2687"></a><span class="p">{</span>
<a id="line-2688" name="line-2688"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">FALSE</span><span class="p">);</span>
<a id="line-2689" name="line-2689"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">FALSE</span><span class="p">);</span>
<a id="line-2690" name="line-2690"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">attr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">FALSE</span><span class="p">);</span>
<a id="line-2691" name="line-2691"></a>
<a id="line-2692" name="line-2692"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">lookup</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">attr</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-2693" name="line-2693"></a><span class="p">}</span>
<a id="line-2694" name="line-2694"></a>
<a id="line-2695" name="line-2695"></a><span class="cm">/*</span>
<a id="line-2696" name="line-2696"></a><span class="cm"> * String type</span>
<a id="line-2697" name="line-2697"></a><span class="cm"> */</span>
<a id="line-2698" name="line-2698"></a><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span>
<a id="line-2699" name="line-2699"></a><span class="nf">mate_desktop_item_get_string</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-2700" name="line-2700"></a><span class="w">			       </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">attr</span><span class="p">)</span>
<a id="line-2701" name="line-2701"></a><span class="p">{</span>
<a id="line-2702" name="line-2702"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2703" name="line-2703"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2704" name="line-2704"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">attr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2705" name="line-2705"></a>
<a id="line-2706" name="line-2706"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">lookup</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">attr</span><span class="p">);</span>
<a id="line-2707" name="line-2707"></a><span class="p">}</span>
<a id="line-2708" name="line-2708"></a>
<a id="line-2709" name="line-2709"></a><span class="kt">void</span>
<a id="line-2710" name="line-2710"></a><span class="nf">mate_desktop_item_set_string</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-2711" name="line-2711"></a><span class="w">			       </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">attr</span><span class="p">,</span>
<a id="line-2712" name="line-2712"></a><span class="w">			       </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">value</span><span class="p">)</span>
<a id="line-2713" name="line-2713"></a><span class="p">{</span>
<a id="line-2714" name="line-2714"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2715" name="line-2715"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<a id="line-2716" name="line-2716"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">attr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2717" name="line-2717"></a>
<a id="line-2718" name="line-2718"></a><span class="w">	</span><span class="n">set</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">attr</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
<a id="line-2719" name="line-2719"></a>
<a id="line-2720" name="line-2720"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="n">attr</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TYPE</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<a id="line-2721" name="line-2721"></a><span class="w">		</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">type_from_string</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
<a id="line-2722" name="line-2722"></a><span class="p">}</span>
<a id="line-2723" name="line-2723"></a>
<a id="line-2724" name="line-2724"></a><span class="cm">/*</span>
<a id="line-2725" name="line-2725"></a><span class="cm"> * LocaleString type</span>
<a id="line-2726" name="line-2726"></a><span class="cm"> */</span>
<a id="line-2727" name="line-2727"></a><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="nf">mate_desktop_item_get_localestring</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="o">*</span><span class="w"> </span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">attr</span><span class="p">)</span>
<a id="line-2728" name="line-2728"></a><span class="p">{</span>
<a id="line-2729" name="line-2729"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2730" name="line-2730"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2731" name="line-2731"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="p">(</span><span class="n">attr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2732" name="line-2732"></a>
<a id="line-2733" name="line-2733"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">lookup_best_locale</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">attr</span><span class="p">);</span>
<a id="line-2734" name="line-2734"></a><span class="p">}</span>
<a id="line-2735" name="line-2735"></a>
<a id="line-2736" name="line-2736"></a><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="nf">mate_desktop_item_get_localestring_lang</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="o">*</span><span class="w"> </span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">attr</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">language</span><span class="p">)</span>
<a id="line-2737" name="line-2737"></a><span class="p">{</span>
<a id="line-2738" name="line-2738"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2739" name="line-2739"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2740" name="line-2740"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="p">(</span><span class="n">attr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2741" name="line-2741"></a>
<a id="line-2742" name="line-2742"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">lookup_locale</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">attr</span><span class="p">,</span><span class="w"> </span><span class="n">language</span><span class="p">);</span>
<a id="line-2743" name="line-2743"></a><span class="p">}</span>
<a id="line-2744" name="line-2744"></a>
<a id="line-2745" name="line-2745"></a><span class="cm">/**</span>
<a id="line-2746" name="line-2746"></a><span class="cm"> * mate_desktop_item_get_string_locale:</span>
<a id="line-2747" name="line-2747"></a><span class="cm"> * @item: A desktop item</span>
<a id="line-2748" name="line-2748"></a><span class="cm"> * @attr: An attribute name</span>
<a id="line-2749" name="line-2749"></a><span class="cm"> *</span>
<a id="line-2750" name="line-2750"></a><span class="cm"> * Returns the current locale that is used for the given attribute.</span>
<a id="line-2751" name="line-2751"></a><span class="cm"> * This might not be the same for all attributes. For example, if your</span>
<a id="line-2752" name="line-2752"></a><span class="cm"> * locale is &quot;en_US.ISO8859-1&quot; but attribute FOO only has &quot;en_US&quot; then</span>
<a id="line-2753" name="line-2753"></a><span class="cm"> * that would be returned for attr = &quot;FOO&quot;. If attribute BAR has</span>
<a id="line-2754" name="line-2754"></a><span class="cm"> * &quot;en_US.ISO8859-1&quot; then that would be returned for &quot;BAR&quot;.</span>
<a id="line-2755" name="line-2755"></a><span class="cm"> *</span>
<a id="line-2756" name="line-2756"></a><span class="cm"> * Returns: a string equal to the current locale or NULL</span>
<a id="line-2757" name="line-2757"></a><span class="cm"> * if the attribute is invalid or there is no matching locale.</span>
<a id="line-2758" name="line-2758"></a><span class="cm"> */</span>
<a id="line-2759" name="line-2759"></a><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span>
<a id="line-2760" name="line-2760"></a><span class="nf">mate_desktop_item_get_attr_locale</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-2761" name="line-2761"></a><span class="w">				    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w">             </span><span class="o">*</span><span class="n">attr</span><span class="p">)</span>
<a id="line-2762" name="line-2762"></a><span class="p">{</span>
<a id="line-2763" name="line-2763"></a><span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="o">*</span><span class="n">langs_pointer</span><span class="p">;</span>
<a id="line-2764" name="line-2764"></a><span class="w">	</span><span class="kt">int</span><span class="w">                 </span><span class="n">i</span><span class="p">;</span>
<a id="line-2765" name="line-2765"></a>
<a id="line-2766" name="line-2766"></a><span class="w">	</span><span class="n">langs_pointer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_get_language_names</span><span class="w"> </span><span class="p">();</span>
<a id="line-2767" name="line-2767"></a><span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">langs_pointer</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-2768" name="line-2768"></a><span class="w">		</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-2769" name="line-2769"></a>
<a id="line-2770" name="line-2770"></a><span class="w">		</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lookup_locale</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">attr</span><span class="p">,</span><span class="w"> </span><span class="n">langs_pointer</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<a id="line-2771" name="line-2771"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="line-2772" name="line-2772"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">langs_pointer</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="line-2773" name="line-2773"></a><span class="w">	</span><span class="p">}</span>
<a id="line-2774" name="line-2774"></a>
<a id="line-2775" name="line-2775"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-2776" name="line-2776"></a><span class="p">}</span>
<a id="line-2777" name="line-2777"></a>
<a id="line-2778" name="line-2778"></a><span class="n">GList</span><span class="w"> </span><span class="o">*</span>
<a id="line-2779" name="line-2779"></a><span class="nf">mate_desktop_item_get_languages</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-2780" name="line-2780"></a><span class="w">				  </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">attr</span><span class="p">)</span>
<a id="line-2781" name="line-2781"></a><span class="p">{</span>
<a id="line-2782" name="line-2782"></a><span class="w">	</span><span class="n">GList</span><span class="w"> </span><span class="o">*</span><span class="n">li</span><span class="p">;</span>
<a id="line-2783" name="line-2783"></a><span class="w">	</span><span class="n">GList</span><span class="w"> </span><span class="o">*</span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-2784" name="line-2784"></a>
<a id="line-2785" name="line-2785"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2786" name="line-2786"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2787" name="line-2787"></a>
<a id="line-2788" name="line-2788"></a><span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="o">-&gt;</span><span class="n">languages</span><span class="p">;</span><span class="w"> </span><span class="n">li</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"> </span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">li</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-2789" name="line-2789"></a><span class="w">		</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">language</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">li</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
<a id="line-2790" name="line-2790"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">attr</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">||</span>
<a id="line-2791" name="line-2791"></a><span class="w">		    </span><span class="n">lookup_locale</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">attr</span><span class="p">,</span><span class="w"> </span><span class="n">language</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-2792" name="line-2792"></a><span class="w">			</span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_list_prepend</span><span class="w"> </span><span class="p">(</span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="n">language</span><span class="p">);</span>
<a id="line-2793" name="line-2793"></a><span class="w">		</span><span class="p">}</span>
<a id="line-2794" name="line-2794"></a><span class="w">	</span><span class="p">}</span>
<a id="line-2795" name="line-2795"></a>
<a id="line-2796" name="line-2796"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">g_list_reverse</span><span class="w"> </span><span class="p">(</span><span class="n">list</span><span class="p">);</span>
<a id="line-2797" name="line-2797"></a><span class="p">}</span>
<a id="line-2798" name="line-2798"></a>
<a id="line-2799" name="line-2799"></a><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span>
<a id="line-2800" name="line-2800"></a><span class="nf">get_language</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<a id="line-2801" name="line-2801"></a><span class="p">{</span>
<a id="line-2802" name="line-2802"></a><span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="o">*</span><span class="n">langs_pointer</span><span class="p">;</span>
<a id="line-2803" name="line-2803"></a><span class="w">	</span><span class="kt">int</span><span class="w">                 </span><span class="n">i</span><span class="p">;</span>
<a id="line-2804" name="line-2804"></a>
<a id="line-2805" name="line-2805"></a><span class="w">	</span><span class="n">langs_pointer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_get_language_names</span><span class="w"> </span><span class="p">();</span>
<a id="line-2806" name="line-2806"></a><span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">langs_pointer</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-2807" name="line-2807"></a><span class="w">		</span><span class="cm">/* find first without encoding  */</span>
<a id="line-2808" name="line-2808"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">strchr</span><span class="w"> </span><span class="p">(</span><span class="n">langs_pointer</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="sc">&#39;.&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-2809" name="line-2809"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">langs_pointer</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="line-2810" name="line-2810"></a><span class="w">		</span><span class="p">}</span>
<a id="line-2811" name="line-2811"></a><span class="w">	</span><span class="p">}</span>
<a id="line-2812" name="line-2812"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-2813" name="line-2813"></a><span class="p">}</span>
<a id="line-2814" name="line-2814"></a>
<a id="line-2815" name="line-2815"></a><span class="kt">void</span>
<a id="line-2816" name="line-2816"></a><span class="nf">mate_desktop_item_set_localestring</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-2817" name="line-2817"></a><span class="w">				     </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">attr</span><span class="p">,</span>
<a id="line-2818" name="line-2818"></a><span class="w">				     </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">value</span><span class="p">)</span>
<a id="line-2819" name="line-2819"></a><span class="p">{</span>
<a id="line-2820" name="line-2820"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2821" name="line-2821"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<a id="line-2822" name="line-2822"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">attr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2823" name="line-2823"></a>
<a id="line-2824" name="line-2824"></a><span class="w">	</span><span class="n">set_locale</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">attr</span><span class="p">,</span><span class="w"> </span><span class="n">get_language</span><span class="w"> </span><span class="p">(),</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
<a id="line-2825" name="line-2825"></a><span class="p">}</span>
<a id="line-2826" name="line-2826"></a>
<a id="line-2827" name="line-2827"></a><span class="kt">void</span>
<a id="line-2828" name="line-2828"></a><span class="nf">mate_desktop_item_set_localestring_lang</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-2829" name="line-2829"></a><span class="w">					  </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">attr</span><span class="p">,</span>
<a id="line-2830" name="line-2830"></a><span class="w">					  </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">language</span><span class="p">,</span>
<a id="line-2831" name="line-2831"></a><span class="w">					  </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">value</span><span class="p">)</span>
<a id="line-2832" name="line-2832"></a><span class="p">{</span>
<a id="line-2833" name="line-2833"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2834" name="line-2834"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<a id="line-2835" name="line-2835"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">attr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2836" name="line-2836"></a>
<a id="line-2837" name="line-2837"></a><span class="w">	</span><span class="n">set_locale</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">attr</span><span class="p">,</span><span class="w"> </span><span class="n">language</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
<a id="line-2838" name="line-2838"></a><span class="p">}</span>
<a id="line-2839" name="line-2839"></a>
<a id="line-2840" name="line-2840"></a><span class="kt">void</span>
<a id="line-2841" name="line-2841"></a><span class="nf">mate_desktop_item_clear_localestring</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-2842" name="line-2842"></a><span class="w">				       </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">attr</span><span class="p">)</span>
<a id="line-2843" name="line-2843"></a><span class="p">{</span>
<a id="line-2844" name="line-2844"></a><span class="hll"><span class="w">	</span><span class="n">GList</span><span class="w"> </span><span class="o">*</span><span class="n">l</span><span class="p">;</span><span class="error2">&lt;--- Variable 'l' can be declared as pointer to const</span>
</span><a id="line-2845" name="line-2845"></a>
<a id="line-2846" name="line-2846"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2847" name="line-2847"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<a id="line-2848" name="line-2848"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">attr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2849" name="line-2849"></a>
<a id="line-2850" name="line-2850"></a><span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="o">-&gt;</span><span class="n">languages</span><span class="p">;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">)</span>
<a id="line-2851" name="line-2851"></a><span class="w">		</span><span class="n">set_locale</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">attr</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2852" name="line-2852"></a>
<a id="line-2853" name="line-2853"></a><span class="w">	</span><span class="n">set</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">attr</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2854" name="line-2854"></a><span class="p">}</span>
<a id="line-2855" name="line-2855"></a>
<a id="line-2856" name="line-2856"></a><span class="cm">/*</span>
<a id="line-2857" name="line-2857"></a><span class="cm"> * Strings, Regexps types</span>
<a id="line-2858" name="line-2858"></a><span class="cm"> */</span>
<a id="line-2859" name="line-2859"></a>
<a id="line-2860" name="line-2860"></a><span class="kt">char</span><span class="w"> </span><span class="o">**</span>
<a id="line-2861" name="line-2861"></a><span class="nf">mate_desktop_item_get_strings</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-2862" name="line-2862"></a><span class="w">				</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">attr</span><span class="p">)</span>
<a id="line-2863" name="line-2863"></a><span class="p">{</span>
<a id="line-2864" name="line-2864"></a><span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">value</span><span class="p">;</span>
<a id="line-2865" name="line-2865"></a>
<a id="line-2866" name="line-2866"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2867" name="line-2867"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2868" name="line-2868"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">attr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2869" name="line-2869"></a>
<a id="line-2870" name="line-2870"></a><span class="w">	</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lookup</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">attr</span><span class="p">);</span>
<a id="line-2871" name="line-2871"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-2872" name="line-2872"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-2873" name="line-2873"></a>
<a id="line-2874" name="line-2874"></a><span class="w">	</span><span class="cm">/* FIXME: there&#39;s no way to escape semicolons apparently */</span>
<a id="line-2875" name="line-2875"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">g_strsplit</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;;&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
<a id="line-2876" name="line-2876"></a><span class="p">}</span>
<a id="line-2877" name="line-2877"></a>
<a id="line-2878" name="line-2878"></a><span class="kt">void</span>
<a id="line-2879" name="line-2879"></a><span class="nf">mate_desktop_item_set_strings</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-2880" name="line-2880"></a><span class="w">				</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">attr</span><span class="p">,</span>
<a id="line-2881" name="line-2881"></a><span class="w">				</span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">strings</span><span class="p">)</span>
<a id="line-2882" name="line-2882"></a><span class="p">{</span>
<a id="line-2883" name="line-2883"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">str2</span><span class="p">;</span>
<a id="line-2884" name="line-2884"></a>
<a id="line-2885" name="line-2885"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2886" name="line-2886"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<a id="line-2887" name="line-2887"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">attr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2888" name="line-2888"></a>
<a id="line-2889" name="line-2889"></a><span class="w">	</span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strjoinv</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">strings</span><span class="p">);</span>
<a id="line-2890" name="line-2890"></a><span class="w">	</span><span class="n">str2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strconcat</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;;&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2891" name="line-2891"></a><span class="w">	</span><span class="cm">/* FIXME: there&#39;s no way to escape semicolons apparently */</span>
<a id="line-2892" name="line-2892"></a><span class="w">	</span><span class="n">set</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">attr</span><span class="p">,</span><span class="w"> </span><span class="n">str2</span><span class="p">);</span>
<a id="line-2893" name="line-2893"></a><span class="w">	</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
<a id="line-2894" name="line-2894"></a><span class="w">	</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">str2</span><span class="p">);</span>
<a id="line-2895" name="line-2895"></a><span class="p">}</span>
<a id="line-2896" name="line-2896"></a>
<a id="line-2897" name="line-2897"></a><span class="cm">/*</span>
<a id="line-2898" name="line-2898"></a><span class="cm"> * Boolean type</span>
<a id="line-2899" name="line-2899"></a><span class="cm"> */</span>
<a id="line-2900" name="line-2900"></a><span class="n">gboolean</span>
<a id="line-2901" name="line-2901"></a><span class="nf">mate_desktop_item_get_boolean</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-2902" name="line-2902"></a><span class="w">				</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">attr</span><span class="p">)</span>
<a id="line-2903" name="line-2903"></a><span class="p">{</span>
<a id="line-2904" name="line-2904"></a><span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">value</span><span class="p">;</span>
<a id="line-2905" name="line-2905"></a>
<a id="line-2906" name="line-2906"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">FALSE</span><span class="p">);</span>
<a id="line-2907" name="line-2907"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">FALSE</span><span class="p">);</span>
<a id="line-2908" name="line-2908"></a><span class="w">	</span><span class="n">g_return_val_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">attr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">FALSE</span><span class="p">);</span>
<a id="line-2909" name="line-2909"></a>
<a id="line-2910" name="line-2910"></a><span class="w">	</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lookup</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">attr</span><span class="p">);</span>
<a id="line-2911" name="line-2911"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-2912" name="line-2912"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-2913" name="line-2913"></a>
<a id="line-2914" name="line-2914"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;T&#39;</span><span class="w"> </span><span class="o">||</span>
<a id="line-2915" name="line-2915"></a><span class="w">		</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;t&#39;</span><span class="w"> </span><span class="o">||</span>
<a id="line-2916" name="line-2916"></a><span class="w">		</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;Y&#39;</span><span class="w"> </span><span class="o">||</span>
<a id="line-2917" name="line-2917"></a><span class="w">		</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;y&#39;</span><span class="w"> </span><span class="o">||</span>
<a id="line-2918" name="line-2918"></a><span class="w">		</span><span class="n">atoi</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<a id="line-2919" name="line-2919"></a><span class="p">}</span>
<a id="line-2920" name="line-2920"></a>
<a id="line-2921" name="line-2921"></a><span class="kt">void</span>
<a id="line-2922" name="line-2922"></a><span class="nf">mate_desktop_item_set_boolean</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-2923" name="line-2923"></a><span class="w">				</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">attr</span><span class="p">,</span>
<a id="line-2924" name="line-2924"></a><span class="w">				</span><span class="n">gboolean</span><span class="w"> </span><span class="n">value</span><span class="p">)</span>
<a id="line-2925" name="line-2925"></a><span class="p">{</span>
<a id="line-2926" name="line-2926"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2927" name="line-2927"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<a id="line-2928" name="line-2928"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">attr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2929" name="line-2929"></a>
<a id="line-2930" name="line-2930"></a><span class="w">	</span><span class="n">set</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">attr</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;true&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;false&quot;</span><span class="p">);</span>
<a id="line-2931" name="line-2931"></a><span class="p">}</span>
<a id="line-2932" name="line-2932"></a>
<a id="line-2933" name="line-2933"></a><span class="kt">void</span>
<a id="line-2934" name="line-2934"></a><span class="nf">mate_desktop_item_set_launch_time</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-2935" name="line-2935"></a><span class="w">				    </span><span class="n">guint32</span><span class="w">           </span><span class="n">timestamp</span><span class="p">)</span>
<a id="line-2936" name="line-2936"></a><span class="p">{</span>
<a id="line-2937" name="line-2937"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2938" name="line-2938"></a>
<a id="line-2939" name="line-2939"></a><span class="w">	</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">launch_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">timestamp</span><span class="p">;</span>
<a id="line-2940" name="line-2940"></a><span class="p">}</span>
<a id="line-2941" name="line-2941"></a>
<a id="line-2942" name="line-2942"></a><span class="cm">/*</span>
<a id="line-2943" name="line-2943"></a><span class="cm"> * Clearing attributes</span>
<a id="line-2944" name="line-2944"></a><span class="cm"> */</span>
<a id="line-2945" name="line-2945"></a><span class="kt">void</span>
<a id="line-2946" name="line-2946"></a><span class="nf">mate_desktop_item_clear_section</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-2947" name="line-2947"></a><span class="w">				  </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">section</span><span class="p">)</span>
<a id="line-2948" name="line-2948"></a><span class="p">{</span>
<a id="line-2949" name="line-2949"></a><span class="w">	</span><span class="n">Section</span><span class="w"> </span><span class="o">*</span><span class="n">sec</span><span class="p">;</span>
<a id="line-2950" name="line-2950"></a><span class="w">	</span><span class="n">GList</span><span class="w"> </span><span class="o">*</span><span class="n">li</span><span class="p">;</span>
<a id="line-2951" name="line-2951"></a>
<a id="line-2952" name="line-2952"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-2953" name="line-2953"></a><span class="w">	</span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">refcount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<a id="line-2954" name="line-2954"></a>
<a id="line-2955" name="line-2955"></a><span class="w">	</span><span class="n">sec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">find_section</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">section</span><span class="p">);</span>
<a id="line-2956" name="line-2956"></a>
<a id="line-2957" name="line-2957"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sec</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-2958" name="line-2958"></a><span class="w">		</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">;</span><span class="w"> </span><span class="n">li</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"> </span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">li</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-2959" name="line-2959"></a><span class="w">			</span><span class="n">g_hash_table_remove</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">main_hash</span><span class="p">,</span><span class="w"> </span><span class="n">li</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">);</span>
<a id="line-2960" name="line-2960"></a><span class="w">			</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">li</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">);</span>
<a id="line-2961" name="line-2961"></a><span class="w">			</span><span class="n">li</span><span class="o">-&gt;</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-2962" name="line-2962"></a><span class="w">		</span><span class="p">}</span>
<a id="line-2963" name="line-2963"></a><span class="w">		</span><span class="n">g_list_free</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">);</span>
<a id="line-2964" name="line-2964"></a><span class="w">		</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-2965" name="line-2965"></a><span class="w">	</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-2966" name="line-2966"></a><span class="w">		</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sec</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">;</span><span class="w"> </span><span class="n">li</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"> </span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">li</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-2967" name="line-2967"></a><span class="w">			</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">li</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
<a id="line-2968" name="line-2968"></a><span class="w">			</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">full</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup_printf</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;%s/%s&quot;</span><span class="p">,</span>
<a id="line-2969" name="line-2969"></a><span class="w">						      </span><span class="n">sec</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>
<a id="line-2970" name="line-2970"></a><span class="w">			</span><span class="n">g_hash_table_remove</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">main_hash</span><span class="p">,</span><span class="w"> </span><span class="n">full</span><span class="p">);</span>
<a id="line-2971" name="line-2971"></a><span class="w">			</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">full</span><span class="p">);</span>
<a id="line-2972" name="line-2972"></a><span class="w">			</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
<a id="line-2973" name="line-2973"></a><span class="w">			</span><span class="n">li</span><span class="o">-&gt;</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-2974" name="line-2974"></a><span class="w">		</span><span class="p">}</span>
<a id="line-2975" name="line-2975"></a><span class="w">		</span><span class="n">g_list_free</span><span class="w"> </span><span class="p">(</span><span class="n">sec</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">);</span>
<a id="line-2976" name="line-2976"></a><span class="w">		</span><span class="n">sec</span><span class="o">-&gt;</span><span class="n">keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-2977" name="line-2977"></a><span class="w">	</span><span class="p">}</span>
<a id="line-2978" name="line-2978"></a><span class="w">	</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">modified</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
<a id="line-2979" name="line-2979"></a><span class="p">}</span>
<a id="line-2980" name="line-2980"></a>
<a id="line-2981" name="line-2981"></a><span class="cm">/************************************************************</span>
<a id="line-2982" name="line-2982"></a><span class="cm"> * Parser:                                                  *</span>
<a id="line-2983" name="line-2983"></a><span class="cm"> ************************************************************/</span>
<a id="line-2984" name="line-2984"></a>
<a id="line-2985" name="line-2985"></a><span class="k">static</span><span class="w"> </span><span class="n">gboolean</span><span class="w"> </span><span class="n">G_GNUC_CONST</span>
<a id="line-2986" name="line-2986"></a><span class="n">standard_is_boolean</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">key</span><span class="p">)</span>
<a id="line-2987" name="line-2987"></a><span class="p">{</span>
<a id="line-2988" name="line-2988"></a><span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">GHashTable</span><span class="w"> </span><span class="o">*</span><span class="n">bools</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-2989" name="line-2989"></a>
<a id="line-2990" name="line-2990"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bools</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-2991" name="line-2991"></a><span class="w">		</span><span class="n">bools</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_hash_table_new</span><span class="w"> </span><span class="p">(</span><span class="n">g_str_hash</span><span class="p">,</span><span class="w"> </span><span class="n">g_str_equal</span><span class="p">);</span>
<a id="line-2992" name="line-2992"></a><span class="w">		</span><span class="n">g_hash_table_insert</span><span class="w"> </span><span class="p">(</span><span class="n">bools</span><span class="p">,</span>
<a id="line-2993" name="line-2993"></a><span class="w">				     </span><span class="n">MATE_DESKTOP_ITEM_NO_DISPLAY</span><span class="p">,</span>
<a id="line-2994" name="line-2994"></a><span class="w">				     </span><span class="n">MATE_DESKTOP_ITEM_NO_DISPLAY</span><span class="p">);</span>
<a id="line-2995" name="line-2995"></a><span class="w">		</span><span class="n">g_hash_table_insert</span><span class="w"> </span><span class="p">(</span><span class="n">bools</span><span class="p">,</span>
<a id="line-2996" name="line-2996"></a><span class="w">				     </span><span class="n">MATE_DESKTOP_ITEM_HIDDEN</span><span class="p">,</span>
<a id="line-2997" name="line-2997"></a><span class="w">				     </span><span class="n">MATE_DESKTOP_ITEM_HIDDEN</span><span class="p">);</span>
<a id="line-2998" name="line-2998"></a><span class="w">		</span><span class="n">g_hash_table_insert</span><span class="w"> </span><span class="p">(</span><span class="n">bools</span><span class="p">,</span>
<a id="line-2999" name="line-2999"></a><span class="w">				     </span><span class="n">MATE_DESKTOP_ITEM_TERMINAL</span><span class="p">,</span>
<a id="line-3000" name="line-3000"></a><span class="w">				     </span><span class="n">MATE_DESKTOP_ITEM_TERMINAL</span><span class="p">);</span>
<a id="line-3001" name="line-3001"></a><span class="w">		</span><span class="n">g_hash_table_insert</span><span class="w"> </span><span class="p">(</span><span class="n">bools</span><span class="p">,</span>
<a id="line-3002" name="line-3002"></a><span class="w">				     </span><span class="n">MATE_DESKTOP_ITEM_READ_ONLY</span><span class="p">,</span>
<a id="line-3003" name="line-3003"></a><span class="w">				     </span><span class="n">MATE_DESKTOP_ITEM_READ_ONLY</span><span class="p">);</span>
<a id="line-3004" name="line-3004"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3005" name="line-3005"></a>
<a id="line-3006" name="line-3006"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">g_hash_table_lookup</span><span class="w"> </span><span class="p">(</span><span class="n">bools</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-3007" name="line-3007"></a><span class="p">}</span>
<a id="line-3008" name="line-3008"></a>
<a id="line-3009" name="line-3009"></a><span class="k">static</span><span class="w"> </span><span class="n">gboolean</span><span class="w"> </span><span class="n">G_GNUC_CONST</span>
<a id="line-3010" name="line-3010"></a><span class="n">standard_is_strings</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">key</span><span class="p">)</span>
<a id="line-3011" name="line-3011"></a><span class="p">{</span>
<a id="line-3012" name="line-3012"></a><span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">GHashTable</span><span class="w"> </span><span class="o">*</span><span class="n">strings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-3013" name="line-3013"></a>
<a id="line-3014" name="line-3014"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">strings</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3015" name="line-3015"></a><span class="w">		</span><span class="n">strings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_hash_table_new</span><span class="w"> </span><span class="p">(</span><span class="n">g_str_hash</span><span class="p">,</span><span class="w"> </span><span class="n">g_str_equal</span><span class="p">);</span>
<a id="line-3016" name="line-3016"></a><span class="w">		</span><span class="n">g_hash_table_insert</span><span class="w"> </span><span class="p">(</span><span class="n">strings</span><span class="p">,</span>
<a id="line-3017" name="line-3017"></a><span class="w">				     </span><span class="n">MATE_DESKTOP_ITEM_FILE_PATTERN</span><span class="p">,</span>
<a id="line-3018" name="line-3018"></a><span class="w">				     </span><span class="n">MATE_DESKTOP_ITEM_FILE_PATTERN</span><span class="p">);</span>
<a id="line-3019" name="line-3019"></a><span class="w">		</span><span class="n">g_hash_table_insert</span><span class="w"> </span><span class="p">(</span><span class="n">strings</span><span class="p">,</span>
<a id="line-3020" name="line-3020"></a><span class="w">				     </span><span class="n">MATE_DESKTOP_ITEM_ACTIONS</span><span class="p">,</span>
<a id="line-3021" name="line-3021"></a><span class="w">				     </span><span class="n">MATE_DESKTOP_ITEM_ACTIONS</span><span class="p">);</span>
<a id="line-3022" name="line-3022"></a><span class="w">		</span><span class="n">g_hash_table_insert</span><span class="w"> </span><span class="p">(</span><span class="n">strings</span><span class="p">,</span>
<a id="line-3023" name="line-3023"></a><span class="w">				     </span><span class="n">MATE_DESKTOP_ITEM_MIME_TYPE</span><span class="p">,</span>
<a id="line-3024" name="line-3024"></a><span class="w">				     </span><span class="n">MATE_DESKTOP_ITEM_MIME_TYPE</span><span class="p">);</span>
<a id="line-3025" name="line-3025"></a><span class="w">		</span><span class="n">g_hash_table_insert</span><span class="w"> </span><span class="p">(</span><span class="n">strings</span><span class="p">,</span>
<a id="line-3026" name="line-3026"></a><span class="w">				     </span><span class="n">MATE_DESKTOP_ITEM_PATTERNS</span><span class="p">,</span>
<a id="line-3027" name="line-3027"></a><span class="w">				     </span><span class="n">MATE_DESKTOP_ITEM_PATTERNS</span><span class="p">);</span>
<a id="line-3028" name="line-3028"></a><span class="w">		</span><span class="n">g_hash_table_insert</span><span class="w"> </span><span class="p">(</span><span class="n">strings</span><span class="p">,</span>
<a id="line-3029" name="line-3029"></a><span class="w">				     </span><span class="n">MATE_DESKTOP_ITEM_SORT_ORDER</span><span class="p">,</span>
<a id="line-3030" name="line-3030"></a><span class="w">				     </span><span class="n">MATE_DESKTOP_ITEM_SORT_ORDER</span><span class="p">);</span>
<a id="line-3031" name="line-3031"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3032" name="line-3032"></a>
<a id="line-3033" name="line-3033"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">g_hash_table_lookup</span><span class="w"> </span><span class="p">(</span><span class="n">strings</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-3034" name="line-3034"></a><span class="p">}</span>
<a id="line-3035" name="line-3035"></a>
<a id="line-3036" name="line-3036"></a><span class="cm">/* If no need to cannonize, returns NULL */</span>
<a id="line-3037" name="line-3037"></a><span class="k">static</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span>
<a id="line-3038" name="line-3038"></a><span class="n">cannonize</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">value</span><span class="p">)</span>
<a id="line-3039" name="line-3039"></a><span class="p">{</span>
<a id="line-3040" name="line-3040"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">standard_is_boolean</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="line-3041" name="line-3041"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;T&#39;</span><span class="w"> </span><span class="o">||</span>
<a id="line-3042" name="line-3042"></a><span class="w">		    </span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;t&#39;</span><span class="w"> </span><span class="o">||</span>
<a id="line-3043" name="line-3043"></a><span class="w">		    </span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;Y&#39;</span><span class="w"> </span><span class="o">||</span>
<a id="line-3044" name="line-3044"></a><span class="w">		    </span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;y&#39;</span><span class="w"> </span><span class="o">||</span>
<a id="line-3045" name="line-3045"></a><span class="w">		    </span><span class="n">atoi</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3046" name="line-3046"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;true&quot;</span><span class="p">);</span>
<a id="line-3047" name="line-3047"></a><span class="w">		</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-3048" name="line-3048"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;false&quot;</span><span class="p">);</span>
<a id="line-3049" name="line-3049"></a><span class="w">		</span><span class="p">}</span>
<a id="line-3050" name="line-3050"></a><span class="w">	</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">standard_is_strings</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="line-3051" name="line-3051"></a><span class="w">		</span><span class="kt">int</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strlen</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
<a id="line-3052" name="line-3052"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">value</span><span class="p">[</span><span class="n">len</span><span class="mi">-1</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="sc">&#39;;&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3053" name="line-3053"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">g_strconcat</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;;&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-3054" name="line-3054"></a><span class="w">		</span><span class="p">}</span>
<a id="line-3055" name="line-3055"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3056" name="line-3056"></a><span class="w">	</span><span class="cm">/* XXX: Perhaps we should canonize numeric values as well, but this</span>
<a id="line-3057" name="line-3057"></a><span class="cm">	 * has caused some subtle problems before so it needs to be done</span>
<a id="line-3058" name="line-3058"></a><span class="cm">	 * carefully if at all */</span>
<a id="line-3059" name="line-3059"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-3060" name="line-3060"></a><span class="p">}</span>
<a id="line-3061" name="line-3061"></a>
<a id="line-3062" name="line-3062"></a><span class="k">static</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span>
<a id="line-3063" name="line-3063"></a><span class="n">decode_string_and_dup</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">s</span><span class="p">)</span>
<a id="line-3064" name="line-3064"></a><span class="p">{</span>
<a id="line-3065" name="line-3065"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_malloc</span><span class="w"> </span><span class="p">(</span><span class="n">strlen</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="line-3066" name="line-3066"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">;</span>
<a id="line-3067" name="line-3067"></a>
<a id="line-3068" name="line-3068"></a><span class="w">	</span><span class="k">do</span><span class="w"> </span><span class="p">{</span>
<a id="line-3069" name="line-3069"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">s</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;\\&#39;</span><span class="p">){</span>
<a id="line-3070" name="line-3070"></a><span class="w">			</span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="o">++</span><span class="n">s</span><span class="p">)){</span>
<a id="line-3071" name="line-3071"></a><span class="w">			</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;s&#39;</span><span class="p">:</span>
<a id="line-3072" name="line-3072"></a><span class="w">				</span><span class="o">*</span><span class="n">p</span><span class="o">++</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39; &#39;</span><span class="p">;</span>
<a id="line-3073" name="line-3073"></a><span class="w">				</span><span class="k">break</span><span class="p">;</span>
<a id="line-3074" name="line-3074"></a><span class="w">			</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;t&#39;</span><span class="p">:</span>
<a id="line-3075" name="line-3075"></a><span class="w">				</span><span class="o">*</span><span class="n">p</span><span class="o">++</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\t&#39;</span><span class="p">;</span>
<a id="line-3076" name="line-3076"></a><span class="w">				</span><span class="k">break</span><span class="p">;</span>
<a id="line-3077" name="line-3077"></a><span class="w">			</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;n&#39;</span><span class="p">:</span>
<a id="line-3078" name="line-3078"></a><span class="w">				</span><span class="o">*</span><span class="n">p</span><span class="o">++</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span>
<a id="line-3079" name="line-3079"></a><span class="w">				</span><span class="k">break</span><span class="p">;</span>
<a id="line-3080" name="line-3080"></a><span class="w">			</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;\\&#39;</span><span class="p">:</span>
<a id="line-3081" name="line-3081"></a><span class="w">				</span><span class="o">*</span><span class="n">p</span><span class="o">++</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\\&#39;</span><span class="p">;</span>
<a id="line-3082" name="line-3082"></a><span class="w">				</span><span class="k">break</span><span class="p">;</span>
<a id="line-3083" name="line-3083"></a><span class="w">			</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;r&#39;</span><span class="p">:</span>
<a id="line-3084" name="line-3084"></a><span class="w">				</span><span class="o">*</span><span class="n">p</span><span class="o">++</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\r&#39;</span><span class="p">;</span>
<a id="line-3085" name="line-3085"></a><span class="w">				</span><span class="k">break</span><span class="p">;</span>
<a id="line-3086" name="line-3086"></a><span class="w">			</span><span class="k">default</span><span class="o">:</span>
<a id="line-3087" name="line-3087"></a><span class="w">				</span><span class="o">*</span><span class="n">p</span><span class="o">++</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\\&#39;</span><span class="p">;</span>
<a id="line-3088" name="line-3088"></a><span class="w">				</span><span class="o">*</span><span class="n">p</span><span class="o">++</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">s</span><span class="p">;</span>
<a id="line-3089" name="line-3089"></a><span class="w">				</span><span class="k">break</span><span class="p">;</span>
<a id="line-3090" name="line-3090"></a><span class="w">			</span><span class="p">}</span>
<a id="line-3091" name="line-3091"></a><span class="w">		</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-3092" name="line-3092"></a><span class="w">			</span><span class="o">*</span><span class="n">p</span><span class="o">++</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">s</span><span class="p">;</span>
<a id="line-3093" name="line-3093"></a><span class="w">		</span><span class="p">}</span>
<a id="line-3094" name="line-3094"></a><span class="w">	</span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">s</span><span class="o">++</span><span class="p">);</span>
<a id="line-3095" name="line-3095"></a>
<a id="line-3096" name="line-3096"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">q</span><span class="p">;</span>
<a id="line-3097" name="line-3097"></a><span class="p">}</span>
<a id="line-3098" name="line-3098"></a>
<a id="line-3099" name="line-3099"></a><span class="k">static</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span>
<a id="line-3100" name="line-3100"></a><span class="n">escape_string_and_dup</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">s</span><span class="p">)</span>
<a id="line-3101" name="line-3101"></a><span class="p">{</span>
<a id="line-3102" name="line-3102"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">return_value</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">;</span>
<a id="line-3103" name="line-3103"></a><span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">q</span><span class="p">;</span>
<a id="line-3104" name="line-3104"></a><span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="line-3105" name="line-3105"></a>
<a id="line-3106" name="line-3106"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-3107" name="line-3107"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">g_strdup</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">);</span>
<a id="line-3108" name="line-3108"></a>
<a id="line-3109" name="line-3109"></a><span class="w">	</span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">;</span>
<a id="line-3110" name="line-3110"></a><span class="w">	</span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">q</span><span class="p">){</span>
<a id="line-3111" name="line-3111"></a><span class="w">		</span><span class="n">len</span><span class="o">++</span><span class="p">;</span>
<a id="line-3112" name="line-3112"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">strchr</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n\r\t\\</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-3113" name="line-3113"></a><span class="w">			</span><span class="n">len</span><span class="o">++</span><span class="p">;</span>
<a id="line-3114" name="line-3114"></a><span class="w">		</span><span class="n">q</span><span class="o">++</span><span class="p">;</span>
<a id="line-3115" name="line-3115"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3116" name="line-3116"></a><span class="w">	</span><span class="n">return_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">g_malloc</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="line-3117" name="line-3117"></a><span class="w">	</span><span class="k">do</span><span class="w"> </span><span class="p">{</span>
<a id="line-3118" name="line-3118"></a><span class="w">		</span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">s</span><span class="p">){</span>
<a id="line-3119" name="line-3119"></a><span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;\t&#39;</span><span class="p">:</span>
<a id="line-3120" name="line-3120"></a><span class="w">			</span><span class="o">*</span><span class="n">p</span><span class="o">++</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\\&#39;</span><span class="p">;</span>
<a id="line-3121" name="line-3121"></a><span class="w">			</span><span class="o">*</span><span class="n">p</span><span class="o">++</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;t&#39;</span><span class="p">;</span>
<a id="line-3122" name="line-3122"></a><span class="w">			</span><span class="k">break</span><span class="p">;</span>
<a id="line-3123" name="line-3123"></a><span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">:</span>
<a id="line-3124" name="line-3124"></a><span class="w">			</span><span class="o">*</span><span class="n">p</span><span class="o">++</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\\&#39;</span><span class="p">;</span>
<a id="line-3125" name="line-3125"></a><span class="w">			</span><span class="o">*</span><span class="n">p</span><span class="o">++</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;n&#39;</span><span class="p">;</span>
<a id="line-3126" name="line-3126"></a><span class="w">			</span><span class="k">break</span><span class="p">;</span>
<a id="line-3127" name="line-3127"></a><span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;\r&#39;</span><span class="p">:</span>
<a id="line-3128" name="line-3128"></a><span class="w">			</span><span class="o">*</span><span class="n">p</span><span class="o">++</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\\&#39;</span><span class="p">;</span>
<a id="line-3129" name="line-3129"></a><span class="w">			</span><span class="o">*</span><span class="n">p</span><span class="o">++</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;r&#39;</span><span class="p">;</span>
<a id="line-3130" name="line-3130"></a><span class="w">			</span><span class="k">break</span><span class="p">;</span>
<a id="line-3131" name="line-3131"></a><span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;\\&#39;</span><span class="p">:</span>
<a id="line-3132" name="line-3132"></a><span class="w">			</span><span class="o">*</span><span class="n">p</span><span class="o">++</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\\&#39;</span><span class="p">;</span>
<a id="line-3133" name="line-3133"></a><span class="w">			</span><span class="o">*</span><span class="n">p</span><span class="o">++</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\\&#39;</span><span class="p">;</span>
<a id="line-3134" name="line-3134"></a><span class="w">			</span><span class="k">break</span><span class="p">;</span>
<a id="line-3135" name="line-3135"></a><span class="w">		</span><span class="k">default</span><span class="o">:</span>
<a id="line-3136" name="line-3136"></a><span class="w">			</span><span class="o">*</span><span class="n">p</span><span class="o">++</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">s</span><span class="p">;</span>
<a id="line-3137" name="line-3137"></a><span class="w">		</span><span class="p">}</span>
<a id="line-3138" name="line-3138"></a><span class="w">	</span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">s</span><span class="o">++</span><span class="p">);</span>
<a id="line-3139" name="line-3139"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">return_value</span><span class="p">;</span>
<a id="line-3140" name="line-3140"></a><span class="p">}</span>
<a id="line-3141" name="line-3141"></a>
<a id="line-3142" name="line-3142"></a><span class="k">static</span><span class="w"> </span><span class="n">gboolean</span>
<a id="line-3143" name="line-3143"></a><span class="n">check_locale</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">locale</span><span class="p">)</span>
<a id="line-3144" name="line-3144"></a><span class="p">{</span>
<a id="line-3145" name="line-3145"></a><span class="w">	</span><span class="n">GIConv</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_iconv_open</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;UTF-8&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">locale</span><span class="p">);</span>
<a id="line-3146" name="line-3146"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">GIConv</span><span class="p">)</span><span class="mi">-1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">cd</span><span class="p">)</span>
<a id="line-3147" name="line-3147"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-3148" name="line-3148"></a><span class="w">	</span><span class="n">g_iconv_close</span><span class="w"> </span><span class="p">(</span><span class="n">cd</span><span class="p">);</span>
<a id="line-3149" name="line-3149"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
<a id="line-3150" name="line-3150"></a><span class="p">}</span>
<a id="line-3151" name="line-3151"></a>
<a id="line-3152" name="line-3152"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<a id="line-3153" name="line-3153"></a><span class="n">insert_locales</span><span class="w"> </span><span class="p">(</span><span class="n">GHashTable</span><span class="w"> </span><span class="o">*</span><span class="n">encodings</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">enc</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span>
<a id="line-3154" name="line-3154"></a><span class="p">{</span>
<a id="line-3155" name="line-3155"></a><span class="w">	</span><span class="kt">va_list</span><span class="w"> </span><span class="n">args</span><span class="p">;</span>
<a id="line-3156" name="line-3156"></a><span class="hll"><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">s</span><span class="p">;</span><div class="verbose expandable"><span class="error2">&lt;--- The scope of the variable 's' can be reduced. <span class="marker">[+]</span></span><div class="content">The scope of the variable &apos;s&apos; can be reduced. Warning: Be careful when fixing this message, especially when there are inner loops. Here is an example where cppcheck will write that the scope for &apos;i&apos; can be reduced:
void f(int x)
{
    int i = 0;
    if (x) {
        // it&apos;s safe to move &apos;int i = 0;&apos; here
        for (int n = 0; n &lt; 10; ++n) {
            // it is possible but not safe to move &apos;int i = 0;&apos; here
            do_something(&amp;i);
        }
    }
}
When you see this message it is always safe to reduce the variable scope 1 level.</div></div>
</span><a id="line-3157" name="line-3157"></a>
<a id="line-3158" name="line-3158"></a><span class="w">	</span><span class="n">va_start</span><span class="w"> </span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">enc</span><span class="p">);</span>
<a id="line-3159" name="line-3159"></a><span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(;;)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3160" name="line-3160"></a><span class="w">		</span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">va_arg</span><span class="w"> </span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">);</span>
<a id="line-3161" name="line-3161"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-3162" name="line-3162"></a><span class="w">			</span><span class="k">break</span><span class="p">;</span>
<a id="line-3163" name="line-3163"></a><span class="w">		</span><span class="n">g_hash_table_insert</span><span class="w"> </span><span class="p">(</span><span class="n">encodings</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">enc</span><span class="p">);</span>
<a id="line-3164" name="line-3164"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3165" name="line-3165"></a><span class="w">	</span><span class="n">va_end</span><span class="w"> </span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
<a id="line-3166" name="line-3166"></a><span class="p">}</span>
<a id="line-3167" name="line-3167"></a>
<a id="line-3168" name="line-3168"></a><span class="cm">/* make a standard conversion table from the desktop standard spec */</span>
<a id="line-3169" name="line-3169"></a><span class="k">static</span><span class="w"> </span><span class="n">GHashTable</span><span class="w"> </span><span class="o">*</span>
<a id="line-3170" name="line-3170"></a><span class="n">init_encodings</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<a id="line-3171" name="line-3171"></a><span class="p">{</span>
<a id="line-3172" name="line-3172"></a><span class="w">	</span><span class="n">GHashTable</span><span class="w"> </span><span class="o">*</span><span class="n">encodings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_hash_table_new</span><span class="w"> </span><span class="p">(</span><span class="n">g_str_hash</span><span class="p">,</span><span class="w"> </span><span class="n">g_str_equal</span><span class="p">);</span>
<a id="line-3173" name="line-3173"></a>
<a id="line-3174" name="line-3174"></a><span class="w">	</span><span class="cm">/* &quot;C&quot; is plain ascii */</span>
<a id="line-3175" name="line-3175"></a><span class="hll"><span class="w">	</span><span class="n">insert_locales</span><span class="w"> </span><span class="p">(</span><span class="n">encodings</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ASCII&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><div class="verbose expandable"><span class="error2">&lt;--- Passing NULL after the last typed argument to a variadic function leads to undefined behaviour. <span class="marker">[+]</span></span><div class="content">Passing NULL after the last typed argument to a variadic function leads to undefined behaviour.
The C99 standard, in section 7.15.1.1, states that if the type used by va_arg() is not compatible with the type of the actual next argument (as promoted according to the default argument promotions), the behavior is undefined.
The value of the NULL macro is an implementation-defined null pointer constant (7.17), which can be any integer constant expression with the value 0, or such an expression casted to (void*) (6.3.2.3). This includes values like 0, 0L, or even 0LL.
In practice on common architectures, this will cause real crashes if sizeof(int) != sizeof(void*), and NULL is defined to 0 or any other null pointer constant that promotes to int.
To reproduce you might be able to use this little code example on 64bit platforms. If the output includes &quot;ERROR&quot;, the sentinel had only 4 out of 8 bytes initialized to zero and was not detected as the final argument to stop argument processing via va_arg(). Changing the 0 to (void*)0 or 0L will make the &quot;ERROR&quot; output go away.
#include &lt;stdarg.h&gt;
#include &lt;stdio.h&gt;

void f(char *s, ...) {
    va_list ap;
    va_start(ap,s);
    for (;;) {
        char *p = va_arg(ap,char*);
        printf(&quot;%018p, %s\n&quot;, p, (long)p &amp; 255 ? p : &quot;&quot;);
        if(!p) break;
    }
    va_end(ap);
}

void g() {
    char *s2 = &quot;x&quot;;
    char *s3 = &quot;ERROR&quot;;

    // changing 0 to 0L for the 7th argument (which is intended to act as sentinel) makes the error go away on x86_64
    f(&quot;first&quot;, s2, s2, s2, s2, s2, 0, s3, (char*)0);
}

void h() {
    int i;
    volatile unsigned char a[1000];
    for (i = 0; i&lt;sizeof(a); i++)
        a[i] = -1;
}

int main() {
    h();
    g();
    return 0;
}</div></div>
</span><a id="line-3176" name="line-3176"></a>
<a id="line-3177" name="line-3177"></a><span class="hll"><span class="w">	</span><span class="n">insert_locales</span><span class="w"> </span><span class="p">(</span><span class="n">encodings</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ARMSCII-8&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;by&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><div class="verbose expandable"><span class="error2">&lt;--- Passing NULL after the last typed argument to a variadic function leads to undefined behaviour. <span class="marker">[+]</span></span><div class="content">Passing NULL after the last typed argument to a variadic function leads to undefined behaviour.
The C99 standard, in section 7.15.1.1, states that if the type used by va_arg() is not compatible with the type of the actual next argument (as promoted according to the default argument promotions), the behavior is undefined.
The value of the NULL macro is an implementation-defined null pointer constant (7.17), which can be any integer constant expression with the value 0, or such an expression casted to (void*) (6.3.2.3). This includes values like 0, 0L, or even 0LL.
In practice on common architectures, this will cause real crashes if sizeof(int) != sizeof(void*), and NULL is defined to 0 or any other null pointer constant that promotes to int.
To reproduce you might be able to use this little code example on 64bit platforms. If the output includes &quot;ERROR&quot;, the sentinel had only 4 out of 8 bytes initialized to zero and was not detected as the final argument to stop argument processing via va_arg(). Changing the 0 to (void*)0 or 0L will make the &quot;ERROR&quot; output go away.
#include &lt;stdarg.h&gt;
#include &lt;stdio.h&gt;

void f(char *s, ...) {
    va_list ap;
    va_start(ap,s);
    for (;;) {
        char *p = va_arg(ap,char*);
        printf(&quot;%018p, %s\n&quot;, p, (long)p &amp; 255 ? p : &quot;&quot;);
        if(!p) break;
    }
    va_end(ap);
}

void g() {
    char *s2 = &quot;x&quot;;
    char *s3 = &quot;ERROR&quot;;

    // changing 0 to 0L for the 7th argument (which is intended to act as sentinel) makes the error go away on x86_64
    f(&quot;first&quot;, s2, s2, s2, s2, s2, 0, s3, (char*)0);
}

void h() {
    int i;
    volatile unsigned char a[1000];
    for (i = 0; i&lt;sizeof(a); i++)
        a[i] = -1;
}

int main() {
    h();
    g();
    return 0;
}</div></div>
</span><a id="line-3178" name="line-3178"></a><span class="hll"><span class="w">	</span><span class="n">insert_locales</span><span class="w"> </span><span class="p">(</span><span class="n">encodings</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;BIG5&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;zh_TW&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><div class="verbose expandable"><span class="error2">&lt;--- Passing NULL after the last typed argument to a variadic function leads to undefined behaviour. <span class="marker">[+]</span></span><div class="content">Passing NULL after the last typed argument to a variadic function leads to undefined behaviour.
The C99 standard, in section 7.15.1.1, states that if the type used by va_arg() is not compatible with the type of the actual next argument (as promoted according to the default argument promotions), the behavior is undefined.
The value of the NULL macro is an implementation-defined null pointer constant (7.17), which can be any integer constant expression with the value 0, or such an expression casted to (void*) (6.3.2.3). This includes values like 0, 0L, or even 0LL.
In practice on common architectures, this will cause real crashes if sizeof(int) != sizeof(void*), and NULL is defined to 0 or any other null pointer constant that promotes to int.
To reproduce you might be able to use this little code example on 64bit platforms. If the output includes &quot;ERROR&quot;, the sentinel had only 4 out of 8 bytes initialized to zero and was not detected as the final argument to stop argument processing via va_arg(). Changing the 0 to (void*)0 or 0L will make the &quot;ERROR&quot; output go away.
#include &lt;stdarg.h&gt;
#include &lt;stdio.h&gt;

void f(char *s, ...) {
    va_list ap;
    va_start(ap,s);
    for (;;) {
        char *p = va_arg(ap,char*);
        printf(&quot;%018p, %s\n&quot;, p, (long)p &amp; 255 ? p : &quot;&quot;);
        if(!p) break;
    }
    va_end(ap);
}

void g() {
    char *s2 = &quot;x&quot;;
    char *s3 = &quot;ERROR&quot;;

    // changing 0 to 0L for the 7th argument (which is intended to act as sentinel) makes the error go away on x86_64
    f(&quot;first&quot;, s2, s2, s2, s2, s2, 0, s3, (char*)0);
}

void h() {
    int i;
    volatile unsigned char a[1000];
    for (i = 0; i&lt;sizeof(a); i++)
        a[i] = -1;
}

int main() {
    h();
    g();
    return 0;
}</div></div>
</span><a id="line-3179" name="line-3179"></a><span class="hll"><span class="w">	</span><span class="n">insert_locales</span><span class="w"> </span><span class="p">(</span><span class="n">encodings</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;CP1251&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;be&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;bg&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><div class="verbose expandable"><span class="error2">&lt;--- Passing NULL after the last typed argument to a variadic function leads to undefined behaviour. <span class="marker">[+]</span></span><div class="content">Passing NULL after the last typed argument to a variadic function leads to undefined behaviour.
The C99 standard, in section 7.15.1.1, states that if the type used by va_arg() is not compatible with the type of the actual next argument (as promoted according to the default argument promotions), the behavior is undefined.
The value of the NULL macro is an implementation-defined null pointer constant (7.17), which can be any integer constant expression with the value 0, or such an expression casted to (void*) (6.3.2.3). This includes values like 0, 0L, or even 0LL.
In practice on common architectures, this will cause real crashes if sizeof(int) != sizeof(void*), and NULL is defined to 0 or any other null pointer constant that promotes to int.
To reproduce you might be able to use this little code example on 64bit platforms. If the output includes &quot;ERROR&quot;, the sentinel had only 4 out of 8 bytes initialized to zero and was not detected as the final argument to stop argument processing via va_arg(). Changing the 0 to (void*)0 or 0L will make the &quot;ERROR&quot; output go away.
#include &lt;stdarg.h&gt;
#include &lt;stdio.h&gt;

void f(char *s, ...) {
    va_list ap;
    va_start(ap,s);
    for (;;) {
        char *p = va_arg(ap,char*);
        printf(&quot;%018p, %s\n&quot;, p, (long)p &amp; 255 ? p : &quot;&quot;);
        if(!p) break;
    }
    va_end(ap);
}

void g() {
    char *s2 = &quot;x&quot;;
    char *s3 = &quot;ERROR&quot;;

    // changing 0 to 0L for the 7th argument (which is intended to act as sentinel) makes the error go away on x86_64
    f(&quot;first&quot;, s2, s2, s2, s2, s2, 0, s3, (char*)0);
}

void h() {
    int i;
    volatile unsigned char a[1000];
    for (i = 0; i&lt;sizeof(a); i++)
        a[i] = -1;
}

int main() {
    h();
    g();
    return 0;
}</div></div>
</span><a id="line-3180" name="line-3180"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">check_locale</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;EUC-CN&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="line-3181" name="line-3181"></a><span class="hll"><span class="w">		</span><span class="n">insert_locales</span><span class="w"> </span><span class="p">(</span><span class="n">encodings</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;EUC-CN&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;zh_CN&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><div class="verbose expandable"><span class="error2">&lt;--- Passing NULL after the last typed argument to a variadic function leads to undefined behaviour. <span class="marker">[+]</span></span><div class="content">Passing NULL after the last typed argument to a variadic function leads to undefined behaviour.
The C99 standard, in section 7.15.1.1, states that if the type used by va_arg() is not compatible with the type of the actual next argument (as promoted according to the default argument promotions), the behavior is undefined.
The value of the NULL macro is an implementation-defined null pointer constant (7.17), which can be any integer constant expression with the value 0, or such an expression casted to (void*) (6.3.2.3). This includes values like 0, 0L, or even 0LL.
In practice on common architectures, this will cause real crashes if sizeof(int) != sizeof(void*), and NULL is defined to 0 or any other null pointer constant that promotes to int.
To reproduce you might be able to use this little code example on 64bit platforms. If the output includes &quot;ERROR&quot;, the sentinel had only 4 out of 8 bytes initialized to zero and was not detected as the final argument to stop argument processing via va_arg(). Changing the 0 to (void*)0 or 0L will make the &quot;ERROR&quot; output go away.
#include &lt;stdarg.h&gt;
#include &lt;stdio.h&gt;

void f(char *s, ...) {
    va_list ap;
    va_start(ap,s);
    for (;;) {
        char *p = va_arg(ap,char*);
        printf(&quot;%018p, %s\n&quot;, p, (long)p &amp; 255 ? p : &quot;&quot;);
        if(!p) break;
    }
    va_end(ap);
}

void g() {
    char *s2 = &quot;x&quot;;
    char *s3 = &quot;ERROR&quot;;

    // changing 0 to 0L for the 7th argument (which is intended to act as sentinel) makes the error go away on x86_64
    f(&quot;first&quot;, s2, s2, s2, s2, s2, 0, s3, (char*)0);
}

void h() {
    int i;
    volatile unsigned char a[1000];
    for (i = 0; i&lt;sizeof(a); i++)
        a[i] = -1;
}

int main() {
    h();
    g();
    return 0;
}</div></div>
</span><a id="line-3182" name="line-3182"></a><span class="w">	</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-3183" name="line-3183"></a><span class="hll"><span class="w">		</span><span class="n">insert_locales</span><span class="w"> </span><span class="p">(</span><span class="n">encodings</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;GB2312&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;zh_CN&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><div class="verbose expandable"><span class="error2">&lt;--- Passing NULL after the last typed argument to a variadic function leads to undefined behaviour. <span class="marker">[+]</span></span><div class="content">Passing NULL after the last typed argument to a variadic function leads to undefined behaviour.
The C99 standard, in section 7.15.1.1, states that if the type used by va_arg() is not compatible with the type of the actual next argument (as promoted according to the default argument promotions), the behavior is undefined.
The value of the NULL macro is an implementation-defined null pointer constant (7.17), which can be any integer constant expression with the value 0, or such an expression casted to (void*) (6.3.2.3). This includes values like 0, 0L, or even 0LL.
In practice on common architectures, this will cause real crashes if sizeof(int) != sizeof(void*), and NULL is defined to 0 or any other null pointer constant that promotes to int.
To reproduce you might be able to use this little code example on 64bit platforms. If the output includes &quot;ERROR&quot;, the sentinel had only 4 out of 8 bytes initialized to zero and was not detected as the final argument to stop argument processing via va_arg(). Changing the 0 to (void*)0 or 0L will make the &quot;ERROR&quot; output go away.
#include &lt;stdarg.h&gt;
#include &lt;stdio.h&gt;

void f(char *s, ...) {
    va_list ap;
    va_start(ap,s);
    for (;;) {
        char *p = va_arg(ap,char*);
        printf(&quot;%018p, %s\n&quot;, p, (long)p &amp; 255 ? p : &quot;&quot;);
        if(!p) break;
    }
    va_end(ap);
}

void g() {
    char *s2 = &quot;x&quot;;
    char *s3 = &quot;ERROR&quot;;

    // changing 0 to 0L for the 7th argument (which is intended to act as sentinel) makes the error go away on x86_64
    f(&quot;first&quot;, s2, s2, s2, s2, s2, 0, s3, (char*)0);
}

void h() {
    int i;
    volatile unsigned char a[1000];
    for (i = 0; i&lt;sizeof(a); i++)
        a[i] = -1;
}

int main() {
    h();
    g();
    return 0;
}</div></div>
</span><a id="line-3184" name="line-3184"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3185" name="line-3185"></a><span class="hll"><span class="w">	</span><span class="n">insert_locales</span><span class="w"> </span><span class="p">(</span><span class="n">encodings</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;EUC-JP&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ja&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><div class="verbose expandable"><span class="error2">&lt;--- Passing NULL after the last typed argument to a variadic function leads to undefined behaviour. <span class="marker">[+]</span></span><div class="content">Passing NULL after the last typed argument to a variadic function leads to undefined behaviour.
The C99 standard, in section 7.15.1.1, states that if the type used by va_arg() is not compatible with the type of the actual next argument (as promoted according to the default argument promotions), the behavior is undefined.
The value of the NULL macro is an implementation-defined null pointer constant (7.17), which can be any integer constant expression with the value 0, or such an expression casted to (void*) (6.3.2.3). This includes values like 0, 0L, or even 0LL.
In practice on common architectures, this will cause real crashes if sizeof(int) != sizeof(void*), and NULL is defined to 0 or any other null pointer constant that promotes to int.
To reproduce you might be able to use this little code example on 64bit platforms. If the output includes &quot;ERROR&quot;, the sentinel had only 4 out of 8 bytes initialized to zero and was not detected as the final argument to stop argument processing via va_arg(). Changing the 0 to (void*)0 or 0L will make the &quot;ERROR&quot; output go away.
#include &lt;stdarg.h&gt;
#include &lt;stdio.h&gt;

void f(char *s, ...) {
    va_list ap;
    va_start(ap,s);
    for (;;) {
        char *p = va_arg(ap,char*);
        printf(&quot;%018p, %s\n&quot;, p, (long)p &amp; 255 ? p : &quot;&quot;);
        if(!p) break;
    }
    va_end(ap);
}

void g() {
    char *s2 = &quot;x&quot;;
    char *s3 = &quot;ERROR&quot;;

    // changing 0 to 0L for the 7th argument (which is intended to act as sentinel) makes the error go away on x86_64
    f(&quot;first&quot;, s2, s2, s2, s2, s2, 0, s3, (char*)0);
}

void h() {
    int i;
    volatile unsigned char a[1000];
    for (i = 0; i&lt;sizeof(a); i++)
        a[i] = -1;
}

int main() {
    h();
    g();
    return 0;
}</div></div>
</span><a id="line-3186" name="line-3186"></a><span class="hll"><span class="w">	</span><span class="n">insert_locales</span><span class="w"> </span><span class="p">(</span><span class="n">encodings</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;EUC-KR&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ko&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><div class="verbose expandable"><span class="error2">&lt;--- Passing NULL after the last typed argument to a variadic function leads to undefined behaviour. <span class="marker">[+]</span></span><div class="content">Passing NULL after the last typed argument to a variadic function leads to undefined behaviour.
The C99 standard, in section 7.15.1.1, states that if the type used by va_arg() is not compatible with the type of the actual next argument (as promoted according to the default argument promotions), the behavior is undefined.
The value of the NULL macro is an implementation-defined null pointer constant (7.17), which can be any integer constant expression with the value 0, or such an expression casted to (void*) (6.3.2.3). This includes values like 0, 0L, or even 0LL.
In practice on common architectures, this will cause real crashes if sizeof(int) != sizeof(void*), and NULL is defined to 0 or any other null pointer constant that promotes to int.
To reproduce you might be able to use this little code example on 64bit platforms. If the output includes &quot;ERROR&quot;, the sentinel had only 4 out of 8 bytes initialized to zero and was not detected as the final argument to stop argument processing via va_arg(). Changing the 0 to (void*)0 or 0L will make the &quot;ERROR&quot; output go away.
#include &lt;stdarg.h&gt;
#include &lt;stdio.h&gt;

void f(char *s, ...) {
    va_list ap;
    va_start(ap,s);
    for (;;) {
        char *p = va_arg(ap,char*);
        printf(&quot;%018p, %s\n&quot;, p, (long)p &amp; 255 ? p : &quot;&quot;);
        if(!p) break;
    }
    va_end(ap);
}

void g() {
    char *s2 = &quot;x&quot;;
    char *s3 = &quot;ERROR&quot;;

    // changing 0 to 0L for the 7th argument (which is intended to act as sentinel) makes the error go away on x86_64
    f(&quot;first&quot;, s2, s2, s2, s2, s2, 0, s3, (char*)0);
}

void h() {
    int i;
    volatile unsigned char a[1000];
    for (i = 0; i&lt;sizeof(a); i++)
        a[i] = -1;
}

int main() {
    h();
    g();
    return 0;
}</div></div>
</span><a id="line-3187" name="line-3187"></a><span class="w">	</span><span class="cm">/*insert_locales (encodings, &quot;GEORGIAN-ACADEMY&quot;, NULL);*/</span>
<a id="line-3188" name="line-3188"></a><span class="hll"><span class="w">	</span><span class="n">insert_locales</span><span class="w"> </span><span class="p">(</span><span class="n">encodings</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;GEORGIAN-PS&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ka&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><div class="verbose expandable"><span class="error2">&lt;--- Passing NULL after the last typed argument to a variadic function leads to undefined behaviour. <span class="marker">[+]</span></span><div class="content">Passing NULL after the last typed argument to a variadic function leads to undefined behaviour.
The C99 standard, in section 7.15.1.1, states that if the type used by va_arg() is not compatible with the type of the actual next argument (as promoted according to the default argument promotions), the behavior is undefined.
The value of the NULL macro is an implementation-defined null pointer constant (7.17), which can be any integer constant expression with the value 0, or such an expression casted to (void*) (6.3.2.3). This includes values like 0, 0L, or even 0LL.
In practice on common architectures, this will cause real crashes if sizeof(int) != sizeof(void*), and NULL is defined to 0 or any other null pointer constant that promotes to int.
To reproduce you might be able to use this little code example on 64bit platforms. If the output includes &quot;ERROR&quot;, the sentinel had only 4 out of 8 bytes initialized to zero and was not detected as the final argument to stop argument processing via va_arg(). Changing the 0 to (void*)0 or 0L will make the &quot;ERROR&quot; output go away.
#include &lt;stdarg.h&gt;
#include &lt;stdio.h&gt;

void f(char *s, ...) {
    va_list ap;
    va_start(ap,s);
    for (;;) {
        char *p = va_arg(ap,char*);
        printf(&quot;%018p, %s\n&quot;, p, (long)p &amp; 255 ? p : &quot;&quot;);
        if(!p) break;
    }
    va_end(ap);
}

void g() {
    char *s2 = &quot;x&quot;;
    char *s3 = &quot;ERROR&quot;;

    // changing 0 to 0L for the 7th argument (which is intended to act as sentinel) makes the error go away on x86_64
    f(&quot;first&quot;, s2, s2, s2, s2, s2, 0, s3, (char*)0);
}

void h() {
    int i;
    volatile unsigned char a[1000];
    for (i = 0; i&lt;sizeof(a); i++)
        a[i] = -1;
}

int main() {
    h();
    g();
    return 0;
}</div></div>
</span><a id="line-3189" name="line-3189"></a><span class="hll"><span class="w">	</span><span class="n">insert_locales</span><span class="w"> </span><span class="p">(</span><span class="n">encodings</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ISO-8859-1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;br&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ca&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;da&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;de&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;en&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;es&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;eu&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;fi&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;fr&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;gl&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;it&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;nl&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;wa&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;no&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;pt&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;pt&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;sv&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><div class="verbose expandable"><span class="error2">&lt;--- Passing NULL after the last typed argument to a variadic function leads to undefined behaviour. <span class="marker">[+]</span></span><div class="content">Passing NULL after the last typed argument to a variadic function leads to undefined behaviour.
The C99 standard, in section 7.15.1.1, states that if the type used by va_arg() is not compatible with the type of the actual next argument (as promoted according to the default argument promotions), the behavior is undefined.
The value of the NULL macro is an implementation-defined null pointer constant (7.17), which can be any integer constant expression with the value 0, or such an expression casted to (void*) (6.3.2.3). This includes values like 0, 0L, or even 0LL.
In practice on common architectures, this will cause real crashes if sizeof(int) != sizeof(void*), and NULL is defined to 0 or any other null pointer constant that promotes to int.
To reproduce you might be able to use this little code example on 64bit platforms. If the output includes &quot;ERROR&quot;, the sentinel had only 4 out of 8 bytes initialized to zero and was not detected as the final argument to stop argument processing via va_arg(). Changing the 0 to (void*)0 or 0L will make the &quot;ERROR&quot; output go away.
#include &lt;stdarg.h&gt;
#include &lt;stdio.h&gt;

void f(char *s, ...) {
    va_list ap;
    va_start(ap,s);
    for (;;) {
        char *p = va_arg(ap,char*);
        printf(&quot;%018p, %s\n&quot;, p, (long)p &amp; 255 ? p : &quot;&quot;);
        if(!p) break;
    }
    va_end(ap);
}

void g() {
    char *s2 = &quot;x&quot;;
    char *s3 = &quot;ERROR&quot;;

    // changing 0 to 0L for the 7th argument (which is intended to act as sentinel) makes the error go away on x86_64
    f(&quot;first&quot;, s2, s2, s2, s2, s2, 0, s3, (char*)0);
}

void h() {
    int i;
    volatile unsigned char a[1000];
    for (i = 0; i&lt;sizeof(a); i++)
        a[i] = -1;
}

int main() {
    h();
    g();
    return 0;
}</div></div>
</span><a id="line-3190" name="line-3190"></a><span class="hll"><span class="w">	</span><span class="n">insert_locales</span><span class="w"> </span><span class="p">(</span><span class="n">encodings</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ISO-8859-2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;cs&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hr&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hu&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;pl&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ro&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;sk&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;sl&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;sq&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;sr&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><div class="verbose expandable"><span class="error2">&lt;--- Passing NULL after the last typed argument to a variadic function leads to undefined behaviour. <span class="marker">[+]</span></span><div class="content">Passing NULL after the last typed argument to a variadic function leads to undefined behaviour.
The C99 standard, in section 7.15.1.1, states that if the type used by va_arg() is not compatible with the type of the actual next argument (as promoted according to the default argument promotions), the behavior is undefined.
The value of the NULL macro is an implementation-defined null pointer constant (7.17), which can be any integer constant expression with the value 0, or such an expression casted to (void*) (6.3.2.3). This includes values like 0, 0L, or even 0LL.
In practice on common architectures, this will cause real crashes if sizeof(int) != sizeof(void*), and NULL is defined to 0 or any other null pointer constant that promotes to int.
To reproduce you might be able to use this little code example on 64bit platforms. If the output includes &quot;ERROR&quot;, the sentinel had only 4 out of 8 bytes initialized to zero and was not detected as the final argument to stop argument processing via va_arg(). Changing the 0 to (void*)0 or 0L will make the &quot;ERROR&quot; output go away.
#include &lt;stdarg.h&gt;
#include &lt;stdio.h&gt;

void f(char *s, ...) {
    va_list ap;
    va_start(ap,s);
    for (;;) {
        char *p = va_arg(ap,char*);
        printf(&quot;%018p, %s\n&quot;, p, (long)p &amp; 255 ? p : &quot;&quot;);
        if(!p) break;
    }
    va_end(ap);
}

void g() {
    char *s2 = &quot;x&quot;;
    char *s3 = &quot;ERROR&quot;;

    // changing 0 to 0L for the 7th argument (which is intended to act as sentinel) makes the error go away on x86_64
    f(&quot;first&quot;, s2, s2, s2, s2, s2, 0, s3, (char*)0);
}

void h() {
    int i;
    volatile unsigned char a[1000];
    for (i = 0; i&lt;sizeof(a); i++)
        a[i] = -1;
}

int main() {
    h();
    g();
    return 0;
}</div></div>
</span><a id="line-3191" name="line-3191"></a><span class="hll"><span class="w">	</span><span class="n">insert_locales</span><span class="w"> </span><span class="p">(</span><span class="n">encodings</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ISO-8859-3&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;eo&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><div class="verbose expandable"><span class="error2">&lt;--- Passing NULL after the last typed argument to a variadic function leads to undefined behaviour. <span class="marker">[+]</span></span><div class="content">Passing NULL after the last typed argument to a variadic function leads to undefined behaviour.
The C99 standard, in section 7.15.1.1, states that if the type used by va_arg() is not compatible with the type of the actual next argument (as promoted according to the default argument promotions), the behavior is undefined.
The value of the NULL macro is an implementation-defined null pointer constant (7.17), which can be any integer constant expression with the value 0, or such an expression casted to (void*) (6.3.2.3). This includes values like 0, 0L, or even 0LL.
In practice on common architectures, this will cause real crashes if sizeof(int) != sizeof(void*), and NULL is defined to 0 or any other null pointer constant that promotes to int.
To reproduce you might be able to use this little code example on 64bit platforms. If the output includes &quot;ERROR&quot;, the sentinel had only 4 out of 8 bytes initialized to zero and was not detected as the final argument to stop argument processing via va_arg(). Changing the 0 to (void*)0 or 0L will make the &quot;ERROR&quot; output go away.
#include &lt;stdarg.h&gt;
#include &lt;stdio.h&gt;

void f(char *s, ...) {
    va_list ap;
    va_start(ap,s);
    for (;;) {
        char *p = va_arg(ap,char*);
        printf(&quot;%018p, %s\n&quot;, p, (long)p &amp; 255 ? p : &quot;&quot;);
        if(!p) break;
    }
    va_end(ap);
}

void g() {
    char *s2 = &quot;x&quot;;
    char *s3 = &quot;ERROR&quot;;

    // changing 0 to 0L for the 7th argument (which is intended to act as sentinel) makes the error go away on x86_64
    f(&quot;first&quot;, s2, s2, s2, s2, s2, 0, s3, (char*)0);
}

void h() {
    int i;
    volatile unsigned char a[1000];
    for (i = 0; i&lt;sizeof(a); i++)
        a[i] = -1;
}

int main() {
    h();
    g();
    return 0;
}</div></div>
</span><a id="line-3192" name="line-3192"></a><span class="hll"><span class="w">	</span><span class="n">insert_locales</span><span class="w"> </span><span class="p">(</span><span class="n">encodings</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ISO-8859-5&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;mk&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;sp&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><div class="verbose expandable"><span class="error2">&lt;--- Passing NULL after the last typed argument to a variadic function leads to undefined behaviour. <span class="marker">[+]</span></span><div class="content">Passing NULL after the last typed argument to a variadic function leads to undefined behaviour.
The C99 standard, in section 7.15.1.1, states that if the type used by va_arg() is not compatible with the type of the actual next argument (as promoted according to the default argument promotions), the behavior is undefined.
The value of the NULL macro is an implementation-defined null pointer constant (7.17), which can be any integer constant expression with the value 0, or such an expression casted to (void*) (6.3.2.3). This includes values like 0, 0L, or even 0LL.
In practice on common architectures, this will cause real crashes if sizeof(int) != sizeof(void*), and NULL is defined to 0 or any other null pointer constant that promotes to int.
To reproduce you might be able to use this little code example on 64bit platforms. If the output includes &quot;ERROR&quot;, the sentinel had only 4 out of 8 bytes initialized to zero and was not detected as the final argument to stop argument processing via va_arg(). Changing the 0 to (void*)0 or 0L will make the &quot;ERROR&quot; output go away.
#include &lt;stdarg.h&gt;
#include &lt;stdio.h&gt;

void f(char *s, ...) {
    va_list ap;
    va_start(ap,s);
    for (;;) {
        char *p = va_arg(ap,char*);
        printf(&quot;%018p, %s\n&quot;, p, (long)p &amp; 255 ? p : &quot;&quot;);
        if(!p) break;
    }
    va_end(ap);
}

void g() {
    char *s2 = &quot;x&quot;;
    char *s3 = &quot;ERROR&quot;;

    // changing 0 to 0L for the 7th argument (which is intended to act as sentinel) makes the error go away on x86_64
    f(&quot;first&quot;, s2, s2, s2, s2, s2, 0, s3, (char*)0);
}

void h() {
    int i;
    volatile unsigned char a[1000];
    for (i = 0; i&lt;sizeof(a); i++)
        a[i] = -1;
}

int main() {
    h();
    g();
    return 0;
}</div></div>
</span><a id="line-3193" name="line-3193"></a><span class="hll"><span class="w">	</span><span class="n">insert_locales</span><span class="w"> </span><span class="p">(</span><span class="n">encodings</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ISO-8859-7&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;el&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><div class="verbose expandable"><span class="error2">&lt;--- Passing NULL after the last typed argument to a variadic function leads to undefined behaviour. <span class="marker">[+]</span></span><div class="content">Passing NULL after the last typed argument to a variadic function leads to undefined behaviour.
The C99 standard, in section 7.15.1.1, states that if the type used by va_arg() is not compatible with the type of the actual next argument (as promoted according to the default argument promotions), the behavior is undefined.
The value of the NULL macro is an implementation-defined null pointer constant (7.17), which can be any integer constant expression with the value 0, or such an expression casted to (void*) (6.3.2.3). This includes values like 0, 0L, or even 0LL.
In practice on common architectures, this will cause real crashes if sizeof(int) != sizeof(void*), and NULL is defined to 0 or any other null pointer constant that promotes to int.
To reproduce you might be able to use this little code example on 64bit platforms. If the output includes &quot;ERROR&quot;, the sentinel had only 4 out of 8 bytes initialized to zero and was not detected as the final argument to stop argument processing via va_arg(). Changing the 0 to (void*)0 or 0L will make the &quot;ERROR&quot; output go away.
#include &lt;stdarg.h&gt;
#include &lt;stdio.h&gt;

void f(char *s, ...) {
    va_list ap;
    va_start(ap,s);
    for (;;) {
        char *p = va_arg(ap,char*);
        printf(&quot;%018p, %s\n&quot;, p, (long)p &amp; 255 ? p : &quot;&quot;);
        if(!p) break;
    }
    va_end(ap);
}

void g() {
    char *s2 = &quot;x&quot;;
    char *s3 = &quot;ERROR&quot;;

    // changing 0 to 0L for the 7th argument (which is intended to act as sentinel) makes the error go away on x86_64
    f(&quot;first&quot;, s2, s2, s2, s2, s2, 0, s3, (char*)0);
}

void h() {
    int i;
    volatile unsigned char a[1000];
    for (i = 0; i&lt;sizeof(a); i++)
        a[i] = -1;
}

int main() {
    h();
    g();
    return 0;
}</div></div>
</span><a id="line-3194" name="line-3194"></a><span class="hll"><span class="w">	</span><span class="n">insert_locales</span><span class="w"> </span><span class="p">(</span><span class="n">encodings</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ISO-8859-9&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;tr&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><div class="verbose expandable"><span class="error2">&lt;--- Passing NULL after the last typed argument to a variadic function leads to undefined behaviour. <span class="marker">[+]</span></span><div class="content">Passing NULL after the last typed argument to a variadic function leads to undefined behaviour.
The C99 standard, in section 7.15.1.1, states that if the type used by va_arg() is not compatible with the type of the actual next argument (as promoted according to the default argument promotions), the behavior is undefined.
The value of the NULL macro is an implementation-defined null pointer constant (7.17), which can be any integer constant expression with the value 0, or such an expression casted to (void*) (6.3.2.3). This includes values like 0, 0L, or even 0LL.
In practice on common architectures, this will cause real crashes if sizeof(int) != sizeof(void*), and NULL is defined to 0 or any other null pointer constant that promotes to int.
To reproduce you might be able to use this little code example on 64bit platforms. If the output includes &quot;ERROR&quot;, the sentinel had only 4 out of 8 bytes initialized to zero and was not detected as the final argument to stop argument processing via va_arg(). Changing the 0 to (void*)0 or 0L will make the &quot;ERROR&quot; output go away.
#include &lt;stdarg.h&gt;
#include &lt;stdio.h&gt;

void f(char *s, ...) {
    va_list ap;
    va_start(ap,s);
    for (;;) {
        char *p = va_arg(ap,char*);
        printf(&quot;%018p, %s\n&quot;, p, (long)p &amp; 255 ? p : &quot;&quot;);
        if(!p) break;
    }
    va_end(ap);
}

void g() {
    char *s2 = &quot;x&quot;;
    char *s3 = &quot;ERROR&quot;;

    // changing 0 to 0L for the 7th argument (which is intended to act as sentinel) makes the error go away on x86_64
    f(&quot;first&quot;, s2, s2, s2, s2, s2, 0, s3, (char*)0);
}

void h() {
    int i;
    volatile unsigned char a[1000];
    for (i = 0; i&lt;sizeof(a); i++)
        a[i] = -1;
}

int main() {
    h();
    g();
    return 0;
}</div></div>
</span><a id="line-3195" name="line-3195"></a><span class="hll"><span class="w">	</span><span class="n">insert_locales</span><span class="w"> </span><span class="p">(</span><span class="n">encodings</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ISO-8859-13&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;lt&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;lv&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;mi&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><div class="verbose expandable"><span class="error2">&lt;--- Passing NULL after the last typed argument to a variadic function leads to undefined behaviour. <span class="marker">[+]</span></span><div class="content">Passing NULL after the last typed argument to a variadic function leads to undefined behaviour.
The C99 standard, in section 7.15.1.1, states that if the type used by va_arg() is not compatible with the type of the actual next argument (as promoted according to the default argument promotions), the behavior is undefined.
The value of the NULL macro is an implementation-defined null pointer constant (7.17), which can be any integer constant expression with the value 0, or such an expression casted to (void*) (6.3.2.3). This includes values like 0, 0L, or even 0LL.
In practice on common architectures, this will cause real crashes if sizeof(int) != sizeof(void*), and NULL is defined to 0 or any other null pointer constant that promotes to int.
To reproduce you might be able to use this little code example on 64bit platforms. If the output includes &quot;ERROR&quot;, the sentinel had only 4 out of 8 bytes initialized to zero and was not detected as the final argument to stop argument processing via va_arg(). Changing the 0 to (void*)0 or 0L will make the &quot;ERROR&quot; output go away.
#include &lt;stdarg.h&gt;
#include &lt;stdio.h&gt;

void f(char *s, ...) {
    va_list ap;
    va_start(ap,s);
    for (;;) {
        char *p = va_arg(ap,char*);
        printf(&quot;%018p, %s\n&quot;, p, (long)p &amp; 255 ? p : &quot;&quot;);
        if(!p) break;
    }
    va_end(ap);
}

void g() {
    char *s2 = &quot;x&quot;;
    char *s3 = &quot;ERROR&quot;;

    // changing 0 to 0L for the 7th argument (which is intended to act as sentinel) makes the error go away on x86_64
    f(&quot;first&quot;, s2, s2, s2, s2, s2, 0, s3, (char*)0);
}

void h() {
    int i;
    volatile unsigned char a[1000];
    for (i = 0; i&lt;sizeof(a); i++)
        a[i] = -1;
}

int main() {
    h();
    g();
    return 0;
}</div></div>
</span><a id="line-3196" name="line-3196"></a><span class="hll"><span class="w">	</span><span class="n">insert_locales</span><span class="w"> </span><span class="p">(</span><span class="n">encodings</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ISO-8859-14&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ga&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;cy&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><div class="verbose expandable"><span class="error2">&lt;--- Passing NULL after the last typed argument to a variadic function leads to undefined behaviour. <span class="marker">[+]</span></span><div class="content">Passing NULL after the last typed argument to a variadic function leads to undefined behaviour.
The C99 standard, in section 7.15.1.1, states that if the type used by va_arg() is not compatible with the type of the actual next argument (as promoted according to the default argument promotions), the behavior is undefined.
The value of the NULL macro is an implementation-defined null pointer constant (7.17), which can be any integer constant expression with the value 0, or such an expression casted to (void*) (6.3.2.3). This includes values like 0, 0L, or even 0LL.
In practice on common architectures, this will cause real crashes if sizeof(int) != sizeof(void*), and NULL is defined to 0 or any other null pointer constant that promotes to int.
To reproduce you might be able to use this little code example on 64bit platforms. If the output includes &quot;ERROR&quot;, the sentinel had only 4 out of 8 bytes initialized to zero and was not detected as the final argument to stop argument processing via va_arg(). Changing the 0 to (void*)0 or 0L will make the &quot;ERROR&quot; output go away.
#include &lt;stdarg.h&gt;
#include &lt;stdio.h&gt;

void f(char *s, ...) {
    va_list ap;
    va_start(ap,s);
    for (;;) {
        char *p = va_arg(ap,char*);
        printf(&quot;%018p, %s\n&quot;, p, (long)p &amp; 255 ? p : &quot;&quot;);
        if(!p) break;
    }
    va_end(ap);
}

void g() {
    char *s2 = &quot;x&quot;;
    char *s3 = &quot;ERROR&quot;;

    // changing 0 to 0L for the 7th argument (which is intended to act as sentinel) makes the error go away on x86_64
    f(&quot;first&quot;, s2, s2, s2, s2, s2, 0, s3, (char*)0);
}

void h() {
    int i;
    volatile unsigned char a[1000];
    for (i = 0; i&lt;sizeof(a); i++)
        a[i] = -1;
}

int main() {
    h();
    g();
    return 0;
}</div></div>
</span><a id="line-3197" name="line-3197"></a><span class="hll"><span class="w">	</span><span class="n">insert_locales</span><span class="w"> </span><span class="p">(</span><span class="n">encodings</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ISO-8859-15&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;et&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><div class="verbose expandable"><span class="error2">&lt;--- Passing NULL after the last typed argument to a variadic function leads to undefined behaviour. <span class="marker">[+]</span></span><div class="content">Passing NULL after the last typed argument to a variadic function leads to undefined behaviour.
The C99 standard, in section 7.15.1.1, states that if the type used by va_arg() is not compatible with the type of the actual next argument (as promoted according to the default argument promotions), the behavior is undefined.
The value of the NULL macro is an implementation-defined null pointer constant (7.17), which can be any integer constant expression with the value 0, or such an expression casted to (void*) (6.3.2.3). This includes values like 0, 0L, or even 0LL.
In practice on common architectures, this will cause real crashes if sizeof(int) != sizeof(void*), and NULL is defined to 0 or any other null pointer constant that promotes to int.
To reproduce you might be able to use this little code example on 64bit platforms. If the output includes &quot;ERROR&quot;, the sentinel had only 4 out of 8 bytes initialized to zero and was not detected as the final argument to stop argument processing via va_arg(). Changing the 0 to (void*)0 or 0L will make the &quot;ERROR&quot; output go away.
#include &lt;stdarg.h&gt;
#include &lt;stdio.h&gt;

void f(char *s, ...) {
    va_list ap;
    va_start(ap,s);
    for (;;) {
        char *p = va_arg(ap,char*);
        printf(&quot;%018p, %s\n&quot;, p, (long)p &amp; 255 ? p : &quot;&quot;);
        if(!p) break;
    }
    va_end(ap);
}

void g() {
    char *s2 = &quot;x&quot;;
    char *s3 = &quot;ERROR&quot;;

    // changing 0 to 0L for the 7th argument (which is intended to act as sentinel) makes the error go away on x86_64
    f(&quot;first&quot;, s2, s2, s2, s2, s2, 0, s3, (char*)0);
}

void h() {
    int i;
    volatile unsigned char a[1000];
    for (i = 0; i&lt;sizeof(a); i++)
        a[i] = -1;
}

int main() {
    h();
    g();
    return 0;
}</div></div>
</span><a id="line-3198" name="line-3198"></a><span class="hll"><span class="w">	</span><span class="n">insert_locales</span><span class="w"> </span><span class="p">(</span><span class="n">encodings</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;KOI8-R&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ru&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><div class="verbose expandable"><span class="error2">&lt;--- Passing NULL after the last typed argument to a variadic function leads to undefined behaviour. <span class="marker">[+]</span></span><div class="content">Passing NULL after the last typed argument to a variadic function leads to undefined behaviour.
The C99 standard, in section 7.15.1.1, states that if the type used by va_arg() is not compatible with the type of the actual next argument (as promoted according to the default argument promotions), the behavior is undefined.
The value of the NULL macro is an implementation-defined null pointer constant (7.17), which can be any integer constant expression with the value 0, or such an expression casted to (void*) (6.3.2.3). This includes values like 0, 0L, or even 0LL.
In practice on common architectures, this will cause real crashes if sizeof(int) != sizeof(void*), and NULL is defined to 0 or any other null pointer constant that promotes to int.
To reproduce you might be able to use this little code example on 64bit platforms. If the output includes &quot;ERROR&quot;, the sentinel had only 4 out of 8 bytes initialized to zero and was not detected as the final argument to stop argument processing via va_arg(). Changing the 0 to (void*)0 or 0L will make the &quot;ERROR&quot; output go away.
#include &lt;stdarg.h&gt;
#include &lt;stdio.h&gt;

void f(char *s, ...) {
    va_list ap;
    va_start(ap,s);
    for (;;) {
        char *p = va_arg(ap,char*);
        printf(&quot;%018p, %s\n&quot;, p, (long)p &amp; 255 ? p : &quot;&quot;);
        if(!p) break;
    }
    va_end(ap);
}

void g() {
    char *s2 = &quot;x&quot;;
    char *s3 = &quot;ERROR&quot;;

    // changing 0 to 0L for the 7th argument (which is intended to act as sentinel) makes the error go away on x86_64
    f(&quot;first&quot;, s2, s2, s2, s2, s2, 0, s3, (char*)0);
}

void h() {
    int i;
    volatile unsigned char a[1000];
    for (i = 0; i&lt;sizeof(a); i++)
        a[i] = -1;
}

int main() {
    h();
    g();
    return 0;
}</div></div>
</span><a id="line-3199" name="line-3199"></a><span class="hll"><span class="w">	</span><span class="n">insert_locales</span><span class="w"> </span><span class="p">(</span><span class="n">encodings</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;KOI8-U&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uk&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><div class="verbose expandable"><span class="error2">&lt;--- Passing NULL after the last typed argument to a variadic function leads to undefined behaviour. <span class="marker">[+]</span></span><div class="content">Passing NULL after the last typed argument to a variadic function leads to undefined behaviour.
The C99 standard, in section 7.15.1.1, states that if the type used by va_arg() is not compatible with the type of the actual next argument (as promoted according to the default argument promotions), the behavior is undefined.
The value of the NULL macro is an implementation-defined null pointer constant (7.17), which can be any integer constant expression with the value 0, or such an expression casted to (void*) (6.3.2.3). This includes values like 0, 0L, or even 0LL.
In practice on common architectures, this will cause real crashes if sizeof(int) != sizeof(void*), and NULL is defined to 0 or any other null pointer constant that promotes to int.
To reproduce you might be able to use this little code example on 64bit platforms. If the output includes &quot;ERROR&quot;, the sentinel had only 4 out of 8 bytes initialized to zero and was not detected as the final argument to stop argument processing via va_arg(). Changing the 0 to (void*)0 or 0L will make the &quot;ERROR&quot; output go away.
#include &lt;stdarg.h&gt;
#include &lt;stdio.h&gt;

void f(char *s, ...) {
    va_list ap;
    va_start(ap,s);
    for (;;) {
        char *p = va_arg(ap,char*);
        printf(&quot;%018p, %s\n&quot;, p, (long)p &amp; 255 ? p : &quot;&quot;);
        if(!p) break;
    }
    va_end(ap);
}

void g() {
    char *s2 = &quot;x&quot;;
    char *s3 = &quot;ERROR&quot;;

    // changing 0 to 0L for the 7th argument (which is intended to act as sentinel) makes the error go away on x86_64
    f(&quot;first&quot;, s2, s2, s2, s2, s2, 0, s3, (char*)0);
}

void h() {
    int i;
    volatile unsigned char a[1000];
    for (i = 0; i&lt;sizeof(a); i++)
        a[i] = -1;
}

int main() {
    h();
    g();
    return 0;
}</div></div>
</span><a id="line-3200" name="line-3200"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">check_locale</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;TCVN-5712&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="line-3201" name="line-3201"></a><span class="hll"><span class="w">		</span><span class="n">insert_locales</span><span class="w"> </span><span class="p">(</span><span class="n">encodings</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;TCVN-5712&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;vi&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><div class="verbose expandable"><span class="error2">&lt;--- Passing NULL after the last typed argument to a variadic function leads to undefined behaviour. <span class="marker">[+]</span></span><div class="content">Passing NULL after the last typed argument to a variadic function leads to undefined behaviour.
The C99 standard, in section 7.15.1.1, states that if the type used by va_arg() is not compatible with the type of the actual next argument (as promoted according to the default argument promotions), the behavior is undefined.
The value of the NULL macro is an implementation-defined null pointer constant (7.17), which can be any integer constant expression with the value 0, or such an expression casted to (void*) (6.3.2.3). This includes values like 0, 0L, or even 0LL.
In practice on common architectures, this will cause real crashes if sizeof(int) != sizeof(void*), and NULL is defined to 0 or any other null pointer constant that promotes to int.
To reproduce you might be able to use this little code example on 64bit platforms. If the output includes &quot;ERROR&quot;, the sentinel had only 4 out of 8 bytes initialized to zero and was not detected as the final argument to stop argument processing via va_arg(). Changing the 0 to (void*)0 or 0L will make the &quot;ERROR&quot; output go away.
#include &lt;stdarg.h&gt;
#include &lt;stdio.h&gt;

void f(char *s, ...) {
    va_list ap;
    va_start(ap,s);
    for (;;) {
        char *p = va_arg(ap,char*);
        printf(&quot;%018p, %s\n&quot;, p, (long)p &amp; 255 ? p : &quot;&quot;);
        if(!p) break;
    }
    va_end(ap);
}

void g() {
    char *s2 = &quot;x&quot;;
    char *s3 = &quot;ERROR&quot;;

    // changing 0 to 0L for the 7th argument (which is intended to act as sentinel) makes the error go away on x86_64
    f(&quot;first&quot;, s2, s2, s2, s2, s2, 0, s3, (char*)0);
}

void h() {
    int i;
    volatile unsigned char a[1000];
    for (i = 0; i&lt;sizeof(a); i++)
        a[i] = -1;
}

int main() {
    h();
    g();
    return 0;
}</div></div>
</span><a id="line-3202" name="line-3202"></a><span class="w">	</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-3203" name="line-3203"></a><span class="hll"><span class="w">		</span><span class="n">insert_locales</span><span class="w"> </span><span class="p">(</span><span class="n">encodings</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;TCVN&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;vi&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><div class="verbose expandable"><span class="error2">&lt;--- Passing NULL after the last typed argument to a variadic function leads to undefined behaviour. <span class="marker">[+]</span></span><div class="content">Passing NULL after the last typed argument to a variadic function leads to undefined behaviour.
The C99 standard, in section 7.15.1.1, states that if the type used by va_arg() is not compatible with the type of the actual next argument (as promoted according to the default argument promotions), the behavior is undefined.
The value of the NULL macro is an implementation-defined null pointer constant (7.17), which can be any integer constant expression with the value 0, or such an expression casted to (void*) (6.3.2.3). This includes values like 0, 0L, or even 0LL.
In practice on common architectures, this will cause real crashes if sizeof(int) != sizeof(void*), and NULL is defined to 0 or any other null pointer constant that promotes to int.
To reproduce you might be able to use this little code example on 64bit platforms. If the output includes &quot;ERROR&quot;, the sentinel had only 4 out of 8 bytes initialized to zero and was not detected as the final argument to stop argument processing via va_arg(). Changing the 0 to (void*)0 or 0L will make the &quot;ERROR&quot; output go away.
#include &lt;stdarg.h&gt;
#include &lt;stdio.h&gt;

void f(char *s, ...) {
    va_list ap;
    va_start(ap,s);
    for (;;) {
        char *p = va_arg(ap,char*);
        printf(&quot;%018p, %s\n&quot;, p, (long)p &amp; 255 ? p : &quot;&quot;);
        if(!p) break;
    }
    va_end(ap);
}

void g() {
    char *s2 = &quot;x&quot;;
    char *s3 = &quot;ERROR&quot;;

    // changing 0 to 0L for the 7th argument (which is intended to act as sentinel) makes the error go away on x86_64
    f(&quot;first&quot;, s2, s2, s2, s2, s2, 0, s3, (char*)0);
}

void h() {
    int i;
    volatile unsigned char a[1000];
    for (i = 0; i&lt;sizeof(a); i++)
        a[i] = -1;
}

int main() {
    h();
    g();
    return 0;
}</div></div>
</span><a id="line-3204" name="line-3204"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3205" name="line-3205"></a><span class="hll"><span class="w">	</span><span class="n">insert_locales</span><span class="w"> </span><span class="p">(</span><span class="n">encodings</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;TIS-620&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;th&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><div class="verbose expandable"><span class="error2">&lt;--- Passing NULL after the last typed argument to a variadic function leads to undefined behaviour. <span class="marker">[+]</span></span><div class="content">Passing NULL after the last typed argument to a variadic function leads to undefined behaviour.
The C99 standard, in section 7.15.1.1, states that if the type used by va_arg() is not compatible with the type of the actual next argument (as promoted according to the default argument promotions), the behavior is undefined.
The value of the NULL macro is an implementation-defined null pointer constant (7.17), which can be any integer constant expression with the value 0, or such an expression casted to (void*) (6.3.2.3). This includes values like 0, 0L, or even 0LL.
In practice on common architectures, this will cause real crashes if sizeof(int) != sizeof(void*), and NULL is defined to 0 or any other null pointer constant that promotes to int.
To reproduce you might be able to use this little code example on 64bit platforms. If the output includes &quot;ERROR&quot;, the sentinel had only 4 out of 8 bytes initialized to zero and was not detected as the final argument to stop argument processing via va_arg(). Changing the 0 to (void*)0 or 0L will make the &quot;ERROR&quot; output go away.
#include &lt;stdarg.h&gt;
#include &lt;stdio.h&gt;

void f(char *s, ...) {
    va_list ap;
    va_start(ap,s);
    for (;;) {
        char *p = va_arg(ap,char*);
        printf(&quot;%018p, %s\n&quot;, p, (long)p &amp; 255 ? p : &quot;&quot;);
        if(!p) break;
    }
    va_end(ap);
}

void g() {
    char *s2 = &quot;x&quot;;
    char *s3 = &quot;ERROR&quot;;

    // changing 0 to 0L for the 7th argument (which is intended to act as sentinel) makes the error go away on x86_64
    f(&quot;first&quot;, s2, s2, s2, s2, s2, 0, s3, (char*)0);
}

void h() {
    int i;
    volatile unsigned char a[1000];
    for (i = 0; i&lt;sizeof(a); i++)
        a[i] = -1;
}

int main() {
    h();
    g();
    return 0;
}</div></div>
</span><a id="line-3206" name="line-3206"></a><span class="w">	</span><span class="cm">/*insert_locales (encodings, &quot;VISCII&quot;, NULL);*/</span>
<a id="line-3207" name="line-3207"></a>
<a id="line-3208" name="line-3208"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">encodings</span><span class="p">;</span>
<a id="line-3209" name="line-3209"></a><span class="p">}</span>
<a id="line-3210" name="line-3210"></a>
<a id="line-3211" name="line-3211"></a><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span>
<a id="line-3212" name="line-3212"></a><span class="n">get_encoding_from_locale</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">locale</span><span class="p">)</span>
<a id="line-3213" name="line-3213"></a><span class="p">{</span>
<a id="line-3214" name="line-3214"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="n">lang</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<a id="line-3215" name="line-3215"></a><span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">encoding</span><span class="p">;</span>
<a id="line-3216" name="line-3216"></a><span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">GHashTable</span><span class="w"> </span><span class="o">*</span><span class="n">encodings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-3217" name="line-3217"></a>
<a id="line-3218" name="line-3218"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">locale</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-3219" name="line-3219"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-3220" name="line-3220"></a>
<a id="line-3221" name="line-3221"></a><span class="w">	</span><span class="cm">/* if locale includes encoding, use it */</span>
<a id="line-3222" name="line-3222"></a><span class="w">	</span><span class="n">encoding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strchr</span><span class="w"> </span><span class="p">(</span><span class="n">locale</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;.&#39;</span><span class="p">);</span>
<a id="line-3223" name="line-3223"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">encoding</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3224" name="line-3224"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">encoding</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
<a id="line-3225" name="line-3225"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3226" name="line-3226"></a>
<a id="line-3227" name="line-3227"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">encodings</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-3228" name="line-3228"></a><span class="w">		</span><span class="n">encodings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">init_encodings</span><span class="w"> </span><span class="p">();</span>
<a id="line-3229" name="line-3229"></a>
<a id="line-3230" name="line-3230"></a><span class="w">	</span><span class="cm">/* first try the entire locale (at this point ll_CC) */</span>
<a id="line-3231" name="line-3231"></a><span class="w">	</span><span class="n">encoding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_hash_table_lookup</span><span class="w"> </span><span class="p">(</span><span class="n">encodings</span><span class="p">,</span><span class="w"> </span><span class="n">locale</span><span class="p">);</span>
<a id="line-3232" name="line-3232"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">encoding</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-3233" name="line-3233"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">encoding</span><span class="p">;</span>
<a id="line-3234" name="line-3234"></a>
<a id="line-3235" name="line-3235"></a><span class="w">	</span><span class="cm">/* Try just the language */</span>
<a id="line-3236" name="line-3236"></a><span class="w">	</span><span class="n">strncpy</span><span class="w"> </span><span class="p">(</span><span class="n">lang</span><span class="p">,</span><span class="w"> </span><span class="n">locale</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<a id="line-3237" name="line-3237"></a><span class="w">	</span><span class="n">lang</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">;</span>
<a id="line-3238" name="line-3238"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">g_hash_table_lookup</span><span class="w"> </span><span class="p">(</span><span class="n">encodings</span><span class="p">,</span><span class="w"> </span><span class="n">lang</span><span class="p">);</span>
<a id="line-3239" name="line-3239"></a><span class="p">}</span>
<a id="line-3240" name="line-3240"></a>
<a id="line-3241" name="line-3241"></a><span class="k">static</span><span class="w"> </span><span class="n">Encoding</span>
<a id="line-3242" name="line-3242"></a><span class="n">get_encoding</span><span class="w"> </span><span class="p">(</span><span class="n">ReadBuf</span><span class="w"> </span><span class="o">*</span><span class="n">rb</span><span class="p">)</span>
<a id="line-3243" name="line-3243"></a><span class="p">{</span>
<a id="line-3244" name="line-3244"></a><span class="w">	</span><span class="n">gboolean</span><span class="w"> </span><span class="n">old_kde</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-3245" name="line-3245"></a><span class="w">	</span><span class="kt">char</span><span class="w">     </span><span class="n">buf</span><span class="w"> </span><span class="p">[</span><span class="n">BUFSIZ</span><span class="p">];</span>
<a id="line-3246" name="line-3246"></a><span class="w">	</span><span class="n">gboolean</span><span class="w"> </span><span class="n">all_valid_utf8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
<a id="line-3247" name="line-3247"></a>
<a id="line-3248" name="line-3248"></a><span class="w">	</span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">readbuf_gets</span><span class="w"> </span><span class="p">(</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="w"> </span><span class="p">(</span><span class="n">buf</span><span class="p">),</span><span class="w"> </span><span class="n">rb</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3249" name="line-3249"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">strncmp</span><span class="w"> </span><span class="p">(</span><span class="n">MATE_DESKTOP_ITEM_ENCODING</span><span class="p">,</span>
<a id="line-3250" name="line-3250"></a><span class="w">			     </span><span class="n">buf</span><span class="p">,</span>
<a id="line-3251" name="line-3251"></a><span class="w">			     </span><span class="n">strlen</span><span class="w"> </span><span class="p">(</span><span class="n">MATE_DESKTOP_ITEM_ENCODING</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3252" name="line-3252"></a><span class="w">			</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">buf</span><span class="p">[</span><span class="n">strlen</span><span class="w"> </span><span class="p">(</span><span class="n">MATE_DESKTOP_ITEM_ENCODING</span><span class="p">)];</span>
<a id="line-3253" name="line-3253"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39; &#39;</span><span class="p">)</span>
<a id="line-3254" name="line-3254"></a><span class="w">				</span><span class="n">p</span><span class="o">++</span><span class="p">;</span>
<a id="line-3255" name="line-3255"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="sc">&#39;=&#39;</span><span class="p">)</span>
<a id="line-3256" name="line-3256"></a><span class="w">				</span><span class="k">continue</span><span class="p">;</span>
<a id="line-3257" name="line-3257"></a><span class="w">			</span><span class="n">p</span><span class="o">++</span><span class="p">;</span>
<a id="line-3258" name="line-3258"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39; &#39;</span><span class="p">)</span>
<a id="line-3259" name="line-3259"></a><span class="w">				</span><span class="n">p</span><span class="o">++</span><span class="p">;</span>
<a id="line-3260" name="line-3260"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UTF-8&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3261" name="line-3261"></a><span class="w">				</span><span class="k">return</span><span class="w"> </span><span class="n">ENCODING_UTF8</span><span class="p">;</span>
<a id="line-3262" name="line-3262"></a><span class="w">			</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Legacy-Mixed&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3263" name="line-3263"></a><span class="w">				</span><span class="k">return</span><span class="w"> </span><span class="n">ENCODING_LEGACY_MIXED</span><span class="p">;</span>
<a id="line-3264" name="line-3264"></a><span class="w">			</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-3265" name="line-3265"></a><span class="w">				</span><span class="cm">/* According to the spec we&#39;re not supposed</span>
<a id="line-3266" name="line-3266"></a><span class="cm">				 * to read a file like this */</span>
<a id="line-3267" name="line-3267"></a><span class="w">				</span><span class="k">return</span><span class="w"> </span><span class="n">ENCODING_UNKNOWN</span><span class="p">;</span>
<a id="line-3268" name="line-3268"></a><span class="w">			</span><span class="p">}</span>
<a id="line-3269" name="line-3269"></a><span class="w">		</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;[KDE Desktop Entry]&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3270" name="line-3270"></a><span class="w">			</span><span class="n">old_kde</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
<a id="line-3271" name="line-3271"></a><span class="w">			</span><span class="cm">/* don&#39;t break yet, we still want to support</span>
<a id="line-3272" name="line-3272"></a><span class="cm">			 * Encoding even here */</span>
<a id="line-3273" name="line-3273"></a><span class="w">		</span><span class="p">}</span>
<a id="line-3274" name="line-3274"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">all_valid_utf8</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="n">g_utf8_validate</span><span class="w"> </span><span class="p">(</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">))</span>
<a id="line-3275" name="line-3275"></a><span class="w">			</span><span class="n">all_valid_utf8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-3276" name="line-3276"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3277" name="line-3277"></a>
<a id="line-3278" name="line-3278"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">old_kde</span><span class="p">)</span>
<a id="line-3279" name="line-3279"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">ENCODING_LEGACY_MIXED</span><span class="p">;</span>
<a id="line-3280" name="line-3280"></a>
<a id="line-3281" name="line-3281"></a><span class="w">	</span><span class="cm">/* try to guess by location */</span>
<a id="line-3282" name="line-3282"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">uri</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">strstr</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">uri</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;mate/apps/&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3283" name="line-3283"></a><span class="w">		</span><span class="cm">/* old mate */</span>
<a id="line-3284" name="line-3284"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">ENCODING_LEGACY_MIXED</span><span class="p">;</span>
<a id="line-3285" name="line-3285"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3286" name="line-3286"></a>
<a id="line-3287" name="line-3287"></a><span class="w">	</span><span class="cm">/* A dilemma, new KDE files are in UTF-8 but have no Encoding</span>
<a id="line-3288" name="line-3288"></a><span class="cm">	 * info, at this time we really can&#39;t tell.  The best thing to</span>
<a id="line-3289" name="line-3289"></a><span class="cm">	 * do right now is to just assume UTF-8 if the whole file</span>
<a id="line-3290" name="line-3290"></a><span class="cm">	 * validates as utf8 I suppose */</span>
<a id="line-3291" name="line-3291"></a>
<a id="line-3292" name="line-3292"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">all_valid_utf8</span><span class="p">)</span>
<a id="line-3293" name="line-3293"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">ENCODING_UTF8</span><span class="p">;</span>
<a id="line-3294" name="line-3294"></a><span class="w">	</span><span class="k">else</span>
<a id="line-3295" name="line-3295"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">ENCODING_LEGACY_MIXED</span><span class="p">;</span>
<a id="line-3296" name="line-3296"></a><span class="p">}</span>
<a id="line-3297" name="line-3297"></a>
<a id="line-3298" name="line-3298"></a><span class="k">static</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span>
<a id="line-3299" name="line-3299"></a><span class="n">decode_string</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">Encoding</span><span class="w"> </span><span class="n">encoding</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">locale</span><span class="p">)</span>
<a id="line-3300" name="line-3300"></a><span class="p">{</span>
<a id="line-3301" name="line-3301"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-3302" name="line-3302"></a>
<a id="line-3303" name="line-3303"></a><span class="w">	</span><span class="cm">/* if legacy mixed, then convert */</span>
<a id="line-3304" name="line-3304"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">locale</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">encoding</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ENCODING_LEGACY_MIXED</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3305" name="line-3305"></a><span class="w">		</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">char_encoding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_encoding_from_locale</span><span class="w"> </span><span class="p">(</span><span class="n">locale</span><span class="p">);</span>
<a id="line-3306" name="line-3306"></a><span class="w">		</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">utf8_string</span><span class="p">;</span>
<a id="line-3307" name="line-3307"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">char_encoding</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-3308" name="line-3308"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-3309" name="line-3309"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="n">char_encoding</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ASCII&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3310" name="line-3310"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">decode_string_and_dup</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
<a id="line-3311" name="line-3311"></a><span class="w">		</span><span class="p">}</span>
<a id="line-3312" name="line-3312"></a><span class="w">		</span><span class="n">utf8_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_convert</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UTF-8&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">char_encoding</span><span class="p">,</span>
<a id="line-3313" name="line-3313"></a><span class="w">					</span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-3314" name="line-3314"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">utf8_string</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-3315" name="line-3315"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-3316" name="line-3316"></a><span class="w">		</span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">decode_string_and_dup</span><span class="w"> </span><span class="p">(</span><span class="n">utf8_string</span><span class="p">);</span>
<a id="line-3317" name="line-3317"></a><span class="w">		</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">utf8_string</span><span class="p">);</span>
<a id="line-3318" name="line-3318"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">retval</span><span class="p">;</span>
<a id="line-3319" name="line-3319"></a><span class="w">	</span><span class="cm">/* if utf8, then validate */</span>
<a id="line-3320" name="line-3320"></a><span class="w">	</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">locale</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">encoding</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ENCODING_UTF8</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3321" name="line-3321"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="n">g_utf8_validate</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">))</span>
<a id="line-3322" name="line-3322"></a><span class="w">			</span><span class="cm">/* invalid utf8, ignore this key */</span>
<a id="line-3323" name="line-3323"></a><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-3324" name="line-3324"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">decode_string_and_dup</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
<a id="line-3325" name="line-3325"></a><span class="w">	</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-3326" name="line-3326"></a><span class="w">		</span><span class="cm">/* Meaning this is not a localized string */</span>
<a id="line-3327" name="line-3327"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">decode_string_and_dup</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
<a id="line-3328" name="line-3328"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3329" name="line-3329"></a><span class="p">}</span>
<a id="line-3330" name="line-3330"></a>
<a id="line-3331" name="line-3331"></a><span class="k">static</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span>
<a id="line-3332" name="line-3332"></a><span class="n">snarf_locale_from_key</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">key</span><span class="p">)</span>
<a id="line-3333" name="line-3333"></a><span class="p">{</span>
<a id="line-3334" name="line-3334"></a><span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">brace</span><span class="p">;</span>
<a id="line-3335" name="line-3335"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">locale</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">;</span>
<a id="line-3336" name="line-3336"></a>
<a id="line-3337" name="line-3337"></a><span class="w">	</span><span class="n">brace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strchr</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;[&#39;</span><span class="p">);</span>
<a id="line-3338" name="line-3338"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">brace</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-3339" name="line-3339"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-3340" name="line-3340"></a>
<a id="line-3341" name="line-3341"></a><span class="w">	</span><span class="n">locale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">brace</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="line-3342" name="line-3342"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">locale</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3343" name="line-3343"></a><span class="w">		</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">locale</span><span class="p">);</span>
<a id="line-3344" name="line-3344"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-3345" name="line-3345"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3346" name="line-3346"></a><span class="w">	</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strchr</span><span class="w"> </span><span class="p">(</span><span class="n">locale</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;]&#39;</span><span class="p">);</span>
<a id="line-3347" name="line-3347"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3348" name="line-3348"></a><span class="w">		</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">locale</span><span class="p">);</span>
<a id="line-3349" name="line-3349"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-3350" name="line-3350"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3351" name="line-3351"></a><span class="w">	</span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">;</span>
<a id="line-3352" name="line-3352"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">locale</span><span class="p">;</span>
<a id="line-3353" name="line-3353"></a><span class="p">}</span>
<a id="line-3354" name="line-3354"></a>
<a id="line-3355" name="line-3355"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<a id="line-3356" name="line-3356"></a><span class="n">insert_key</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span>
<a id="line-3357" name="line-3357"></a><span class="w">	    </span><span class="n">Section</span><span class="w"> </span><span class="o">*</span><span class="n">cur_section</span><span class="p">,</span>
<a id="line-3358" name="line-3358"></a><span class="w">	    </span><span class="n">Encoding</span><span class="w"> </span><span class="n">encoding</span><span class="p">,</span>
<a id="line-3359" name="line-3359"></a><span class="w">	    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">key</span><span class="p">,</span>
<a id="line-3360" name="line-3360"></a><span class="w">	    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">value</span><span class="p">,</span>
<a id="line-3361" name="line-3361"></a><span class="w">	    </span><span class="n">gboolean</span><span class="w"> </span><span class="n">old_kde</span><span class="p">,</span>
<a id="line-3362" name="line-3362"></a><span class="w">	    </span><span class="n">gboolean</span><span class="w"> </span><span class="n">no_translations</span><span class="p">)</span>
<a id="line-3363" name="line-3363"></a><span class="p">{</span>
<a id="line-3364" name="line-3364"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">k</span><span class="p">;</span>
<a id="line-3365" name="line-3365"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">val</span><span class="p">;</span>
<a id="line-3366" name="line-3366"></a><span class="w">	</span><span class="cm">/* we always store everything in UTF-8 */</span>
<a id="line-3367" name="line-3367"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cur_section</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<a id="line-3368" name="line-3368"></a><span class="w">	    </span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_ENCODING</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3369" name="line-3369"></a><span class="w">		</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
<a id="line-3370" name="line-3370"></a><span class="w">		</span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;UTF-8&quot;</span><span class="p">);</span>
<a id="line-3371" name="line-3371"></a><span class="w">	</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-3372" name="line-3372"></a><span class="w">		</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">locale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snarf_locale_from_key</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
<a id="line-3373" name="line-3373"></a><span class="w">		</span><span class="cm">/* If we&#39;re ignoring translations */</span>
<a id="line-3374" name="line-3374"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">no_translations</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">locale</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3375" name="line-3375"></a><span class="w">			</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">locale</span><span class="p">);</span>
<a id="line-3376" name="line-3376"></a><span class="w">			</span><span class="k">return</span><span class="p">;</span>
<a id="line-3377" name="line-3377"></a><span class="w">		</span><span class="p">}</span>
<a id="line-3378" name="line-3378"></a><span class="w">		</span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">decode_string</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">encoding</span><span class="p">,</span><span class="w"> </span><span class="n">locale</span><span class="p">);</span>
<a id="line-3379" name="line-3379"></a>
<a id="line-3380" name="line-3380"></a><span class="w">		</span><span class="cm">/* Ignore this key, it&#39;s whacked */</span>
<a id="line-3381" name="line-3381"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">val</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3382" name="line-3382"></a><span class="w">			</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">locale</span><span class="p">);</span>
<a id="line-3383" name="line-3383"></a><span class="w">			</span><span class="k">return</span><span class="p">;</span>
<a id="line-3384" name="line-3384"></a><span class="w">		</span><span class="p">}</span>
<a id="line-3385" name="line-3385"></a>
<a id="line-3386" name="line-3386"></a><span class="w">		</span><span class="n">g_strchomp</span><span class="w"> </span><span class="p">(</span><span class="n">val</span><span class="p">);</span>
<a id="line-3387" name="line-3387"></a>
<a id="line-3388" name="line-3388"></a><span class="w">		</span><span class="cm">/* For old KDE entries, we can also split by a comma</span>
<a id="line-3389" name="line-3389"></a><span class="cm">		 * on sort order, so convert to semicolons */</span>
<a id="line-3390" name="line-3390"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">old_kde</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<a id="line-3391" name="line-3391"></a><span class="w">		    </span><span class="n">cur_section</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<a id="line-3392" name="line-3392"></a><span class="w">		    </span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_SORT_ORDER</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<a id="line-3393" name="line-3393"></a><span class="w">		    </span><span class="n">strchr</span><span class="w"> </span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;;&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3394" name="line-3394"></a><span class="w">			</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<a id="line-3395" name="line-3395"></a><span class="w">			</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3396" name="line-3396"></a><span class="w">				</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;,&#39;</span><span class="p">)</span>
<a id="line-3397" name="line-3397"></a><span class="w">					</span><span class="n">val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;;&#39;</span><span class="p">;</span>
<a id="line-3398" name="line-3398"></a><span class="w">			</span><span class="p">}</span>
<a id="line-3399" name="line-3399"></a><span class="w">		</span><span class="p">}</span>
<a id="line-3400" name="line-3400"></a>
<a id="line-3401" name="line-3401"></a><span class="w">		</span><span class="cm">/* Check some types, not perfect, but catches a lot</span>
<a id="line-3402" name="line-3402"></a><span class="cm">		 * of things */</span>
<a id="line-3403" name="line-3403"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cur_section</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3404" name="line-3404"></a><span class="w">			</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">cannon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cannonize</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">val</span><span class="p">);</span>
<a id="line-3405" name="line-3405"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cannon</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3406" name="line-3406"></a><span class="w">				</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">val</span><span class="p">);</span>
<a id="line-3407" name="line-3407"></a><span class="w">				</span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cannon</span><span class="p">;</span>
<a id="line-3408" name="line-3408"></a><span class="w">			</span><span class="p">}</span>
<a id="line-3409" name="line-3409"></a><span class="w">		</span><span class="p">}</span>
<a id="line-3410" name="line-3410"></a>
<a id="line-3411" name="line-3411"></a><span class="w">		</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
<a id="line-3412" name="line-3412"></a>
<a id="line-3413" name="line-3413"></a><span class="w">		</span><span class="cm">/* Take care of the language part */</span>
<a id="line-3414" name="line-3414"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">locale</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<a id="line-3415" name="line-3415"></a><span class="w">		    </span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="n">locale</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;C&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3416" name="line-3416"></a><span class="w">			</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">;</span>
<a id="line-3417" name="line-3417"></a><span class="w">			</span><span class="cm">/* Whack C locale */</span>
<a id="line-3418" name="line-3418"></a><span class="w">			</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strchr</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;[&#39;</span><span class="p">);</span>
<a id="line-3419" name="line-3419"></a><span class="w">			</span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">;</span>
<a id="line-3420" name="line-3420"></a><span class="w">			</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">locale</span><span class="p">);</span>
<a id="line-3421" name="line-3421"></a><span class="w">		</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">locale</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3422" name="line-3422"></a><span class="hll"><span class="w">			</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">brace</span><span class="p">;</span><span class="error2">&lt;--- Variable 'brace' can be declared as pointer to const</span>
</span><a id="line-3423" name="line-3423"></a>
<a id="line-3424" name="line-3424"></a><span class="w">			</span><span class="cm">/* Whack the encoding part */</span>
<a id="line-3425" name="line-3425"></a><span class="w">			</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strchr</span><span class="w"> </span><span class="p">(</span><span class="n">locale</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;.&#39;</span><span class="p">);</span>
<a id="line-3426" name="line-3426"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-3427" name="line-3427"></a><span class="w">				</span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">;</span>
<a id="line-3428" name="line-3428"></a>
<a id="line-3429" name="line-3429"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">g_list_find_custom</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">languages</span><span class="p">,</span><span class="w"> </span><span class="n">locale</span><span class="p">,</span>
<a id="line-3430" name="line-3430"></a><span class="w">						</span><span class="p">(</span><span class="n">GCompareFunc</span><span class="p">)</span><span class="n">strcmp</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3431" name="line-3431"></a><span class="w">				</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">languages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_list_prepend</span>
<a id="line-3432" name="line-3432"></a><span class="w">					</span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">languages</span><span class="p">,</span><span class="w"> </span><span class="n">locale</span><span class="p">);</span>
<a id="line-3433" name="line-3433"></a><span class="w">			</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-3434" name="line-3434"></a><span class="w">				</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">locale</span><span class="p">);</span>
<a id="line-3435" name="line-3435"></a><span class="w">			</span><span class="p">}</span>
<a id="line-3436" name="line-3436"></a>
<a id="line-3437" name="line-3437"></a><span class="w">			</span><span class="cm">/* Whack encoding from encoding in the key */</span>
<a id="line-3438" name="line-3438"></a><span class="w">			</span><span class="n">brace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strchr</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;[&#39;</span><span class="p">);</span>
<a id="line-3439" name="line-3439"></a><span class="w">			</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strchr</span><span class="w"> </span><span class="p">(</span><span class="n">brace</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;.&#39;</span><span class="p">);</span>
<a id="line-3440" name="line-3440"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3441" name="line-3441"></a><span class="w">				</span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;]&#39;</span><span class="p">;</span>
<a id="line-3442" name="line-3442"></a><span class="w">				</span><span class="o">*</span><span class="p">(</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">;</span>
<a id="line-3443" name="line-3443"></a><span class="w">			</span><span class="p">}</span>
<a id="line-3444" name="line-3444"></a><span class="w">		</span><span class="p">}</span>
<a id="line-3445" name="line-3445"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3446" name="line-3446"></a>
<a id="line-3447" name="line-3447"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cur_section</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3448" name="line-3448"></a><span class="w">		</span><span class="cm">/* only add to list if we haven&#39;t seen it before */</span>
<a id="line-3449" name="line-3449"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">g_hash_table_lookup</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">main_hash</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3450" name="line-3450"></a><span class="w">			</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_list_prepend</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">,</span>
<a id="line-3451" name="line-3451"></a><span class="w">						     </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="p">));</span>
<a id="line-3452" name="line-3452"></a><span class="w">		</span><span class="p">}</span>
<a id="line-3453" name="line-3453"></a><span class="w">		</span><span class="cm">/* later duplicates override earlier ones */</span>
<a id="line-3454" name="line-3454"></a><span class="w">		</span><span class="n">g_hash_table_replace</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">main_hash</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">val</span><span class="p">);</span>
<a id="line-3455" name="line-3455"></a><span class="w">	</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-3456" name="line-3456"></a><span class="w">		</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">full</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup_printf</span>
<a id="line-3457" name="line-3457"></a><span class="w">			</span><span class="p">(</span><span class="s">&quot;%s/%s&quot;</span><span class="p">,</span>
<a id="line-3458" name="line-3458"></a><span class="w">			 </span><span class="n">cur_section</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">);</span>
<a id="line-3459" name="line-3459"></a><span class="w">		</span><span class="cm">/* only add to list if we haven&#39;t seen it before */</span>
<a id="line-3460" name="line-3460"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">g_hash_table_lookup</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">main_hash</span><span class="p">,</span><span class="w"> </span><span class="n">full</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3461" name="line-3461"></a><span class="w">			</span><span class="n">cur_section</span><span class="o">-&gt;</span><span class="n">keys</span><span class="w"> </span><span class="o">=</span>
<a id="line-3462" name="line-3462"></a><span class="w">				</span><span class="n">g_list_prepend</span><span class="w"> </span><span class="p">(</span><span class="n">cur_section</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">);</span>
<a id="line-3463" name="line-3463"></a><span class="w">		</span><span class="p">}</span>
<a id="line-3464" name="line-3464"></a><span class="w">		</span><span class="cm">/* later duplicates override earlier ones */</span>
<a id="line-3465" name="line-3465"></a><span class="w">		</span><span class="n">g_hash_table_replace</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">main_hash</span><span class="p">,</span>
<a id="line-3466" name="line-3466"></a><span class="w">				      </span><span class="n">full</span><span class="p">,</span><span class="w"> </span><span class="n">val</span><span class="p">);</span>
<a id="line-3467" name="line-3467"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3468" name="line-3468"></a><span class="p">}</span>
<a id="line-3469" name="line-3469"></a>
<a id="line-3470" name="line-3470"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<a id="line-3471" name="line-3471"></a><span class="n">setup_type</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">uri</span><span class="p">)</span>
<a id="line-3472" name="line-3472"></a><span class="p">{</span>
<a id="line-3473" name="line-3473"></a><span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_hash_table_lookup</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">main_hash</span><span class="p">,</span>
<a id="line-3474" name="line-3474"></a><span class="w">						</span><span class="n">MATE_DESKTOP_ITEM_TYPE</span><span class="p">);</span>
<a id="line-3475" name="line-3475"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">uri</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3476" name="line-3476"></a><span class="w">		</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">base</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_path_get_basename</span><span class="w"> </span><span class="p">(</span><span class="n">uri</span><span class="p">);</span>
<a id="line-3477" name="line-3477"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">base</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<a id="line-3478" name="line-3478"></a><span class="w">		    </span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="n">base</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;.directory&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3479" name="line-3479"></a><span class="w">			</span><span class="cm">/* This gotta be a directory */</span>
<a id="line-3480" name="line-3480"></a><span class="w">			</span><span class="n">g_hash_table_replace</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">main_hash</span><span class="p">,</span>
<a id="line-3481" name="line-3481"></a><span class="w">					      </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">MATE_DESKTOP_ITEM_TYPE</span><span class="p">),</span>
<a id="line-3482" name="line-3482"></a><span class="w">					      </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;Directory&quot;</span><span class="p">));</span>
<a id="line-3483" name="line-3483"></a><span class="w">			</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_list_prepend</span>
<a id="line-3484" name="line-3484"></a><span class="w">				</span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">,</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">MATE_DESKTOP_ITEM_TYPE</span><span class="p">));</span>
<a id="line-3485" name="line-3485"></a><span class="w">			</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TYPE_DIRECTORY</span><span class="p">;</span>
<a id="line-3486" name="line-3486"></a><span class="w">		</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-3487" name="line-3487"></a><span class="w">			</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TYPE_NULL</span><span class="p">;</span>
<a id="line-3488" name="line-3488"></a><span class="w">		</span><span class="p">}</span>
<a id="line-3489" name="line-3489"></a><span class="w">		</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">base</span><span class="p">);</span>
<a id="line-3490" name="line-3490"></a><span class="w">	</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-3491" name="line-3491"></a><span class="w">		</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">type_from_string</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="p">);</span>
<a id="line-3492" name="line-3492"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3493" name="line-3493"></a><span class="p">}</span>
<a id="line-3494" name="line-3494"></a>
<a id="line-3495" name="line-3495"></a><span class="cm">/* fallback to find something suitable for C locale */</span>
<a id="line-3496" name="line-3496"></a><span class="k">static</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span>
<a id="line-3497" name="line-3497"></a><span class="hll"><span class="n">try_english_key</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">key</span><span class="p">)</span><span class="error2">&lt;--- Parameter 'item' can be declared as pointer to const</span>
</span><a id="line-3498" name="line-3498"></a><span class="p">{</span>
<a id="line-3499" name="line-3499"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">str</span><span class="p">;</span>
<a id="line-3500" name="line-3500"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">locales</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;en_US&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;en_GB&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;en_AU&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;en&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="p">};</span>
<a id="line-3501" name="line-3501"></a><span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<a id="line-3502" name="line-3502"></a>
<a id="line-3503" name="line-3503"></a><span class="w">	</span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-3504" name="line-3504"></a><span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">locales</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3505" name="line-3505"></a><span class="w">		</span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">lookup_locale</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">locales</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
<a id="line-3506" name="line-3506"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3507" name="line-3507"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">str</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3508" name="line-3508"></a><span class="w">		</span><span class="cm">/* We need a 7-bit ascii string, so whack all</span>
<a id="line-3509" name="line-3509"></a><span class="cm">		 * above 127 chars */</span>
<a id="line-3510" name="line-3510"></a><span class="w">		</span><span class="n">guchar</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">;</span>
<a id="line-3511" name="line-3511"></a><span class="w">		</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">guchar</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">str</span><span class="p">;</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">;</span><span class="w"> </span><span class="n">p</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3512" name="line-3512"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">127</span><span class="p">)</span>
<a id="line-3513" name="line-3513"></a><span class="w">				</span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;?&#39;</span><span class="p">;</span>
<a id="line-3514" name="line-3514"></a><span class="w">		</span><span class="p">}</span>
<a id="line-3515" name="line-3515"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3516" name="line-3516"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">str</span><span class="p">;</span>
<a id="line-3517" name="line-3517"></a><span class="p">}</span>
<a id="line-3518" name="line-3518"></a>
<a id="line-3519" name="line-3519"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<a id="line-3520" name="line-3520"></a><span class="n">sanitize</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">uri</span><span class="p">)</span>
<a id="line-3521" name="line-3521"></a><span class="p">{</span>
<a id="line-3522" name="line-3522"></a><span class="w">	</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">type</span><span class="p">;</span>
<a id="line-3523" name="line-3523"></a>
<a id="line-3524" name="line-3524"></a><span class="w">	</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lookup</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TYPE</span><span class="p">);</span>
<a id="line-3525" name="line-3525"></a>
<a id="line-3526" name="line-3526"></a><span class="w">	</span><span class="cm">/* understand old mate style url exec thingies */</span>
<a id="line-3527" name="line-3527"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;URL&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3528" name="line-3528"></a><span class="w">		</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">exec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lookup</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_EXEC</span><span class="p">);</span>
<a id="line-3529" name="line-3529"></a><span class="w">		</span><span class="n">set</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_TYPE</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Link&quot;</span><span class="p">);</span>
<a id="line-3530" name="line-3530"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">exec</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3531" name="line-3531"></a><span class="w">			</span><span class="cm">/* Note, this must be in this order */</span>
<a id="line-3532" name="line-3532"></a><span class="w">			</span><span class="n">set</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_URL</span><span class="p">,</span><span class="w"> </span><span class="n">exec</span><span class="p">);</span>
<a id="line-3533" name="line-3533"></a><span class="w">			</span><span class="n">set</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_EXEC</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-3534" name="line-3534"></a><span class="w">		</span><span class="p">}</span>
<a id="line-3535" name="line-3535"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3536" name="line-3536"></a>
<a id="line-3537" name="line-3537"></a><span class="w">	</span><span class="cm">/* we make sure we have Name, Encoding and Version */</span>
<a id="line-3538" name="line-3538"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lookup</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_NAME</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3539" name="line-3539"></a><span class="w">		</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">try_english_key</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_NAME</span><span class="p">);</span>
<a id="line-3540" name="line-3540"></a><span class="w">		</span><span class="cm">/* If no name, use the basename */</span>
<a id="line-3541" name="line-3541"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">uri</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-3542" name="line-3542"></a><span class="w">			</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_path_get_basename</span><span class="w"> </span><span class="p">(</span><span class="n">uri</span><span class="p">);</span>
<a id="line-3543" name="line-3543"></a><span class="w">		</span><span class="cm">/* If no uri either, use same default as mate_desktop_item_new */</span>
<a id="line-3544" name="line-3544"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3545" name="line-3545"></a><span class="w">		       </span><span class="cm">/* Translators: the &quot;name&quot; mentioned here is the name of</span>
<a id="line-3546" name="line-3546"></a><span class="cm">			* an application or a document */</span>
<a id="line-3547" name="line-3547"></a><span class="w">			</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;No name&quot;</span><span class="p">));</span>
<a id="line-3548" name="line-3548"></a><span class="w">		</span><span class="p">}</span>
<a id="line-3549" name="line-3549"></a><span class="w">		</span><span class="n">g_hash_table_replace</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">main_hash</span><span class="p">,</span>
<a id="line-3550" name="line-3550"></a><span class="w">				      </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">MATE_DESKTOP_ITEM_NAME</span><span class="p">),</span>
<a id="line-3551" name="line-3551"></a><span class="w">				      </span><span class="n">name</span><span class="p">);</span>
<a id="line-3552" name="line-3552"></a><span class="w">		</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_list_prepend</span>
<a id="line-3553" name="line-3553"></a><span class="w">			</span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">,</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">MATE_DESKTOP_ITEM_NAME</span><span class="p">));</span>
<a id="line-3554" name="line-3554"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3555" name="line-3555"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lookup</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_ENCODING</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3556" name="line-3556"></a><span class="w">		</span><span class="cm">/* We store everything in UTF-8 so write that down */</span>
<a id="line-3557" name="line-3557"></a><span class="w">		</span><span class="n">g_hash_table_replace</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">main_hash</span><span class="p">,</span>
<a id="line-3558" name="line-3558"></a><span class="w">				      </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">MATE_DESKTOP_ITEM_ENCODING</span><span class="p">),</span>
<a id="line-3559" name="line-3559"></a><span class="w">				      </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;UTF-8&quot;</span><span class="p">));</span>
<a id="line-3560" name="line-3560"></a><span class="w">		</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_list_prepend</span>
<a id="line-3561" name="line-3561"></a><span class="w">			</span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">,</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">MATE_DESKTOP_ITEM_ENCODING</span><span class="p">));</span>
<a id="line-3562" name="line-3562"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3563" name="line-3563"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lookup</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">MATE_DESKTOP_ITEM_VERSION</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3564" name="line-3564"></a><span class="w">		</span><span class="cm">/* this is the version that we follow, so write it down */</span>
<a id="line-3565" name="line-3565"></a><span class="w">		</span><span class="n">g_hash_table_replace</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">main_hash</span><span class="p">,</span>
<a id="line-3566" name="line-3566"></a><span class="w">				      </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">MATE_DESKTOP_ITEM_VERSION</span><span class="p">),</span>
<a id="line-3567" name="line-3567"></a><span class="w">				      </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;1.0&quot;</span><span class="p">));</span>
<a id="line-3568" name="line-3568"></a><span class="w">		</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_list_prepend</span>
<a id="line-3569" name="line-3569"></a><span class="w">			</span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">,</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">MATE_DESKTOP_ITEM_VERSION</span><span class="p">));</span>
<a id="line-3570" name="line-3570"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3571" name="line-3571"></a><span class="p">}</span>
<a id="line-3572" name="line-3572"></a>
<a id="line-3573" name="line-3573"></a><span class="k">enum</span><span class="w"> </span><span class="p">{</span>
<a id="line-3574" name="line-3574"></a><span class="w">	</span><span class="n">FirstBrace</span><span class="p">,</span>
<a id="line-3575" name="line-3575"></a><span class="w">	</span><span class="n">OnSecHeader</span><span class="p">,</span>
<a id="line-3576" name="line-3576"></a><span class="w">	</span><span class="n">IgnoreToEOL</span><span class="p">,</span>
<a id="line-3577" name="line-3577"></a><span class="w">	</span><span class="n">IgnoreToEOLFirst</span><span class="p">,</span>
<a id="line-3578" name="line-3578"></a><span class="w">	</span><span class="n">KeyDef</span><span class="p">,</span>
<a id="line-3579" name="line-3579"></a><span class="w">	</span><span class="n">KeyDefOnKey</span><span class="p">,</span>
<a id="line-3580" name="line-3580"></a><span class="w">	</span><span class="n">KeyValue</span>
<a id="line-3581" name="line-3581"></a><span class="p">};</span>
<a id="line-3582" name="line-3582"></a>
<a id="line-3583" name="line-3583"></a><span class="k">static</span><span class="w"> </span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span>
<a id="line-3584" name="line-3584"></a><span class="nf">ditem_load</span><span class="w"> </span><span class="p">(</span><span class="n">ReadBuf</span><span class="w"> </span><span class="o">*</span><span class="n">rb</span><span class="p">,</span>
<a id="line-3585" name="line-3585"></a><span class="w">	    </span><span class="n">gboolean</span><span class="w"> </span><span class="n">no_translations</span><span class="p">,</span>
<a id="line-3586" name="line-3586"></a><span class="w">	    </span><span class="n">GError</span><span class="w"> </span><span class="o">**</span><span class="n">error</span><span class="p">)</span>
<a id="line-3587" name="line-3587"></a><span class="p">{</span>
<a id="line-3588" name="line-3588"></a><span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">state</span><span class="p">;</span>
<a id="line-3589" name="line-3589"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="n">CharBuffer</span><span class="w"> </span><span class="p">[</span><span class="mi">1024</span><span class="p">];</span>
<a id="line-3590" name="line-3590"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CharBuffer</span><span class="p">;</span>
<a id="line-3591" name="line-3591"></a><span class="w">	</span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<a id="line-3592" name="line-3592"></a><span class="w">	</span><span class="n">Encoding</span><span class="w"> </span><span class="n">encoding</span><span class="p">;</span>
<a id="line-3593" name="line-3593"></a><span class="w">	</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">;</span>
<a id="line-3594" name="line-3594"></a><span class="w">	</span><span class="n">Section</span><span class="w"> </span><span class="o">*</span><span class="n">cur_section</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-3595" name="line-3595"></a><span class="w">	</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-3596" name="line-3596"></a><span class="w">	</span><span class="n">gboolean</span><span class="w"> </span><span class="n">old_kde</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-3597" name="line-3597"></a>
<a id="line-3598" name="line-3598"></a><span class="w">	</span><span class="n">encoding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_encoding</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="p">);</span>
<a id="line-3599" name="line-3599"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">encoding</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ENCODING_UNKNOWN</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3600" name="line-3600"></a><span class="w">		</span><span class="cm">/* spec says, don&#39;t read this file */</span>
<a id="line-3601" name="line-3601"></a><span class="w">		</span><span class="n">g_set_error</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="p">,</span>
<a id="line-3602" name="line-3602"></a><span class="w">			     </span><span class="n">MATE_DESKTOP_ITEM_ERROR</span><span class="p">,</span>
<a id="line-3603" name="line-3603"></a><span class="w">			     </span><span class="n">MATE_DESKTOP_ITEM_ERROR_UNKNOWN_ENCODING</span><span class="p">,</span>
<a id="line-3604" name="line-3604"></a><span class="w">			     </span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Unknown encoding of: %s&quot;</span><span class="p">),</span>
<a id="line-3605" name="line-3605"></a><span class="w">			     </span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">uri</span><span class="p">);</span>
<a id="line-3606" name="line-3606"></a><span class="w">		</span><span class="n">readbuf_close</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="p">);</span>
<a id="line-3607" name="line-3607"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-3608" name="line-3608"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3609" name="line-3609"></a>
<a id="line-3610" name="line-3610"></a><span class="w">	</span><span class="cm">/* Rewind since get_encoding goes through the file */</span>
<a id="line-3611" name="line-3611"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="w"> </span><span class="n">readbuf_rewind</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="line-3612" name="line-3612"></a><span class="w">		</span><span class="n">readbuf_close</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="p">);</span>
<a id="line-3613" name="line-3613"></a><span class="w">		</span><span class="cm">/* spec says, don&#39;t read this file */</span>
<a id="line-3614" name="line-3614"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-3615" name="line-3615"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3616" name="line-3616"></a>
<a id="line-3617" name="line-3617"></a><span class="w">	</span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mate_desktop_item_new</span><span class="w"> </span><span class="p">();</span>
<a id="line-3618" name="line-3618"></a><span class="w">	</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">modified</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-3619" name="line-3619"></a>
<a id="line-3620" name="line-3620"></a><span class="w">	</span><span class="cm">/* Note: location and mtime are filled in by the new_from_file</span>
<a id="line-3621" name="line-3621"></a><span class="cm">	 * function since it has those values */</span>
<a id="line-3622" name="line-3622"></a>
<a id="line-3623" name="line-3623"></a><span class="cp">#define OVERFLOW (next == &amp;CharBuffer [sizeof(CharBuffer)-1])</span>
<a id="line-3624" name="line-3624"></a>
<a id="line-3625" name="line-3625"></a><span class="w">	</span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FirstBrace</span><span class="p">;</span>
<a id="line-3626" name="line-3626"></a><span class="w">	</span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">readbuf_getc</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="p">))</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">EOF</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3627" name="line-3627"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;\r&#39;</span><span class="p">)</span><span class="w">		</span><span class="cm">/* Ignore Carriage Return */</span>
<a id="line-3628" name="line-3628"></a><span class="w">			</span><span class="k">continue</span><span class="p">;</span>
<a id="line-3629" name="line-3629"></a>
<a id="line-3630" name="line-3630"></a><span class="w">		</span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3631" name="line-3631"></a>
<a id="line-3632" name="line-3632"></a><span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="no">OnSecHeader</span><span class="p">:</span>
<a id="line-3633" name="line-3633"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;]&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">OVERFLOW</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3634" name="line-3634"></a><span class="w">				</span><span class="o">*</span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">;</span>
<a id="line-3635" name="line-3635"></a><span class="w">				</span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CharBuffer</span><span class="p">;</span>
<a id="line-3636" name="line-3636"></a>
<a id="line-3637" name="line-3637"></a><span class="w">				</span><span class="cm">/* keys were inserted in reverse */</span>
<a id="line-3638" name="line-3638"></a><span class="w">				</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cur_section</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<a id="line-3639" name="line-3639"></a><span class="w">				    </span><span class="n">cur_section</span><span class="o">-&gt;</span><span class="n">keys</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3640" name="line-3640"></a><span class="w">					</span><span class="n">cur_section</span><span class="o">-&gt;</span><span class="n">keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_list_reverse</span>
<a id="line-3641" name="line-3641"></a><span class="w">						</span><span class="p">(</span><span class="n">cur_section</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">);</span>
<a id="line-3642" name="line-3642"></a><span class="w">				</span><span class="p">}</span>
<a id="line-3643" name="line-3643"></a><span class="w">				</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="n">CharBuffer</span><span class="p">,</span>
<a id="line-3644" name="line-3644"></a><span class="w">					    </span><span class="s">&quot;KDE Desktop Entry&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3645" name="line-3645"></a><span class="w">					</span><span class="cm">/* Main section */</span>
<a id="line-3646" name="line-3646"></a><span class="w">					</span><span class="n">cur_section</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-3647" name="line-3647"></a><span class="w">					</span><span class="n">old_kde</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
<a id="line-3648" name="line-3648"></a><span class="w">				</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="n">CharBuffer</span><span class="p">,</span>
<a id="line-3649" name="line-3649"></a><span class="w">						   </span><span class="s">&quot;Desktop Entry&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3650" name="line-3650"></a><span class="w">					</span><span class="cm">/* Main section */</span>
<a id="line-3651" name="line-3651"></a><span class="w">					</span><span class="n">cur_section</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-3652" name="line-3652"></a><span class="w">				</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-3653" name="line-3653"></a><span class="w">					</span><span class="n">cur_section</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_new0</span><span class="w"> </span><span class="p">(</span><span class="n">Section</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="line-3654" name="line-3654"></a><span class="w">					</span><span class="n">cur_section</span><span class="o">-&gt;</span><span class="n">name</span><span class="w"> </span><span class="o">=</span>
<a id="line-3655" name="line-3655"></a><span class="w">						</span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">CharBuffer</span><span class="p">);</span>
<a id="line-3656" name="line-3656"></a><span class="w">					</span><span class="n">cur_section</span><span class="o">-&gt;</span><span class="n">keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-3657" name="line-3657"></a><span class="w">					</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">sections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_list_prepend</span>
<a id="line-3658" name="line-3658"></a><span class="w">						</span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">sections</span><span class="p">,</span><span class="w"> </span><span class="n">cur_section</span><span class="p">);</span>
<a id="line-3659" name="line-3659"></a><span class="w">				</span><span class="p">}</span>
<a id="line-3660" name="line-3660"></a><span class="w">				</span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IgnoreToEOL</span><span class="p">;</span>
<a id="line-3661" name="line-3661"></a><span class="w">			</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;[&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3662" name="line-3662"></a><span class="w">				</span><span class="cm">/* FIXME: probably error out instead of ignoring this */</span>
<a id="line-3663" name="line-3663"></a><span class="w">			</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-3664" name="line-3664"></a><span class="w">				</span><span class="o">*</span><span class="n">next</span><span class="o">++</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<a id="line-3665" name="line-3665"></a><span class="w">			</span><span class="p">}</span>
<a id="line-3666" name="line-3666"></a><span class="w">			</span><span class="k">break</span><span class="p">;</span>
<a id="line-3667" name="line-3667"></a>
<a id="line-3668" name="line-3668"></a><span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="no">IgnoreToEOL</span><span class="p">:</span>
<a id="line-3669" name="line-3669"></a><span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="no">IgnoreToEOLFirst</span><span class="p">:</span>
<a id="line-3670" name="line-3670"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">){</span>
<a id="line-3671" name="line-3671"></a><span class="w">				</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">IgnoreToEOLFirst</span><span class="p">)</span>
<a id="line-3672" name="line-3672"></a><span class="w">					</span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FirstBrace</span><span class="p">;</span>
<a id="line-3673" name="line-3673"></a><span class="w">				</span><span class="k">else</span>
<a id="line-3674" name="line-3674"></a><span class="w">					</span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeyDef</span><span class="p">;</span>
<a id="line-3675" name="line-3675"></a><span class="w">				</span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CharBuffer</span><span class="p">;</span>
<a id="line-3676" name="line-3676"></a><span class="w">			</span><span class="p">}</span>
<a id="line-3677" name="line-3677"></a><span class="w">			</span><span class="k">break</span><span class="p">;</span>
<a id="line-3678" name="line-3678"></a>
<a id="line-3679" name="line-3679"></a><span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="no">FirstBrace</span><span class="p">:</span>
<a id="line-3680" name="line-3680"></a><span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="no">KeyDef</span><span class="p">:</span>
<a id="line-3681" name="line-3681"></a><span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="no">KeyDefOnKey</span><span class="p">:</span>
<a id="line-3682" name="line-3682"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;#&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3683" name="line-3683"></a><span class="w">				</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">FirstBrace</span><span class="p">)</span>
<a id="line-3684" name="line-3684"></a><span class="w">					</span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IgnoreToEOLFirst</span><span class="p">;</span>
<a id="line-3685" name="line-3685"></a><span class="w">				</span><span class="k">else</span>
<a id="line-3686" name="line-3686"></a><span class="w">					</span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IgnoreToEOL</span><span class="p">;</span>
<a id="line-3687" name="line-3687"></a><span class="w">				</span><span class="k">break</span><span class="p">;</span>
<a id="line-3688" name="line-3688"></a><span class="w">			</span><span class="p">}</span>
<a id="line-3689" name="line-3689"></a>
<a id="line-3690" name="line-3690"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;[&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">KeyDefOnKey</span><span class="p">){</span>
<a id="line-3691" name="line-3691"></a><span class="w">				</span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OnSecHeader</span><span class="p">;</span>
<a id="line-3692" name="line-3692"></a><span class="w">				</span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CharBuffer</span><span class="p">;</span>
<a id="line-3693" name="line-3693"></a><span class="w">				</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
<a id="line-3694" name="line-3694"></a><span class="w">				</span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-3695" name="line-3695"></a><span class="w">				</span><span class="k">break</span><span class="p">;</span>
<a id="line-3696" name="line-3696"></a><span class="w">			</span><span class="p">}</span>
<a id="line-3697" name="line-3697"></a><span class="w">			</span><span class="cm">/* On first pass, don&#39;t allow dangling keys */</span>
<a id="line-3698" name="line-3698"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">FirstBrace</span><span class="p">)</span>
<a id="line-3699" name="line-3699"></a><span class="w">				</span><span class="k">break</span><span class="p">;</span>
<a id="line-3700" name="line-3700"></a>
<a id="line-3701" name="line-3701"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39; &#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">KeyDefOnKey</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;\t&#39;</span><span class="p">)</span>
<a id="line-3702" name="line-3702"></a><span class="w">				</span><span class="k">break</span><span class="p">;</span>
<a id="line-3703" name="line-3703"></a>
<a id="line-3704" name="line-3704"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">OVERFLOW</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* Abort Definition */</span>
<a id="line-3705" name="line-3705"></a><span class="w">				</span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CharBuffer</span><span class="p">;</span>
<a id="line-3706" name="line-3706"></a><span class="w">				</span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeyDef</span><span class="p">;</span>
<a id="line-3707" name="line-3707"></a><span class="w">				</span><span class="k">break</span><span class="p">;</span>
<a id="line-3708" name="line-3708"></a><span class="w">			</span><span class="p">}</span>
<a id="line-3709" name="line-3709"></a>
<a id="line-3710" name="line-3710"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;=&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">OVERFLOW</span><span class="p">){</span>
<a id="line-3711" name="line-3711"></a><span class="w">				</span><span class="o">*</span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">;</span>
<a id="line-3712" name="line-3712"></a>
<a id="line-3713" name="line-3713"></a><span class="w">				</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
<a id="line-3714" name="line-3714"></a><span class="w">				</span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup</span><span class="w"> </span><span class="p">(</span><span class="n">CharBuffer</span><span class="p">);</span>
<a id="line-3715" name="line-3715"></a><span class="w">				</span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeyValue</span><span class="p">;</span>
<a id="line-3716" name="line-3716"></a><span class="w">				</span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CharBuffer</span><span class="p">;</span>
<a id="line-3717" name="line-3717"></a><span class="w">			</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-3718" name="line-3718"></a><span class="w">				</span><span class="o">*</span><span class="n">next</span><span class="o">++</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<a id="line-3719" name="line-3719"></a><span class="w">				</span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeyDefOnKey</span><span class="p">;</span>
<a id="line-3720" name="line-3720"></a><span class="w">			</span><span class="p">}</span>
<a id="line-3721" name="line-3721"></a><span class="w">			</span><span class="k">break</span><span class="p">;</span>
<a id="line-3722" name="line-3722"></a>
<a id="line-3723" name="line-3723"></a><span class="w">		</span><span class="k">case</span><span class="w"> </span><span class="no">KeyValue</span><span class="p">:</span>
<a id="line-3724" name="line-3724"></a><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">OVERFLOW</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">){</span>
<a id="line-3725" name="line-3725"></a><span class="w">				</span><span class="o">*</span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">;</span>
<a id="line-3726" name="line-3726"></a>
<a id="line-3727" name="line-3727"></a><span class="w">				</span><span class="n">insert_key</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">cur_section</span><span class="p">,</span><span class="w"> </span><span class="n">encoding</span><span class="p">,</span>
<a id="line-3728" name="line-3728"></a><span class="w">					    </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">CharBuffer</span><span class="p">,</span><span class="w"> </span><span class="n">old_kde</span><span class="p">,</span>
<a id="line-3729" name="line-3729"></a><span class="w">					    </span><span class="n">no_translations</span><span class="p">);</span>
<a id="line-3730" name="line-3730"></a>
<a id="line-3731" name="line-3731"></a><span class="w">				</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
<a id="line-3732" name="line-3732"></a><span class="w">				</span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-3733" name="line-3733"></a>
<a id="line-3734" name="line-3734"></a><span class="w">				</span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">KeyDef</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">IgnoreToEOL</span><span class="p">;</span>
<a id="line-3735" name="line-3735"></a><span class="w">				</span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CharBuffer</span><span class="p">;</span>
<a id="line-3736" name="line-3736"></a><span class="w">			</span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="line-3737" name="line-3737"></a><span class="w">				</span><span class="o">*</span><span class="n">next</span><span class="o">++</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<a id="line-3738" name="line-3738"></a><span class="w">			</span><span class="p">}</span>
<a id="line-3739" name="line-3739"></a><span class="w">			</span><span class="k">break</span><span class="p">;</span>
<a id="line-3740" name="line-3740"></a>
<a id="line-3741" name="line-3741"></a><span class="w">		</span><span class="p">}</span><span class="w"> </span><span class="cm">/* switch */</span>
<a id="line-3742" name="line-3742"></a>
<a id="line-3743" name="line-3743"></a><span class="w">	</span><span class="p">}</span><span class="w"> </span><span class="cm">/* while ((c = getc_unlocked (f)) != EOF) */</span>
<a id="line-3744" name="line-3744"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">EOF</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">KeyValue</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3745" name="line-3745"></a><span class="w">		</span><span class="o">*</span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">;</span>
<a id="line-3746" name="line-3746"></a>
<a id="line-3747" name="line-3747"></a><span class="w">		</span><span class="n">insert_key</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">cur_section</span><span class="p">,</span><span class="w"> </span><span class="n">encoding</span><span class="p">,</span>
<a id="line-3748" name="line-3748"></a><span class="w">			    </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">CharBuffer</span><span class="p">,</span><span class="w"> </span><span class="n">old_kde</span><span class="p">,</span>
<a id="line-3749" name="line-3749"></a><span class="w">			    </span><span class="n">no_translations</span><span class="p">);</span>
<a id="line-3750" name="line-3750"></a>
<a id="line-3751" name="line-3751"></a><span class="w">		</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
<a id="line-3752" name="line-3752"></a><span class="w">		</span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="line-3753" name="line-3753"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3754" name="line-3754"></a>
<a id="line-3755" name="line-3755"></a><span class="cp">#undef OVERFLOW</span>
<a id="line-3756" name="line-3756"></a>
<a id="line-3757" name="line-3757"></a><span class="w">	</span><span class="cm">/* keys were inserted in reverse */</span>
<a id="line-3758" name="line-3758"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cur_section</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<a id="line-3759" name="line-3759"></a><span class="w">	    </span><span class="n">cur_section</span><span class="o">-&gt;</span><span class="n">keys</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3760" name="line-3760"></a><span class="w">		</span><span class="n">cur_section</span><span class="o">-&gt;</span><span class="n">keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_list_reverse</span><span class="w"> </span><span class="p">(</span><span class="n">cur_section</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">);</span>
<a id="line-3761" name="line-3761"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3762" name="line-3762"></a><span class="w">	</span><span class="cm">/* keys were inserted in reverse */</span>
<a id="line-3763" name="line-3763"></a><span class="w">	</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_list_reverse</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">);</span>
<a id="line-3764" name="line-3764"></a><span class="w">	</span><span class="cm">/* sections were inserted in reverse */</span>
<a id="line-3765" name="line-3765"></a><span class="w">	</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">sections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_list_reverse</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">sections</span><span class="p">);</span>
<a id="line-3766" name="line-3766"></a>
<a id="line-3767" name="line-3767"></a><span class="w">	</span><span class="cm">/* sanitize some things */</span>
<a id="line-3768" name="line-3768"></a><span class="w">	</span><span class="n">sanitize</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">uri</span><span class="p">);</span>
<a id="line-3769" name="line-3769"></a>
<a id="line-3770" name="line-3770"></a><span class="w">	</span><span class="cm">/* make sure that we set up the type */</span>
<a id="line-3771" name="line-3771"></a><span class="w">	</span><span class="n">setup_type</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">rb</span><span class="o">-&gt;</span><span class="n">uri</span><span class="p">);</span>
<a id="line-3772" name="line-3772"></a>
<a id="line-3773" name="line-3773"></a><span class="w">	</span><span class="n">readbuf_close</span><span class="w"> </span><span class="p">(</span><span class="n">rb</span><span class="p">);</span>
<a id="line-3774" name="line-3774"></a>
<a id="line-3775" name="line-3775"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">item</span><span class="p">;</span>
<a id="line-3776" name="line-3776"></a><span class="p">}</span>
<a id="line-3777" name="line-3777"></a>
<a id="line-3778" name="line-3778"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">stream_printf</span><span class="w"> </span><span class="p">(</span><span class="n">GFileOutputStream</span><span class="w"> </span><span class="o">*</span><span class="n">stream</span><span class="p">,</span>
<a id="line-3779" name="line-3779"></a><span class="w">			   </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">format</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="n">G_GNUC_PRINTF</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<a id="line-3780" name="line-3780"></a>
<a id="line-3781" name="line-3781"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<a id="line-3782" name="line-3782"></a><span class="nf">stream_printf</span><span class="w"> </span><span class="p">(</span><span class="n">GFileOutputStream</span><span class="w"> </span><span class="o">*</span><span class="n">stream</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">format</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span>
<a id="line-3783" name="line-3783"></a><span class="p">{</span>
<a id="line-3784" name="line-3784"></a><span class="w">    </span><span class="kt">va_list</span><span class="w"> </span><span class="n">args</span><span class="p">;</span>
<a id="line-3785" name="line-3785"></a><span class="w">    </span><span class="n">gchar</span><span class="w"> </span><span class="o">*</span><span class="n">s</span><span class="p">;</span>
<a id="line-3786" name="line-3786"></a>
<a id="line-3787" name="line-3787"></a><span class="w">    </span><span class="n">va_start</span><span class="w"> </span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">format</span><span class="p">);</span>
<a id="line-3788" name="line-3788"></a><span class="w">    </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup_vprintf</span><span class="w"> </span><span class="p">(</span><span class="n">format</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
<a id="line-3789" name="line-3789"></a><span class="w">    </span><span class="n">va_end</span><span class="w"> </span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
<a id="line-3790" name="line-3790"></a>
<a id="line-3791" name="line-3791"></a><span class="w">    </span><span class="cm">/* FIXME: what about errors */</span>
<a id="line-3792" name="line-3792"></a><span class="w">    </span><span class="n">g_output_stream_write</span><span class="w"> </span><span class="p">(</span><span class="n">G_OUTPUT_STREAM</span><span class="w"> </span><span class="p">(</span><span class="n">stream</span><span class="p">),</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">strlen</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="p">),</span>
<a id="line-3793" name="line-3793"></a><span class="w">		    	   </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<a id="line-3794" name="line-3794"></a><span class="w">    </span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
<a id="line-3795" name="line-3795"></a><span class="p">}</span>
<a id="line-3796" name="line-3796"></a>
<a id="line-3797" name="line-3797"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<a id="line-3798" name="line-3798"></a><span class="nf">dump_section</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">GFileOutputStream</span><span class="w"> </span><span class="o">*</span><span class="n">stream</span><span class="p">,</span><span class="w"> </span><span class="n">Section</span><span class="w"> </span><span class="o">*</span><span class="n">section</span><span class="p">)</span>
<a id="line-3799" name="line-3799"></a><span class="p">{</span>
<a id="line-3800" name="line-3800"></a><span class="w">	</span><span class="n">GList</span><span class="w"> </span><span class="o">*</span><span class="n">li</span><span class="p">;</span>
<a id="line-3801" name="line-3801"></a>
<a id="line-3802" name="line-3802"></a><span class="w">	</span><span class="n">stream_printf</span><span class="w"> </span><span class="p">(</span><span class="n">stream</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;[%s]</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">section</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
<a id="line-3803" name="line-3803"></a><span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">section</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">;</span><span class="w"> </span><span class="n">li</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"> </span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">li</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3804" name="line-3804"></a><span class="w">		</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">li</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
<a id="line-3805" name="line-3805"></a><span class="w">		</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">full</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup_printf</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;%s/%s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">section</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>
<a id="line-3806" name="line-3806"></a><span class="w">		</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_hash_table_lookup</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">main_hash</span><span class="p">,</span><span class="w"> </span><span class="n">full</span><span class="p">);</span>
<a id="line-3807" name="line-3807"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3808" name="line-3808"></a><span class="w">			</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">escape_string_and_dup</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
<a id="line-3809" name="line-3809"></a><span class="w">			</span><span class="n">stream_printf</span><span class="w"> </span><span class="p">(</span><span class="n">stream</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%s=%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">val</span><span class="p">);</span>
<a id="line-3810" name="line-3810"></a><span class="w">			</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">val</span><span class="p">);</span>
<a id="line-3811" name="line-3811"></a><span class="w">		</span><span class="p">}</span>
<a id="line-3812" name="line-3812"></a><span class="w">		</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">full</span><span class="p">);</span>
<a id="line-3813" name="line-3813"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3814" name="line-3814"></a><span class="p">}</span>
<a id="line-3815" name="line-3815"></a>
<a id="line-3816" name="line-3816"></a><span class="k">static</span><span class="w"> </span><span class="n">gboolean</span>
<a id="line-3817" name="line-3817"></a><span class="nf">ditem_save</span><span class="w"> </span><span class="p">(</span><span class="n">MateDesktopItem</span><span class="w"> </span><span class="o">*</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">uri</span><span class="p">,</span><span class="w"> </span><span class="n">GError</span><span class="w"> </span><span class="o">**</span><span class="n">error</span><span class="p">)</span>
<a id="line-3818" name="line-3818"></a><span class="p">{</span>
<a id="line-3819" name="line-3819"></a><span class="w">	</span><span class="n">GList</span><span class="w"> </span><span class="o">*</span><span class="n">li</span><span class="p">;</span>
<a id="line-3820" name="line-3820"></a><span class="w">	</span><span class="n">GFile</span><span class="w"> </span><span class="o">*</span><span class="n">file</span><span class="p">;</span>
<a id="line-3821" name="line-3821"></a><span class="w">	</span><span class="n">GFileOutputStream</span><span class="w"> </span><span class="o">*</span><span class="n">stream</span><span class="p">;</span>
<a id="line-3822" name="line-3822"></a>
<a id="line-3823" name="line-3823"></a><span class="w">	</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_new_for_uri</span><span class="w"> </span><span class="p">(</span><span class="n">uri</span><span class="p">);</span>
<a id="line-3824" name="line-3824"></a><span class="w">	</span><span class="n">stream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_replace</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">G_FILE_CREATE_NONE</span><span class="p">,</span>
<a id="line-3825" name="line-3825"></a><span class="w">				 </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">);</span>
<a id="line-3826" name="line-3826"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">stream</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-3827" name="line-3827"></a><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<a id="line-3828" name="line-3828"></a>
<a id="line-3829" name="line-3829"></a><span class="w">	</span><span class="n">stream_printf</span><span class="w"> </span><span class="p">(</span><span class="n">stream</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;[Desktop Entry]</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<a id="line-3830" name="line-3830"></a><span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">;</span><span class="w"> </span><span class="n">li</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"> </span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">li</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3831" name="line-3831"></a><span class="w">		</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">li</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
<a id="line-3832" name="line-3832"></a><span class="w">		</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_hash_table_lookup</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">main_hash</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>
<a id="line-3833" name="line-3833"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3834" name="line-3834"></a><span class="w">			</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">escape_string_and_dup</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
<a id="line-3835" name="line-3835"></a><span class="w">			</span><span class="n">stream_printf</span><span class="w"> </span><span class="p">(</span><span class="n">stream</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%s=%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">val</span><span class="p">);</span>
<a id="line-3836" name="line-3836"></a><span class="w">			</span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">val</span><span class="p">);</span>
<a id="line-3837" name="line-3837"></a><span class="w">		</span><span class="p">}</span>
<a id="line-3838" name="line-3838"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3839" name="line-3839"></a>
<a id="line-3840" name="line-3840"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="o">-&gt;</span><span class="n">sections</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-3841" name="line-3841"></a><span class="w">		</span><span class="n">stream_printf</span><span class="w"> </span><span class="p">(</span><span class="n">stream</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<a id="line-3842" name="line-3842"></a>
<a id="line-3843" name="line-3843"></a><span class="w">	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="o">-&gt;</span><span class="n">sections</span><span class="p">;</span><span class="w"> </span><span class="n">li</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"> </span><span class="n">li</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">li</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3844" name="line-3844"></a><span class="w">		</span><span class="n">Section</span><span class="w"> </span><span class="o">*</span><span class="n">section</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">li</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
<a id="line-3845" name="line-3845"></a>
<a id="line-3846" name="line-3846"></a><span class="w">		</span><span class="cm">/* Don&#39;t write empty sections */</span>
<a id="line-3847" name="line-3847"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">section</span><span class="o">-&gt;</span><span class="n">keys</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-3848" name="line-3848"></a><span class="w">			</span><span class="k">continue</span><span class="p">;</span>
<a id="line-3849" name="line-3849"></a>
<a id="line-3850" name="line-3850"></a><span class="w">		</span><span class="n">dump_section</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">stream</span><span class="p">,</span><span class="w"> </span><span class="n">section</span><span class="p">);</span>
<a id="line-3851" name="line-3851"></a>
<a id="line-3852" name="line-3852"></a><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">li</span><span class="o">-&gt;</span><span class="n">next</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span>
<a id="line-3853" name="line-3853"></a><span class="w">			</span><span class="n">stream_printf</span><span class="w"> </span><span class="p">(</span><span class="n">stream</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<a id="line-3854" name="line-3854"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3855" name="line-3855"></a>
<a id="line-3856" name="line-3856"></a><span class="w">	</span><span class="n">g_object_unref</span><span class="w"> </span><span class="p">(</span><span class="n">stream</span><span class="p">);</span>
<a id="line-3857" name="line-3857"></a><span class="w">	</span><span class="n">g_object_unref</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<a id="line-3858" name="line-3858"></a>
<a id="line-3859" name="line-3859"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
<a id="line-3860" name="line-3860"></a><span class="p">}</span>
<a id="line-3861" name="line-3861"></a>
<a id="line-3862" name="line-3862"></a><span class="k">static</span><span class="w"> </span><span class="n">gpointer</span>
<a id="line-3863" name="line-3863"></a><span class="nf">_mate_desktop_item_copy</span><span class="w"> </span><span class="p">(</span><span class="n">gpointer</span><span class="w"> </span><span class="n">boxed</span><span class="p">)</span>
<a id="line-3864" name="line-3864"></a><span class="p">{</span>
<a id="line-3865" name="line-3865"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">mate_desktop_item_copy</span><span class="w"> </span><span class="p">(</span><span class="n">boxed</span><span class="p">);</span>
<a id="line-3866" name="line-3866"></a><span class="p">}</span>
<a id="line-3867" name="line-3867"></a>
<a id="line-3868" name="line-3868"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<a id="line-3869" name="line-3869"></a><span class="nf">_mate_desktop_item_free</span><span class="w"> </span><span class="p">(</span><span class="n">gpointer</span><span class="w"> </span><span class="n">boxed</span><span class="p">)</span>
<a id="line-3870" name="line-3870"></a><span class="p">{</span>
<a id="line-3871" name="line-3871"></a><span class="w">	</span><span class="n">mate_desktop_item_unref</span><span class="w"> </span><span class="p">(</span><span class="n">boxed</span><span class="p">);</span>
<a id="line-3872" name="line-3872"></a><span class="p">}</span>
<a id="line-3873" name="line-3873"></a>
<a id="line-3874" name="line-3874"></a><span class="n">GType</span>
<a id="line-3875" name="line-3875"></a><span class="nf">mate_desktop_item_get_type</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<a id="line-3876" name="line-3876"></a><span class="p">{</span>
<a id="line-3877" name="line-3877"></a><span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">GType</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="line-3878" name="line-3878"></a>
<a id="line-3879" name="line-3879"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="line-3880" name="line-3880"></a><span class="w">		</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_boxed_type_register_static</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;MateDesktopItem&quot;</span><span class="p">,</span>
<a id="line-3881" name="line-3881"></a><span class="w">						     </span><span class="n">_mate_desktop_item_copy</span><span class="p">,</span>
<a id="line-3882" name="line-3882"></a><span class="w">						     </span><span class="n">_mate_desktop_item_free</span><span class="p">);</span>
<a id="line-3883" name="line-3883"></a><span class="w">	</span><span class="p">}</span>
<a id="line-3884" name="line-3884"></a>
<a id="line-3885" name="line-3885"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">type</span><span class="p">;</span>
<a id="line-3886" name="line-3886"></a><span class="p">}</span>
<a id="line-3887" name="line-3887"></a>
<a id="line-3888" name="line-3888"></a><span class="n">GQuark</span>
<a id="line-3889" name="line-3889"></a><span class="nf">mate_desktop_item_error_quark</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<a id="line-3890" name="line-3890"></a><span class="p">{</span>
<a id="line-3891" name="line-3891"></a><span class="w">	</span><span class="k">static</span><span class="w"> </span><span class="n">GQuark</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="line-3892" name="line-3892"></a><span class="w">	</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">q</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<a id="line-3893" name="line-3893"></a><span class="w">		</span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_quark_from_static_string</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;mate-desktop-item-error-quark&quot;</span><span class="p">);</span>
<a id="line-3894" name="line-3894"></a>
<a id="line-3895" name="line-3895"></a><span class="w">	</span><span class="k">return</span><span class="w"> </span><span class="n">q</span><span class="p">;</span>
<a id="line-3896" name="line-3896"></a><span class="p">}</span>
</pre></div></td></tr></table></div>

    </div>
    <div id="footer" class="footer">
      <p>
        Created by Cppcheck 2.14.2 (<a href="https://cppcheck.sourceforge.io">Sourceforge</a>, <a href="irc://irc.freenode.net/cppcheck">IRC</a>)
      </p>
    </div>
    </div>
  </body>
</html>
